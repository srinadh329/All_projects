<div *ngIf="change == 'false'">
  <div class="row m-0">
    <div class="col-md-12 col-sm-12 col-lg-3 side">
      <h4 class="poppins-font chatmsg">Chat
        <button *ngIf="chatbuttonoff?.loginStatus == 1"   (click)=chatOff(loginuserdata)>chatOFF</button>
        <button *ngIf="chatbuttonoff?.loginStatus == 0"   (click)=chatOff(loginuserdata)>chatON</button>
        <!-- <button (click)=blockedcontacts(loginuserdata)>Block contacts</button> -->
      </h4>       
      <div class="row poppins-font">
        <div class="pl-0" [ngClass]="{'col-12':personadd,'col-10':!personadd}">
          <form>
            <div class="form-group">
              <i class="material-icons searchicon  iconscolor"> 
                search
              </i>

              <!-- placed focus to show and hide the  add button while we focus   -->
              <div *ngIf="roleid.roleid.role_id=='6'">
                            <input type="text" autocomplete="off" placeholder="Search" class="form-control searchinput"
                [matAutocomplete]="auto" name="searchterm" (focus)="personadd=true" (focusout)="personadd=false"
                [(ngModel)]="searchterm" (keydown)="SearchMail21($event)" (keyup)="SearchMail(searchterm)" />
                </div>
                <div *ngIf="roleid.roleid.role_id !='6'">
                  <input type="text" autocomplete="off" placeholder="Search" class="form-control searchinput"
      [matAutocomplete]="auto" name="searchterm" (focus)="personadd=true" (focusout)="personadd=false"
      [(ngModel)]="searchterm" (keydown)="SearchMail21($event)" (keyup)="searchOrgEmail(searchterm,roleid.organization_id._id,$event)" />
      </div>
      
              <mat-autocomplete #auto="matAutocomplete" class="contactslist">
                <mat-option *ngIf='response?.length && email'>

                  <div class="row mr-0 ml-0 mb-2 poppins-font listtop" *ngFor="let searchedUser of response">
                    <div class="col-8 p-0">
                      <div class="d-flex  ">
                        <div>
                          <ngx-avatar value="28%" size="35" [round]="false" [cornerRadius]="8"
                            *ngIf=!(searchedUser.Grname) [name]="searchedUser.Name"></ngx-avatar>

                          <ngx-avatar value="28%" size="35" [round]="false" [cornerRadius]="8" *ngIf=searchedUser.Grname
                            [name]="searchedUser.Grname"></ngx-avatar>
                        </div>
                        <div class="ml-3 min-width-0">
                          <div class="font-color fw-600 lh-15 txt-hide">
                            {{searchedUser.Name}}
                            <p class="font-12  fw-400 txt-hide">{{searchedUser.EmailId}}</p>
                          </div>
                          <div *ngIf=searchedUser.Grname>

                            <p (click)="navigategroup(searchedUser)" class="pointer">Group Name :

                              <!-- <a class ='list_name pointer' href="http://localhost:4200/navbar/main?gid={{searchedUser.GroupId}}&gname={{searchedUser.Grname}}&value=true">{{searchedUser.Grname}}</a> -->
                              {{searchedUser.Grname}}

                            </p>
                          </div>
                        </div>
                        <!-- <div class=" ml-3">
                    <div class="font-color fw-600">
                      {{searchedUser.EmailId}}
                      </div>
                    </div> -->
                      </div>
                    </div>
                    <div class="col-4 text-right">
                      <a class="contactname" *ngIf="(searchedUser.status == false) && !(searchedUser.Grname)"
                        (click)="InviteFriend(searchedUser);personadd=true">Invite</a>
                      <a class="contactname" *ngIf="(searchedUser.status == true) && !(searchedUser.Grname)"
                        (click)="users(searchedUser.user)">Chat</a>
                    </div>
                  </div>
                </mat-option>
                <mat-option *ngIf="(!response?.length || !response || !email)">
                  <div class="m013 text-center">
                    <img src="assets/images/nosearch.png">
                    <div class="mt-2">
                      <h3 class="mb-0 color36">No results Found</h3>
                      <p class="font-color">Lorem ipsum dummy text editor lorem ipaum</p>
                    </div>
                  </div>
                </mat-option>
              </mat-autocomplete>
            </div>
          </form>
        </div>
        <div class="col-2  p-0" *ngIf="!personadd">
          <button class="butt" matTooltip="Invitation Link For New User" mat-raised-button data-toggle="modal"
            (click)="InviteUser()">
            <mat-icon class="iconscolor">person_add</mat-icon>
          </button>
        </div>
        <!-- Invitation modal -->

      </div>
      <div class="row poppins-font">

        <mat-tab-group class="styletabs">
          <mat-tab label="All">
            <div [ngStyle]="{'max-height.px': divheight}">
              <div *ngFor="let user of listusers" class="row" [ngClass]="{'selecteduser':Userdetails == user?._id}">
                <!-- <div *ngIf =  "(user.senderId.EmailId == loginuserdata.EmailId && user.toblockingStatus == 'unblocked state') || (user.receiverid.EmailId == loginuserdata.EmailId && user.toblockingStatus == 'unblocked state')">       -->
                <div *ngIf="((user.priorityBySender == false) || (user.priorityBySender == true))" class="col-lg-12">
                  <div *ngIf="(user.priorityByReceiver == false) || (user.priorityByReceiver == true)">
                    <!-- sender name -->
                    <mat-card id="custom" class=" users poppins-font" *ngIf="(loginuserdata.id == user.receiverid._id)">
                      <div class="bt-border">
                        <div class="row">
                          <!-- <div class="col-sm-2 col-md-2 col-lg-2" (click)="users(user)"  matTooltip={{Biodata?.Bio}}  (mouseover)="showbio(user)">
                        <ngx-avatar *ngIf="user.senderId.EmailId" [name]="user.senderId.EmailId" value="28%" size="35"
                          [round]="true">
                        </ngx-avatar>
                      </div> -->
                          <div class="col-10  p-0">

                            <div class="d-flex align-items-center ">
                              <div class="position-relative">
                                <ngx-avatar *ngIf="user.senderId.EmailId && !(user.senderId.path)" [name]="user.senderId.EmailId" value="28%"
                                  size="35" [round]="false" [cornerRadius]="12">
                                </ngx-avatar>
                                                   <div *ngIf="user.senderId.EmailId && (user.senderId.path)">
                                
                                             <img src="{{user.senderId.path}}" width="35px" height="35px" style="border-radius:12px">
                                </div>
                                <div *ngIf="user.receiverid.EmailId  == loginuserdata.EmailId" class="statusdisplay">
                                  <div *ngIf="user.senderId.loginStatus == 1">
                                    <span class="activedot"></span>
                                  </div>
                                  <div *ngIf="user.senderId.loginStatus == 0">
                                    <span class="inactivedot"></span>
                                  </div>
                                </div>
                              </div>
                              <div class="ml-2 width250 min-width-0">

                                <div class="list_name pointer txt-hide" (click)="users(user)">
                                  {{user.senderId.Name}}
                                  <!-- // THIS IS FOR USER IS ONLINE OR NOT -->

                                  <!-- // THIS IS FOR USER IS ONLINE OR NOT -->
                                </div>


                                <!-- <p class="color2 mb-0">Lorem ipsum dolor sit amet</p> -->

                              </div>

                              <div>
                                <mat-icon class="menu-mat mt-1  pointer" aria-hidden="false"
                                  aria-label="Example home icon" [matMenuTriggerFor]="menu">more_vert
                                </mat-icon>
                              </div>


                            </div>


                          </div>
                          <div class="col-2">
                            <mat-icon *ngIf="user.count>0" class="pointer matcssbadge" [matBadge]="user.count">
                            </mat-icon>
                            <!-- <mat-icon *ngIf="user.count==0" class="pointer menu-mat">
                        message</mat-icon> -->
                          </div>
                        </div>
                      </div>
                    </mat-card>
                  </div>
                </div>
              <!-- </div> -->
                <!-- receiver name  -->
                <!-- <div *ngIf =  "(user.senderId.EmailId == loginuserdata.EmailId && user.fromblockingStatus == 'unblocked state') || (user.receiverid.EmailId == loginuserdata.EmailId && user.toblockingStatus == 'unblocked state')">       -->
                <div *ngIf="((user.priorityByReceiver == false)||(user.priorityByReceiver == true))" class="col-lg-12">
                  <div *ngIf="(user.priorityBySender == false) || (user.priorityBySender == true)" class="hgh">
                    <mat-card id="custom" class="users poppins-font ff" *ngIf="(loginuserdata.id == user.senderId._id)">
                      <div class="bt-border">

                        <div class="row">
                          <!-- <div class="col-sm-2 col-md-2 col-lg-2" (click)="users(user)" (mouseover)="showbio(user)" matTooltip={{Biodata?.Bio}}>
                        <ngx-avatar *ngIf="user.receiverid.EmailId" [name]="user.receiverid.EmailId" value="28%" size="35"
                          [round]="true"></ngx-avatar>
                      </div> -->
                          <div class="col-10 p-0">
                            <div class="d-flex align-items-center ">
                              <div class="position-relative">
                                <ngx-avatar *ngIf="user.receiverid.EmailId  && !(user.receiverid.path)" [name]="user.receiverid.EmailId" value="28%"
                                  size="35" [round]="false" [cornerRadius]="12"></ngx-avatar>
                          
                                  <div *ngIf="user.receiverid.EmailId  && (user.receiverid.path)">
                                
                                    <img src="{{user.receiverid.path}}" width="50px" height="50px">
                       </div>
                                <div *ngIf="user.senderId.EmailId  == loginuserdata.EmailId" class="statusdisplay">
                                  <div *ngIf="user.receiverid.loginStatus == 1">
                                    <span class="activedot"></span>
                                  </div>
                                  <div *ngIf="user.receiverid.loginStatus == 0">
                                    <span class="inactivedot"></span>/
                                  </div>
                                </div>
                              </div>
                              <div class="ml-2 width250 min-width-0">

                                <div class="list_name pointer txt-hide" (click)="users(user)">
                                  {{user.receiverid.Name}}
                                </div>

                             

                                <!-- <p class="color2 mb-0">Lorem ipsum dolor sit amet</p> -->

                              </div>
                         
                              <div>
                                <mat-icon class="menu-mat mt-1  pointer" aria-hidden="false"
                                  aria-label="Example home icon" [matMenuTriggerFor]="menu">more_vert
                                </mat-icon>
                              </div>
                            </div>

                            
                          </div>
                          <div class="col-2">
                            <!-- <p class="color2">12min</p> -->
                            <mat-icon *ngIf="user.count>0" class="pointer matcssbadge" [matBadge]="user.count"
                              style="color:white">

                            </mat-icon>
                            <!-- <mat-icon *ngIf="user.count==0" class="pointer menu-mat">
                        message</mat-icon> -->
                          </div>
                        </div>
                      </div>

                    </mat-card>
                  </div>
                </div>
               <!-- </div> -->
                <mat-menu #menu="matMenu" class="poppins-font chatpopup">
                  <button mat-menu-item>Incognitive chat</button>
                  <!-- <button mat-menu-item>Call</button> -->
                  <!-- <button mat-menu-item>Delete Contact</button> -->
                  <button mat-menu-item>Hide Conversation</button>
                  <!-- Star Button with mat icon for Star -->
                  <button
                    *ngIf="((((loginuserdata.id==user.senderId?._id)&&((user.priorityByReceiver == false)||(user.priorityByReceiver == true)))&&(user.priorityBySender == false)) ||
                   (((loginuserdata.id == user.receiverid?._id) &&((user.priorityBySender == false) || (user.priorityBySender == true)))&&(user.priorityByReceiver == false)) )"
                    mat-menu-item (click)=makePriority(user)>
                    <!-- <mat-icon aria-hidden="false" aria-label="Star icon" (click)=makePriority(user)>star_border</mat-icon> -->
                    <mat-label>Add to Favourites</mat-label>
                  </button>
                  <!-- Notification Button -->
                  <button mat-menu-item class="menubtn">
                    <mat-label>Turn Off Notifications</mat-label>
                    <!-- <mat-icon aria-hidden="false" aria-label="Star icon">notifications_off</mat-icon> Turn Off
              Notifications -->
                  </button>
                  <!-- <button mat-menu-item (click)=chatOff(loginuserdata)>chatOFF</button> -->
                  <!-- <button *ngIf="chatbuttonoff?.loginStatus == 1"  mat-menu-item (click)=chatOff(loginuserdata)>chatOFF</button>
                  <button *ngIf="chatbuttonoff?.loginStatus == 0"  mat-menu-item (click)=chatOff(loginuserdata)>chatON</button> -->
                </mat-menu>
              </div>
            </div>
          </mat-tab>
          <mat-tab label="Important">
            <div>
              <div *ngFor="let user of listusers" class="row"
                [ngClass]="{'selecteduser':Userselected?._id == user?._id}">
                <!-- sender name -->
                <div *ngIf="user.priorityByReceiver==true" class="col-lg-12">
                  <div *ngIf="((user.priorityBySender == false) ||(user.priorityBySender == true))">
                    <mat-card id="custom" class=" users poppins-font" *ngIf="loginuserdata.id == user.receiverid._id">
                      <!-- Matcard should be false as it is taking space -->
                      <div class="bt-border">

                        <div class="row">
                          <!-- <div class="col-sm-2 col-md-2 col-lg-2" (click)="users(user)">
                        <ngx-avatar *ngIf="user.senderId.EmailId" [name]="user.senderId.EmailId" value="28%" size="35"
                          [round]="true"></ngx-avatar>
                      </div> -->
                          <div class="col-10 p-0">
                            <div class="d-flex align-items-center">
                              <div>
                                <ngx-avatar *ngIf="user.senderId.EmailId  && !(user.senderId.path)" [name]="user.senderId.EmailId" value="28%"
                                  size="35" [round]="false" [cornerRadius]="12"></ngx-avatar>
                              </div>
                                  <div *ngIf="user.senderId.EmailId && (user.senderId.path)">
                                
                                    <img src="{{user.senderId.path}}" width="50px" height="50px">
                                    
                              </div>
                              <div class="ml-2 width250 min-width-0">


                                <div class="list_name pointer txt-hide" (click)="users(user)">{{user.senderId.Name}}
                                </div>




                                <!-- <p class="color2 mb-0">Lorem ipsum dolor sit amet</p> -->

                              </div>


                              <div>
                                <mat-icon class="menu-mat mt-1  pointer" aria-hidden="false"
                                  aria-label="Example home icon" [matMenuTriggerFor]="menu">more_vert
                                </mat-icon>
                              </div>
                            </div>


                          </div>
                          <div class="col-2">
                            <!-- <p class="color2">12min</p> -->
                            <mat-icon *ngIf="user.count>0" class="pointer matcssbadge" [matBadge]="user.count"
                              style="color:white;">
                            </mat-icon>
                            <!-- <mat-icon *ngIf="user.count==0" class="pointer menu-mat">
                        message</mat-icon> -->
                          </div>
                        </div>
                      </div>

                    </mat-card>
                  </div>
                </div>
                <!-- receiver name -->
                <div *ngIf="user.priorityBySender==true" class="col-lg-12">
                  <div *ngIf="((user.priorityByReceiver == false) || (user.priorityByReceiver == true))">
                    <mat-card id="custom" class="users poppins-font" *ngIf="loginuserdata.id == user.senderId._id">

                      <div class="bt-border">

                        <div class="row">
                          <!-- <div class="col-2 p-0" (click)="users(user)">
                   
                      </div> -->
                          <div class="col-10 p-0">
                            <div class="d-flex align-items-center">
                              <div>
                                <ngx-avatar *ngIf="user.receiverid.EmailId && !(user.receiverid.path)" [name]="user.receiverid.EmailId" value="28%"
                                  size="35" [round]="false" [cornerRadius]="12"></ngx-avatar>
                              </div>
                              <div *ngIf="user.receiverid.EmailId  && (user.receiverid.path)">
                                
                                <img src="{{user.receiverid.path}}" width="50px" height="50px">
                   </div>
                              <div class=" ml-2 min-width-0 width250">

                                <div class="list_name pointer txt-hide" (click)="users(user)">
                                  {{user.receiverid.Name}}
                                </div>



                                <!-- <p class="color2 mb-0">Lorem ipsum dolor sit amet</p> -->

                              </div>

                              <div>
                                <mat-icon class="menu-mat mt-1  pointer" aria-hidden="false"
                                  aria-label="Example home icon" [matMenuTriggerFor]="menu">more_vert
                                </mat-icon>
                              </div>

                            </div>

                          </div>
                          <div class="col-2">

                            <!-- <p class="color2">12min</p> -->
                            <mat-icon *ngIf="user.count>0" class="pointer matcssbadge" [matBadge]="user.count"
                              style="color:white">

                            </mat-icon>

                            <!-- <mat-icon *ngIf="user.count==0" class="pointer menu-mat">
                        message</mat-icon> -->
                          </div>
                        </div>
                      </div>

                    </mat-card>
                  </div>
                </div>
                <mat-menu #menu="matMenu" class="poppins-font chatpopup">
                  <button mat-menu-item>Incognitive chat</button>
                  <button mat-menu-item>Call</button>
                  <!-- <button mat-menu-item>Delete Contact</button> -->
                  <button mat-menu-item>Hide Conversation</button>
                  <!-- Button of Priority friends -->
                  <button
                    *ngIf="((((loginuserdata.id == user.senderId?._id)&&(user.priorityBySender==true))&&((user.priorityByReceiver == false) || (user.priorityByReceiver == true))) ||
                   (((loginuserdata.id == user.receiverid?._id)&&(user.priorityByReceiver==true))&&((user.priorityBySender == false) ||(user.priorityBySender == true))) )"
                    mat-menu-item (click)=makePriority(user)>
                    <!-- <mat-icon aria-hidden="false" aria-label="Star icon" (click)=makePriority(user)>star_border</mat-icon> -->
                    <mat-label>Remove as Favourites</mat-label>
                  </button>
                  <!--  -->
                  <button class="menubtn" mat-menu-item>
                    <mat-label>Turn Off Notifications</mat-label>
                    <!-- <mat-icon aria-hidden="false" aria-label="Star icon">notifications_off</mat-icon>  Turn Off
              Notifications -->
                  </button>
                </mat-menu>
              </div>
            </div>
          </mat-tab>
          <mat-tab label="Status">
            <!-- <div>
                        <button class="groupbtn" > <span><i
                              class="fas fa-plus font-12 pr-2"></i></span>Create Status</button>
                      </div> -->
            <div [ngStyle]="{'max-height.px': divheight}" class="row">
          
              <!-- My Status -->
              <div class="col-lg-12">
                <!-- sender name -->
                <mat-card id="custom" class=" users poppins-font">
                  <div class="bt-border">
                    <div class="row">
          
                      <div class="col-10  p-0">
                        <div class="d-flex align-items-center">
                          <div *ngIf="mystatus">
                            <div *ngIf="mystatus.status.length>0">
                              <ngx-avatar [name]="mystatus.Name" value="28%" size="35" [round]="false" [cornerRadius]="12">
                              </ngx-avatar>
                            </div>
                            <div *ngIf="mystatus.status.length==0">
                              <ngx-avatar [name]="loginuserdata?.Name" value="28%" size="35" [round]="false" [cornerRadius]="12">
                              </ngx-avatar>
                            </div>
                          </div>
                          <div class="ml-2 width250 min-width-0">
          
                            <div *ngIf="mystatus?.status.length>0">
                              <div *ngIf="mystatus?.status.length>0" class="list_name pointer txt-hide"
                                (click)="showstatus(mystatus)">
                                {{mystatus.Name}}
                              </div>
                            </div>
          
                            <div *ngIf="mystatus?.status.length==0">
                              <div class="list_name pointer txt-hide">
                                {{loginuserdata?.Name}}
                              </div>
                            </div>
                          </div>
                        </div>
          
          
                      </div>
          
                      <div class="col-2 p-0">
                        <div class="d-flex">
                          <div>
                            <img src="assets/images/Add-status-inactive.png" class="pointer" (click)="CreateStatus()"
                              width="100%">
                          </div>
          
                          <!-- <div class="ml-2">
                                        <i class="fas fa-ellipsis-v pointer" [matMenuTriggerFor]="menu"></i>
                                        <mat-menu #menu="matMenu">
                                          <button mat-menu-item (click)='muteStatus(loginuserdata.id, status.id)'>Mute Status</button>
                                          <button mat-menu-item>Unmute Status</button>
                                        </mat-menu>
                                      </div> -->
                        </div>
                      </div>
                    </div>
                  </div>
                </mat-card>
              </div>
          
                <!-- Recent status -->
                <div *ngIf="listStatus?.length>0 && statusunread == true" class="col-lg-12">
                  <div>
                    <mat-card id="custom" class=" users poppins-font">
                      <p class="font-14 color70  mb-0 pt-2">Recent</p>
                      <div class="bt-border">
          
                        <div *ngFor="let status of listStatus" class="row">
          
                          <div  class="col-10  p-0">
                            <!-- {{status | json}} -->
                            <div *ngIf='status?.status?.length>0 && status?.isUnread==true' class="d-flex align-items-center" (click)="showstatus(status)">
                              <div>
                                <div>
                                  <ngx-avatar [name]="status.Name" value="28%" size="35" [round]="false" [cornerRadius]="12">
                                  </ngx-avatar>
                                </div>
                              </div>
                              <div class="ml-2 width250 min-width-0">          
                                <div>
                                  <div>
                                    <p class="list_name pointer txt-hide mb-0"> {{status.Name}}</p>
          
          
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="col-2 ">
                            <div>
                              <i class="fas fa-ellipsis-v pointer" [matMenuTriggerFor]="menutext"></i>
                              <mat-menu #menutext="matMenu" class="menu-mat">
                                <button mat-menu-item (click)='MuteStatus(this.loginuserdata?.EmailId, status.EmailId, "mute")'>Mute Status</button>
                              </mat-menu>
                            </div>
                          </div>
                        </div>
                      </div>
                    </mat-card>
                  </div>
                </div>

                <!-- Viewed status -->
                <div *ngIf="listStatus?.length>0 && statusread == true" class="col-lg-12">
                  <div>
                    <mat-card id="custom" class=" users poppins-font">
                      <p class="font-14 color70  mb-0 pt-2">Viewed</p>
                      <div class="bt-border">
          
                        <div *ngFor="let status of listStatus" class="row">
          
                          <div  class="col-10  p-0">
                            <!-- {{status | json}} -->
                            <div *ngIf='status?.status?.length>0 && status?.isUnread==false' class="d-flex align-items-center" (click)="showstatus(status)">
                              <div>
                                <div>
                                  <ngx-avatar [name]="status.Name" value="28%" size="35" [round]="false" [cornerRadius]="12">
                                  </ngx-avatar>
                                </div>
                              </div>
                              <div class="ml-2 width250 min-width-0">          
                                <div>
                                  <div>
                                    <p class="list_name pointer txt-hide mb-0"> {{status.Name}}</p>
          
          
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="col-2 ">
                            <div>
                              <i class="fas fa-ellipsis-v pointer" [matMenuTriggerFor]="menutext"></i>
                              <mat-menu #menutext="matMenu" class="menu-mat">
                                <button mat-menu-item (click)='MuteStatus(this.loginuserdata?.EmailId, status.EmailId, "mute")'>Mute Status</button>
                              </mat-menu>
                            </div>
                          </div>
                        </div>
                      </div>
                    </mat-card>
                  </div>
                </div>
                
                <!-- Muted status -->
                <div *ngIf="listStatus?.length>0 && statusmuted == true" class="col-lg-12">
                  <div>
                    <mat-card id="custom" class=" users poppins-font">
                      <p class="font-14 color70  mb-0 pt-2">Muted</p>
                      <div class="bt-border">
          
                        <div *ngFor="let status of listStatus" class="row">
          
                          <div  class="col-10  p-0">
                            <!-- {{status | json}} -->
                            <div *ngIf='status?.status?.length>0 && status?.isMuted==true' class="d-flex align-items-center" (click)="showstatus(status)">
                              <div>
                                <div>
                                  <ngx-avatar [name]="status.Name" value="28%" size="35" [round]="false" [cornerRadius]="12">
                                  </ngx-avatar>
                                </div>
                              </div>
                              <div class="ml-2 width250 min-width-0">          
                                <div>
                                  <div>
                                    <p class="list_name pointer txt-hide mb-0"> {{status.Name}}</p>
          
          
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div *ngIf="status?.Name"class="col-2 ">
                            <div>
                              <i class="fas fa-ellipsis-v pointer" [matMenuTriggerFor]="menutext"></i>
                              <mat-menu #menutext="matMenu" class="menu-mat">
                                <button mat-menu-item (click)='MuteStatus(this.loginuserdata?.EmailId, status.EmailId, "unmute")'>Unmute Status</button>
                              </mat-menu>
                            </div>
                          </div>
                        </div>
                      </div>
                    </mat-card>
                  </div>
                </div>

            </div>
          </mat-tab>
          <mat-tab label="Calls">

            <div [ngStyle]="{'max-height.px': divheight}">
              <div *ngFor="let call of calllog" class="row">
                <div  class="col-lg-12">
                  <div *ngIf="call.type1 == 'Outgoing'">
                    <!-- sender name -->
                    <mat-card id="custom" class=" users poppins-font" (click)="showcalllog(call)">
                      <div class="chat-border">
                        <div class="row">
                     
                          <div class="col-10  p-0">

                            <div class="d-flex ">
                              <div *ngIf="call.Receiver.length==1">
                                <ngx-avatar  [name]="call.Receiver[0].id.Name" value="28%"
                                  size="45" [round]="false" [cornerRadius]="12">
                                </ngx-avatar>
                              </div>
                              <div class="ml-2 width250 min-width-0">

                                <div class="list_name pointer txt-hide">
                                  {{call.Receiver[0].id.Name}}  
                              
                                  <!-- // THIS IS FOR USER IS ONLINE OR NOT -->

                                  <!-- // THIS IS FOR USER IS ONLINE OR NOT -->
                                </div>
                                <p class="font-14 color70"> {{call.start}}
                                  <span *ngIf="call.end == null">Ongoing
                                  </span>
                                </p>

                                <!-- <p class="color2 mb-0">Lorem ipsum dolor sit amet</p> -->

                              </div>
                             </div>


                          </div>
                          <div class="col-2">

                         <div>
                          <span class="material-icons pointer" style="color: green;">
                            call_made
                            </span>
                         </div>
                       <div *ngIf="call.type2=='Video'"> <i class="iconscolor fas fa-video pointer"></i></div>
                       </div>
                        </div>
                      </div>
                    </mat-card>
                  </div>
                  
                  <div *ngIf="call.type1 == 'Incoming'">
                    <!-- sender name -->
                    <mat-card id="custom" class=" users poppins-font" (click)="showcalllog(call)">
                      <div class="chat-border">
                        <div class="row">
                     
                          <div class="col-10  p-0">

                            <div class="d-flex ">
                              <div>
                                <ngx-avatar  [name]="call.Caller.Name" value="28%"
                                  size="45" [round]="false" [cornerRadius]="12">
                                </ngx-avatar>
                                               
          
                              </div>
                              <div class="ml-2 width250 min-width-0">

                                <div class="list_name pointer txt-hide">
                                  {{call.Caller.Name}}
                                  <!-- // THIS IS FOR USER IS ONLINE OR NOT -->

                                  <!-- // THIS IS FOR USER IS ONLINE OR NOT -->
                                </div >
                                <p class="font-14 color70"> {{call.start}} 
                                  <span *ngIf="call.duration?.days>0 && call.Receiver[0].status =='Accepted' && call.end!=null">
                                    {{call.duration.days}}
                                    <!-- <span *ngIf="call.duration.days>1  && call.end!=null">d</span>
                                    <span *ngIf="call.duration.days<2  && call.end!=null">d</span> -->
                                  </span>
                                  <span *ngIf="call.duration?.hours>0 && call.Receiver[0].status =='Accepted' && call.end!=null">
                                    {{call.duration.hours}}
                                    <!-- <span *ngIf="call.duration.hours>1  && call.end!=null">h</span>
                                    <span *ngIf="call.duration.hours<2  && call.end!=null">h</span> -->
                                  </span>
                                  <span *ngIf="call.duration?.mins>0  && call.Receiver[0].status =='Accepted' && call.end!=null">
                                    {{call.duration.mins}}
                                    <!-- <span *ngIf="call.duration.mins>1 && call.end!=null">m</span>
                                    <span *ngIf="call.duration.mins<2 && call.end!=null">m</span> -->
                                  </span>
                                  <!-- <span *ngIf="call.duration.secs>0 && call.ReceiverStatus[0] =='Accepted' && call.end!=null">
                                    {{call.duration.secs}}
                                    <span *ngIf="call.duration.secs>1 && call.end!=null">s</span>
                                    <span *ngIf="call.duration.secs<2 && call.end!=null">s</span>
                                  </span> -->
                                  <!-- <span *ngIf="call.end!=null && call.ReceiverStatus[0] !='Accepted'">
                                    0s
                                  </span> -->
                                  <span *ngIf="call.end == null">Ongoing
                                  </span>
                                </p>
                                <!-- <p class="color2 mb-0">Lorem ipsum dolor sit amet</p> -->

                              </div>
                             </div>


                          </div>
                          <div class="col-2">

                         <div *ngFor="let Receiver of call.Receiver">
                          <div *ngIf="Receiver.id._id == loginuserdata.id">
                            <span class="material-icons pointer"  *ngIf ="Receiver.status == 'Answered'" style=
                            "color: red;">
                        
                            call_received
                              </span>
                            
                              <span class="material-icons pointer"  *ngIf ="Receiver.status == 'No Answer'" style= "color: red;">
                          
                              call_missed
                                </span>
                                <i class="fas fa-ban"  style=
                                "color: red;" *ngIf ="Receiver.status == 'Rejected'" ></i>
                          </div>
                         </div>
                       <div *ngIf="call.type2=='Video'"> <i class="pointer iconscolor fas fa-video"></i></div>
                       </div>
                        </div>
                      </div>
                    </mat-card>
                  </div>
                </div>
            
          
              </div>
            </div>
            </mat-tab>
            <!-- <div *ngFor="let call of calllog">
              Call Type: {{call.type2}} <i class="fas fa-video"></i><br>

              Type: {{call.type1}} <span class="material-icons">
                call_made
                </span>
                <span class="material-icons">
                  call_received
                  </span>
                <br>
              <span *ngIf="call.type1 == 'Outgoing' && call.Receiver.length<2">                
                  Receiver: {{call.Receiver[0].Name}}<br>
                  Status: {{call.ReceiverStatus[0]}}<br>
              </span>
              <span *ngIf="call.type1 == 'Incoming' && call">                
                Caller: {{call.Caller.Name}}<br>
                Status: {{call.ReceiverStatus[0]}}<br>
            </span>
            <span *ngIf="call.end!=null">
              Duration: {{call.duration}} seconds
            </span>   
            <span *ngIf="call.end == null">
              Duration: Ongoing
            </span>           
            <br><br></div>
          </mat-tab>
          
           <mat-tab label="Third"> Content 3 </mat-tab> -->
        </mat-tab-group>
      </div>

    </div>

    <div class="col-md-12 col-sm-12 col-lg-9  main-screen" *ngIf="(listusers !='')"
      [ngClass]="{'incognitomode':incognitoRes}">

      <div class="row pt-3 "  [ngClass]="{'bg-fff':!incognitoRes,'bx-sh':incognitoRes }">

        <div class="col-lg-4">
          <div class="d-flex">
       
       
            <div>
              <ngx-avatar *ngIf="!(chatuser?.path)" [name]="chatuser?.Name" value="28%" size="50" [cornerRadius]="12" [round]="false">
              </ngx-avatar>
            </div>
            <div *ngIf="(chatuser?.path)">
                                
              <img src="{{chatuser?.path}}" width="50px" height="50px" style="border-radius: 10px;">
 </div>
            <div class="ml-2 groupnamewidth">
              <div class="mb-0 font-color fw-600 font20 d-flex"  [ngClass]="{'colorff':incognitoRes}">
                <span class="txt-hide width250">{{chatuser?.Name}}</span>
                <div class="ml-1">
                  <span class="activedot" *ngIf="chatuser?.loginStatus=='1'"></span>
                  <span class="inactivedot" *ngIf="chatuser?.loginStatus=='0'"></span>
                </div>

              </div>
              <p *ngIf="chatuser?.loginStatus=='1'" class="poppins-font font-14"  [ngClass]="{'colorincog':incognitoRes}">Online </p>
              <p *ngIf="chatuser?.loginStatus=='0'" class="poppins-font lastdsfdf"  [ngClass]="{'colorincog':incognitoRes}">Offline
                {{chatuser.updatedAt | dateago}}
              </p>
            </div>
          </div>



        </div>
        <div class="col-lg-8 text-right col-md-8">
          <ul class="menu-icons pl-0 pt-2">
            <li>

              <img src="assets/images/incognito.svg" (click)="incognitoUserOffline(loginuserdata,chatuser)"
                data-toggle="modal" data-target="#INCOGNITO" *ngIf="!incognitoRes">

             <!-- <img src="assets/images/incognito22.svg" *ngIf="incognitoRes"> -->
             <img src="assets/images/incognito22.svg" (click)="incognitoterminate()" *ngIf="incognitoRes && (incognitoRes?.chatuser == loginuserdata?.id || incognitoRes?.loginuser == loginuserdata?.id)">
            </li>
            <li>
              <img src="assets/images/video.svg"  *ngIf="!incognitoRes" (click)="videocallInit(chatuser)" data-toggle="modal" data-target="#VIDEOCALL">
              <img src="assets/images/video22.svg" *ngIf="incognitoRes">
            </li>
            <li>
              <img src="assets/images/call.svg" *ngIf="!incognitoRes">
              <img src="assets/images/call22.svg" *ngIf="incognitoRes">
            </li>

            <li *ngFor="let user of listusers">
              <div *ngIf="Userdetails == user._id">
                <div
                  *ngIf="(user && chatuser?._id == user.senderId._id) && ((((loginuserdata.id == user.senderId._id)&&(user.priorityBySender==true))&&((user.priorityByReceiver == false) || (user.priorityByReceiver == true))) ||
                 (((loginuserdata.id == user.receiverid._id)&&(user.priorityByReceiver==true))&&((user.priorityBySender == false) ||(user.priorityBySender == true))) )"
                  (click)=makePriority(user)>
                  <img src="assets/images/love.png" width="55px" *ngIf="!incognitoRes">
                  <img src="assets/images/fav22.svg" width="55px" *ngIf="incognitoRes">
                </div>

                <div
                  *ngIf="(user && chatuser?._id == user.receiverid._id) && ((((loginuserdata.id == user.senderId._id)&&(user.priorityBySender==true))&&((user.priorityByReceiver == false) || (user.priorityByReceiver == true))) ||
                (((loginuserdata.id == user.receiverid._id)&&(user.priorityByReceiver==true))&&((user.priorityBySender == false) ||(user.priorityBySender == true))) )"
                  (click)=makePriority(user)>
                  <img src="assets/images/love.png" width="55px" *ngIf="!incognitoRes">
                  <img src="assets/images/fav22.svg" width="55px" *ngIf="incognitoRes">
                </div>
              </div>
            </li>

            <li *ngFor="let user of listusers">
              <div *ngIf="Userdetails == user._id">
                <div
                  *ngIf="(user && chatuser?._id == user.senderId._id) && ((((loginuserdata.id==user.senderId._id)&&((user.priorityByReceiver == false)||(user.priorityByReceiver == true)))&&(user.priorityBySender == false)) ||
         (((loginuserdata.id == user.receiverid._id) &&((user.priorityBySender == false) || (user.priorityBySender == true)))&&(user.priorityByReceiver == false)) )"
                  (click)="makePriority(user)">
                  <img src="assets/images/heart.svg">
                </div>
                <div
                  *ngIf="(user && chatuser?._id == user.receiverid._id) && ((((loginuserdata.id==user.senderId._id)&&((user.priorityByReceiver == false)||(user.priorityByReceiver == true)))&&(user.priorityBySender == false)) ||
         (((loginuserdata.id == user.receiverid._id) &&((user.priorityBySender == false) || (user.priorityBySender == true)))&&(user.priorityByReceiver == false)) )"
                  (click)="makePriority(user)">
                  <img src="assets/images/heart.svg">
                </div>
              </div>

            </li>


            <li style="margin-right: 21px;">
              <div class="container-2">
                <span class="icon"> <img src="assets/images/search.svg" *ngIf="!incognitoRes"><img src="assets/images/search22.svg" *ngIf="incognitoRes"></span>
                <input type="search" style="background-color: transparent;color:#707070;" autocomplete="off" id="search" [(ngModel)]="searchTerm"
                  (keyup)="searchData(searchTerm)" />
              </div>
            </li>
            <li>
              <img src="assets/images/star.png" (click)="STARMSGS(loginuserdata,chatuser)"
                *ngIf="starmsg1 && !incognitoRes">
              <img src="assets/images/star1.png" (click)="STARMSGS(loginuserdata,chatuser)"
                *ngIf="!starmsg1 && !incognitoRes">
            </li>
            <li>
              <img src="assets/images/ellipsis-v.svg" [matMenuTriggerFor]="menu" aria-hidden="false"
                aria-label="Example home icon" style="border: none;" *ngIf="!incognitoRes">
                <img src="assets/images/ellipsis-v22.svg" [matMenuTriggerFor]="menu" aria-hidden="false"
                aria-label="Example home icon" style="border: none;" *ngIf="incognitoRes">
            </li>
          </ul>
        </div>
      </div>

      <mat-menu #menu="matMenu" class="chatpopup">
        <!-- viewing block and unblock buttons  -->
        <button
          *ngIf="(blockdfltdata?.from == loginuserdata.EmailId && blockdfltdata?.fromblockingStatus!= 'blocked') || (blockdfltdata?.to == loginuserdata.EmailId && blockdfltdata?.toblockingStatus != 'blocked')"
          (click)="blocking(loginuserdata.EmailId,chatuser.EmailId)" mat-menu-item>Block</button>
        <button
          *ngIf="(blockdfltdata?.from == loginuserdata.EmailId && blockdfltdata?.fromblockingStatus != 'unblocked state') || (blockdfltdata?.to == loginuserdata.EmailId && blockdfltdata?.toblockingStatus != 'unblocked state')"
          (click)="blocking(loginuserdata.EmailId,chatuser.EmailId)" mat-menu-item>UnBlock</button>   
         <button *ngIf="flag1 == true" (click)="deltingAllmsgs()" mat-menu-item>
          Delete Conversation
         </button>
        <button *ngIf="chatuser?.loginStatus == 0 && chatuser?.slidedata == '0' && !slidedata1 "
          (click)="slide(chatuser.EmailId)" mat-menu-item>Notify mail ON</button>
        <button *ngIf="chatuser?.loginStatus == 0 && chatuser?.slidedata == '1' && !slidedata1 "
          (click)="slide(chatuser.EmailId)" mat-menu-item>Notify mail OFF</button>
        <button mat-menu-item class="menubtn" data-toggle="modal" data-target="#myModal">
          <mat-label>Delete Contact</mat-label>
        </button>
        <!-- Hide user  -->
        <button mat-menu-item class="menubtn" (click)="hideUser(loginuserdata,chatuser)">
          <mat-label>Hide User</mat-label>
        </button>
       <!-- As per the ux its not required -->
       <span *ngIf = "activehideuserslist?.length != 0">
        <button   (click)="ActiveHideUsers(loginuserdata?.EmailId)"
          mat-menu-item *ngIf="activehideuserslist && activehideuserslist.length != 0">Unhide Users</button>
        </span>
        <!-- This is for unhideAll users -->
          <!-- <button   (click)="unhideAll(loginuserdata)"
          mat-menu-item >Unhide All</button> -->
          <!-- <button  mat-menu-item *ngIf="incognitoRes && (incognitoRes?.chatuser == loginuserdata?.id || incognitoRes?.loginuser == loginuserdata?.id)" (click)="incognitoterminate()">Terminate IncognitoChat</button> -->
      </mat-menu>

      <!-- INCOGNITO -->
      <!-- // This is for incognito chat box black mode -->
      <!-- <div *ngIf="incognitoRes != null" class = "row" > -->
      <div
        *ngIf="(incognitoRes?.chatuser == loginuserdata?.id && incognitoRes?.loginuser == chatuser?._id)||(incognitoRes?.loginuser == loginuserdata?.id && incognitoRes?.chatuser == chatuser?._id)" class="row chatbox" [ngStyle]="{'height.px':   divheight}">
        <div class="col-lg-12 chatbox1">
          <div *ngFor="let usermsg of userMessage">
            <div *ngIf="usermsg.incognito">
              <div class="row mt-3">
                <div class="col-lg-6 col-xl-5 col-md-6 col-sm-12 ">
                  <div *ngIf="id == usermsg.receiverId && usermsg.incognitoStatus == '0'" class="d-flex ml-2">
                    <div>
                      <ngx-avatar [name]="usermsg.senderName" *ngIf="!(usermsg.senderimg?.path)"  value="28%" size="35" [round]="false" [cornerRadius]="8">
                      </ngx-avatar>
                      <img src={{usermsg.senderimg?.path}}   *ngIf="usermsg.senderimg?.path" width="50px" height="50px">
                    </div>
                    <div class="ml-2 hoveroptions receiverhoverpd min-width-0">
                      <div  class=" position-relative incogreceiver_msg">

                  
                      <p *ngIf="usermsg.message!=null && usermsg.message!=undefined" class="chatmsgspd mb-0">{{usermsg.message}}</p>
                            <div *ngIf="usermsg.photo!=[] && id == usermsg.receiverId ">
                      <div *ngFor="let img of usermsg.photo">


                        <!----------------------------------------------------------------- Image of receiver ---------------------------------------------------------------->
                        <div *ngFor="let type of imgmimetype" class="position-relative">
                          <div *ngIf="img.type == type">
                            <div data-backdrop="true" data-keyboard="true" (click)="openModal(img)">
                              <img src="{{img.path}}" alt="User pic" width="100%" height="100%" class="imagebr" />
                            </div>
                            <button type="button" fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                              (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                              class="btn btn-download">
                              <img src="assets/images/download.png">
                            </button>
                          </div>
                        </div>



                        <!----------------------------------------------------------------- Audio of receiver ---------------------------------------------------------------->

                        <div *ngFor="let type of audiomimetype">
                          <div *ngIf="img.type == type" class="documentview p-2">
                            <audio src="{{img.path}}" preload="none" alt="User audio" style="width:200px;"
                             controls class="htmlvideo">
                              Your browser does not support audio playback. Kindly upgrade your
                              browser!!!
                            </audio>
                          </div>
                        </div>


                        <!----------------------------------------------------------------- Video of receiver ---------------------------------------------------------------->

                        <div *ngFor="let type of videomimetype">
                          <div *ngIf="img.type == type" class="documentview p-2">

                            <video src="{{img.path}}" preload="none" alt="User audio" width="100%" height="225px"
                              controls class="htmlvideo">
                              Your browser does not support video playback. Kindly upgrade your
                              browser!!!
                            </video>
                          </div>
                        </div>

                        <!----------------------------------------------------------------- Document of receiver ---------------------------------------------------------------->


                        <div
                          *ngIf="img.type ==  'application/pdf' || img.type ==  'text/plain' || img.type ==  'text/csv' || img.type ==  'application/msword' || img.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' || img.type == 'application/vnd.ms-powerpoint' || img.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation' || img.type == 'application/vnd.ms-excel' ||  img.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' ">
                          <!-- pdf view -->


                          <div *ngIf="img.type == 'application/pdf'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                            url="{{img.path}}" (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                            class="d-flex"  [ngClass]="{'pdfincognito':incognitoRes,'pdfdiv':!incognitoRes}">
                            <div >
                              <img src="assets/images/pdfnew.png" data-backdrop="none" width="100%" />

                            </div>
                            <div  class="flex-1 min-width-0 width250">
                              <p  class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                            </div>
                            <div>
                              <img src="assets/images/download.png">
                            </div>
                          </div>


                          <div *ngIf="img.type == 'text/plain'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                            url="{{img.path}}" (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                            class="d-flex"  [ngClass]="{'pdfincognito':incognitoRes,'pdfdiv':!incognitoRes}">
                            <div>
                              <img src="assets/images/txt.png" data-backdrop="none" width="100%" />

                            </div>
                            <div  class="flex-1 min-width-0 width250">
                              <p  class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                            </div>
                            <div>
                              <img src="assets/images/download.png">
                            </div>
                          </div>

                          <div *ngIf="img.type == 'text/csv'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                            url="{{img.path}}" (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                            class="d-flex"  [ngClass]="{'pdfincognito':incognitoRes,'pdfdiv':!incognitoRes}">
                            <div>
                              <img src="assets/images/csv.png" data-backdrop="none" width="100%" />

                            </div>
                            <div  class="flex-1 min-width-0 width250">
                              <p  class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                            </div>
                            <div>
                              <img src="assets/images/download.png">
                            </div>
                          </div>


                          <div *ngIf="img.type == 'application/msword'" type="button" style="border: none;" fileSaver
                            [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                            (success)="DownloadSuccess($event)" (error)="Downloadfail($event)" class="d-flex"  [ngClass]="{'pdfincognito':incognitoRes,'pdfdiv':!incognitoRes}">
                            <div>
                              <img src="assets/images/doc.png" data-backdrop="none" width="100%" />

                            </div>
                            <div  class="flex-1 min-width-0 width250">
                              <p  class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                            </div>
                            <div class="col-2">
                              <img src="assets/images/download.png">
                            </div>
                          </div>


                          <div *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'"
                            fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                            (success)="DownloadSuccess($event)" (error)="Downloadfail($event)" class="d-flex"  [ngClass]="{'pdfincognito':incognitoRes,'pdfdiv':!incognitoRes}">
                            <div>
                              <img src="assets/images/docx.png" data-backdrop="none" width="100%" />

                            </div>
                            <div  class="flex-1 min-width-0 width250">
                              <p  class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                            </div>
                            <div>
                              <img src="assets/images/download.png">
                            </div>
                          </div>


                          <div *ngIf="img.type == 'application/vnd.ms-powerpoint'" fileSaver [method]="'GET'"
                            fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                            (error)="Downloadfail($event)" class="d-flex"  [ngClass]="{'pdfincognito':incognitoRes,'pdfdiv':!incognitoRes}">
                            <div>
                              <img src="assets/images/ppt.png" data-backdrop="none" width="100%" />

                            </div>
                            <div  class="flex-1 min-width-0 width250">
                              <p  class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                            </div>
                            <div>
                              <img src="assets/images/download.png">
                            </div>
                          </div>

                          <div *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'"
                            fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                            (success)="DownloadSuccess($event)" (error)="Downloadfail($event)" class="d-flex"  [ngClass]="{'pdfincognito':incognitoRes,'pdfdiv':!incognitoRes}">
                            <div>
                              <img src="assets/images/pptx.png" data-backdrop="none" width="100%" />

                            </div>
                            <div  class="flex-1 min-width-0 width250">
                              <p  class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                            </div>
                            <div>
                              <img src="assets/images/download.png">
                            </div>
                          </div>


                          <div *ngIf="img.type == 'application/vnd.ms-excel'" fileSaver [method]="'GET'"
                            fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                            (error)="Downloadfail($event)" class="d-flex"  [ngClass]="{'pdfincognito':incognitoRes,'pdfdiv':!incognitoRes}">
                            <div>
                              <img src="assets/images/xls.png" data-backdrop="none" width="100%" />

                            </div>
                            <div  class="flex-1 min-width-0 width250">
                              <p  class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                            </div>
                            <div>
                              <img src="assets/images/download.png">
                            </div>
                          </div>

                          <div *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'"
                            fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                            (success)="DownloadSuccess($event)" (error)="Downloadfail($event)" class="d-flex"  [ngClass]="{'pdfincognito':incognitoRes,'pdfdiv':!incognitoRes}">
                            <div>
                              <img src="assets/images/xlsx.png" data-backdrop="none" width="100%" />

                            </div>
                            <div  class="flex-1 min-width-0 width250">
                              <p  class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                            </div>
                            <div>
                              <img src="assets/images/download.png">
                            </div>
                          </div>
                        </div>

                      </div>
                    </div>
                    <div *ngIf="usermsg.media && id == usermsg.receiverId " class="documentview p-2">
                      <audio controls class=" htmlvideo" width="250px">
                        <source src="{{usermsg.media?.path}}" type="audio/webm">
                      </audio>
                    </div>

                    <div class="position-relative">

                      <span *ngIf="usermsg.locationurl && usermsg.Gps && id == usermsg.receiverId ">
                        <app-messagemap [coordinates]="usermsg.Gps" name="location" #map appId="APP-ID-HERE"
                          appCode="APP-CODE-HERE" height="800px">
                        </app-messagemap>
                        <a style="cursor: pointer;" href={{usermsg.locationurl}} target="_blank">
                          <mat-icon class="mapicon">zoom_out_map</mat-icon>
                        </a>
                      </span>
                    </div>
                    </div>
                  </div>
                   
          
                  </div>
                </div>

                <div class="col-lg-6 col-xl-5 col-md-6 col-sm-12 ml-auto">
                  <div *ngIf="id == usermsg.senderId && usermsg.incognitoStatus == '0' " class="d-flex" style="justify-content: flex-end;">
                    <div class="position-relative incogsender_msg min-width-0">
                      <p *ngIf="usermsg.message!=null && usermsg.message!=undefined" class="chatmsgspd mb-0"
                     >{{usermsg.message}}</p>
                      <div *ngIf="usermsg.photo!=[] && id == usermsg.senderId ">
                        <div *ngFor="let img of usermsg.photo">
  
  
                          <!----------------------------------------------------------------- Image of receiver ---------------------------------------------------------------->
                          <div *ngFor="let type of imgmimetype" class="position-relative">
                            <div *ngIf="img.type == type">
                              <div data-backdrop="true" data-keyboard="true" (click)="openModal(img)">
                                <img src="{{img.path}}" alt="User pic" width="100%" height="100%" class="imagebr1" />
                              </div>
                              <button type="button" fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                                (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                class="btn btn-download">
                                <img src="assets/images/download.png">
                              </button>
                            </div>
                          </div>
  
  
  
                          <!----------------------------------------------------------------- Audio of receiver ---------------------------------------------------------------->
  
                          <div *ngFor="let type of audiomimetype">
                            <div *ngIf="img.type == type" class="documentview p-2">
                              <audio src="{{img.path}}" preload="none" alt="User audio" style="width:200px;"
                               controls controlsList="nodownload" class="htmlvideo receiveraudio">
                                Your browser does not support audio playback. Kindly upgrade your
                                browser!!!
                              </audio>
                            </div>
                          </div>
  
  
                          <!----------------------------------------------------------------- Video of receiver ---------------------------------------------------------------->
  
                          <div *ngFor="let type of videomimetype">
                            <div *ngIf="img.type == type" class="documentview p-2">
  
                              <video src="{{img.path}}" preload="none" alt="User audio" width="100%" height="225px"
                                controls class="htmlvideo" controlsList="nodownload">
                                Your browser does not support video playback. Kindly upgrade your
                                browser!!!
                              </video>
                            </div>
                          </div>
  
                          <!----------------------------------------------------------------- Document of receiver ---------------------------------------------------------------->
  
  
                          <div
                            *ngIf="img.type ==  'application/pdf' || img.type ==  'text/plain' || img.type ==  'text/csv' || img.type ==  'application/msword' || img.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' || img.type == 'application/vnd.ms-powerpoint' || img.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation' || img.type == 'application/vnd.ms-excel' ||  img.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' ">
                            <!-- pdf view -->
  
  
                            <div *ngIf="img.type == 'application/pdf'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                              url="{{img.path}}" (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                              class="d-flex"  [ngClass]="{'pdfincognitosend':incognitoRes,'pdfdiv':!incognitoRes}">
                              <div >
                                <img src="assets/images/pdfnew.png" data-backdrop="none" width="100%" />
  
                              </div>
                              <div class="flex-1 min-width-0 width250">
                                <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>
  
  
                            <div *ngIf="img.type == 'text/plain'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                              url="{{img.path}}" (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                              class="d-flex"  [ngClass]="{'pdfincognitosend':incognitoRes,'pdfdiv':!incognitoRes}">
                              <div>
                                <img src="assets/images/txt.png" data-backdrop="none" width="100%" />
  
                              </div>
                              <div  class="flex-1 min-width-0 width250">
                                <p  class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div >
                                <img src="assets/images/download.png">
                              </div>
                            </div>
  
                            <div *ngIf="img.type == 'text/csv'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                              url="{{img.path}}" (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                              class="d-flex"  [ngClass]="{'pdfincognitosend':incognitoRes,'pdfdiv':!incognitoRes}">
                              <div >
                                <img src="assets/images/csv.png" data-backdrop="none" width="100%" />
  
                              </div>
                              <div  class="flex-1 min-width-0 width250">
                                <p  class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>
  
  
                            <div *ngIf="img.type == 'application/msword'" type="button" style="border: none;" fileSaver
                              [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                              (success)="DownloadSuccess($event)" (error)="Downloadfail($event)" class="d-flex"  [ngClass]="{'pdfincognitosend':incognitoRes,'pdfdiv':!incognitoRes}">
                              <div>
                                <img src="assets/images/doc.png" data-backdrop="none" width="100%" />
  
                              </div>
                              <div class="flex-1 min-width-0 width250">
                                <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>
  
  
                            <div *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'"
                              fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                              (success)="DownloadSuccess($event)" (error)="Downloadfail($event)" class="d-flex"  [ngClass]="{'pdfincognitosend':incognitoRes,'pdfdiv':!incognitoRes}">
                              <div>
                                <img src="assets/images/docx.png" data-backdrop="none" width="100%" />
  
                              </div>
                              <div class="flex-1 min-width-0 width250">
                                <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>
  
  
                            <div *ngIf="img.type == 'application/vnd.ms-powerpoint'" fileSaver [method]="'GET'"
                              fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                              (error)="Downloadfail($event)" class="d-flex"  [ngClass]="{'pdfincognitosend':incognitoRes,'pdfdiv':!incognitoRes}">
                              <div>
                                <img src="assets/images/ppt.png" data-backdrop="none" width="100%" />
  
                              </div>
                              <div  class="flex-1 min-width-0 width250">
                                <p  class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div >
                                <img src="assets/images/download.png">
                              </div>
                            </div>
  
                            <div *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'"
                              fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                              (success)="DownloadSuccess($event)" (error)="Downloadfail($event)" class="d-flex"  [ngClass]="{'pdfincognitosend':incognitoRes,'pdfdiv':!incognitoRes}">
                              <div>
                                <img src="assets/images/pptx.png" data-backdrop="none" width="100%" />
  
                              </div>
                              <div  class="flex-1 min-width-0 width250">
                                <p  class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>
  
  
                            <div *ngIf="img.type == 'application/vnd.ms-excel'" fileSaver [method]="'GET'"
                              fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                              (error)="Downloadfail($event)" class="d-flex"  [ngClass]="{'pdfincognitosend':incognitoRes,'pdfdiv':!incognitoRes}">
                              <div>
                                <img src="assets/images/xls.png" data-backdrop="none" width="100%" />
  
                              </div>
                              <div  class="flex-1 min-width-0 width250">
                                <p  class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>
  
                            <div *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'"
                              fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                              (success)="DownloadSuccess($event)" (error)="Downloadfail($event)" class="d-flex"  [ngClass]="{'pdfincognitosend':incognitoRes,'pdfdiv':!incognitoRes}">
                              <div>
                                <img src="assets/images/xlsx.png" data-backdrop="none" width="100%" />
  
                              </div>
                              <div  class="flex-1 min-width-0 width250">
                                <p  class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div >
                                <img src="assets/images/download.png">
                              </div>
                            </div>
                          </div>
  
                        </div>
                      </div>
                        
                    <div *ngIf="usermsg.media && id == usermsg.senderId " class="p-2">
                      <audio controls class="htmlvideo"  style="width:100%">
                        <source src="{{usermsg.media?.path}}" type="audio/webm">
                      </audio>
                    </div>

                    <div class="position-relative">

                      <span *ngIf="usermsg.locationurl && usermsg.Gps && id == usermsg.senderId ">
                        <app-messagemap [coordinates]="usermsg.Gps" name="location" #map appId="APP-ID-HERE"
                          appCode="APP-CODE-HERE" height="800px">
                        </app-messagemap>
                        <a style="cursor: pointer;" href={{usermsg.locationurl}} target="_blank">
                          <mat-icon class="mapicon">zoom_out_map</mat-icon>
                        </a>
                      </span>
                    </div>
                    </div>
                    <div class="ml-2">
                      <div>
                        <ngx-avatar [name]="usermsg.senderName" *ngIf="!(usermsg.senderimg?.path)" value="28%" size="35" [round]="false" [cornerRadius]="8">
                        </ngx-avatar>
                        <img src={{usermsg.senderimg?.path}}   *ngIf="usermsg.senderimg?.path" width="50px" height="50px">
                      </div>
                    </div>
  
             

                
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- // This is for all messages  -->
      <div class="row chatbg chatbox poppins-font " *ngIf='userMessage && starmsg1 == false && !incognitoRes' [scrollTop]="scrolltop" infiniteScroll  [scrollWindow]="false" [infiniteScrollUpDistance]="9.9" [infiniteScrollThrottle]="1500"  (scrolledUp)="onScroll()" id='test'
        [scrollTop]='scrolltop' [ngStyle]="{'height.px':   divheight}">
        <ngx-spinner bdOpacity = 0.9 bdColor = "" size = "medium" color = "#581f87" type = "ball-pulse-sync"[fullScreen] = "false"></ngx-spinner>
        <div class="col-lg-12 ">
          <div *ngFor="let user of userMessage | message:{ message: searchTerm1 , create_At : searchTerm1 }  : false;let i =index">
            <div class="row mt-3" [ngClass]="{'dataselected':selectedmessage == user._id}">
              <div class="col-lg-6 col-xl-5 col-md-6 col-sm-12">
                <div *ngIf="id == user.receiverId && user.incognitoStatus == 'null'">
                  <div class="d-flex ml-2 ">
                    <div>
                      <ngx-avatar [name]="user.senderName" value="28%" size="40" [round]="false" [cornerRadius]="10" *ngIf="!(user?.senderimg?.path)">
                      </ngx-avatar>
                    <!-- asdadas  {{user.senderimg?.path}} -->
                      <div *ngIf="user.senderimg?.path">   
                        <img src="{{user.senderimg?.path}}" width="50px" height="50px">
                      </div>                   
                      <!-- <div class="circle receiver_name">{{user.senderName | slice:0:1 | uppercase}}</div> -->
                    </div>



                    <!-- receiver data -->
                    <div class="ml-2 hoveroptions receiverhoverpd min-width-0">
                      <div class=" position-relative "
                        [ngClass]="{'receiver_msg':!(user.locationurl && user.Gps && id== user.receiverId),'bg-fff border':user.locationurl && user.Gps && id== user.receiverId}">
                        <!-- placed position-relative for map icon -->
                        <div>

                          <div class="bgsh m-2" *ngIf=" user.parentId && !(user?.deletingMsgstatus == '1')">
                            <div class="d-flex p-2 align-items-center">
                              <div *ngIf="user?.parentId">
                                <ngx-avatar [name]="user?.parentId.senderName" *ngIf="user.psenderimg._id != user?.parentId.senderId" value="28%" size="40" [round]="false" 
                                  [cornerRadius]="10">
                                </ngx-avatar>
                            
                                <img src={{user.psenderimg.path}} *ngIf="user.psenderimg._id == user?.parentId.senderId" width="50px" height="50px">
                              </div>

                              <div class="ml-2 min-width-0">
                                <p *ngIf=" user.parentId && !(user?.deletingMsgstatus == '1')  &&  user.parentId.message!=null &&  user.parentId.message!=undefined && user.urlLink =='null'"
                                  id="{{user._id}}" class="mb-0  txt-hide " (click)="selectedMessage(user,i)">

                                  {{user.parentId.message}} </p>

                                <!-- Replying Video -->
                                <div
                                  *ngIf=" user?.parentId && user?.pid != null && user?.parentId?.photo && !(user?.deletingMsgstatus == '1')"
                                  id="{{user._id}}" (click)="selectedMessage(user,i)">
                                  <div *ngFor="let type of videomimetype">{{user?.pid.type}}
                                    <div *ngIf="user?.pid.type == type" class="d-flex just-space-between">
                                      <div class=" min-width-0 width250">
                                        <p class="mb-0  txt-hide pr-3">{{user?.pid?.name}}</p>
                                        <small class="mb-0 txt-hide pr-3">{{user?.pid?.type}}</small>
                                      </div>
                                      <div class="text-right p-0">
                                        <video src="{{user?.pid.path}}" preload="none" alt="User video"
                                          style=" width: 60px; height: 100%;" controls controlsList="nodownload">
                                          Your browser does not support video playback. Kindly upgrade
                                          your browser!!!
                                        </video>
                                      </div>

                                    </div>
                                  </div>
                                </div>

                                <!--Replying Image -->
                                <div
                                  *ngIf="  user?.parentId && user?.pid != null && user?.parentId?.photo && !(user?.deletingMsgstatus == '1')"
                                  id="{{user._id}}" (click)="selectedMessage(user,i)">
                                  <div *ngFor="let type of imgmimetype">
                                    <div *ngIf="user?.pid?.type == type" class="d-flex just-space-between">

                                      <div class="min-width-0 width250">
                                        <p class="mb-0  txt-hide pr-3">{{user?.pid?.name}}</p>
                                        <small class="mb-0 pr-3">{{user?.pid?.type}}</small>
                                      </div>

                                      <div class="text-right  p-0">
                                        <img src="{{user?.pid?.path}}" width="60px" height="100%">
                                      </div>

                                    </div>
                                  </div>

                                </div>
                                <!--Replying Audio -->
                                <div
                                  *ngIf="user?.parentId && user?.pid != null && user?.parentId?.photo!=[] && !(user?.deletingMsgstatus == '1')"
                                  id="{{user._id}}" (click)="selectedMessage(user,i)">
                                  <div *ngFor="let type of audiomimetype">
                                    <div *ngIf="user?.pid?.type == type">
                                      <p class="mb-0  txt-hide ">{{user?.pid?.type}}</p>
                                      <small class="mb-0 txt-hide">{{user?.pid?.name}}</small>
                                      <!-- <audio src="{{user?.pid.path}}" preload="none" alt="User audio"
                                      style="width:250px;" class="d-block receiveraudio" controls>
                                      Your browser does not support audio playback. Kindly upgrade your
                                      browser!!!
                                    </audio> -->
                                    </div>
                                  </div>
                                </div>

                                <div
                                  *ngIf="user?.parentId && user?.pid != null && user?.parentId?.media != null && !(user?.deletingMsgstatus == '1')"
                                  (click)="selectedMessage(user,i)" id="{{user._id}}">

                                  <div *ngFor="let type of audiomimetype">
                                    <div *ngIf="user?.pid.type == type">
                                      <p class="mb-0  txt-hide ">{{user?.pid?.type}}</p>
                                      <small class="mb-0 txt-hide">{{user?.pid?.name}}</small>
                                      <!-- <audio src="{{user?.pid?.path}}" preload="none" alt="User audio"
                                    style="width:250px;" class="d-block receiveraudio" controls>
                                    Your browser does not support audio playback. Kindly upgrade your
                                    browser!!!
                                  </audio> -->
                                    </div>

                                  </div>
                                </div>


                                <!-- Replying location -->
                                <div *ngIf="user.parentId?.locationurl && user.parentId?.Gps "
                                  (click)="selectedMessage(user,i)">
                                  <div class="d-flex " id="{{user._id}}">
                                    <div class="min-width-0 width250">
                                      <p class="mb-0  txt-hide pr-3" *ngIf="user.parentId?.locationlabel">
                                        {{user.parentId?.locationlabel}}</p>
                                      <!-- <small  class="mb-0 ">{{user?.pid?.type}}</small>  -->
                                    </div>
                                    <div class="text-right ">
                                      <img src="assets/map.png" width="60px" height="100%">
                                    </div>

                                  </div>
                                  <!-- <app-messagemap [coordinates]="user.parentId?.Gps" name="location" #map appId="APP-ID-HERE"
                              appCode="APP-CODE-HERE" height="800px">
                            </app-messagemap>
                            <a style="cursor: pointer;" href={{user.parentId?.locationurl}} target="_blank">
                              <mat-icon class="mapicon">zoom_out_map</mat-icon>
                            </a> -->
                                </div>



                                <!-- Replying Docs -->
                                <div
                                  *ngIf="user?.parentId && user?.pid != null && user?.parentId?.photo && (user?.pid.type ==  'application/pdf' || user?.pid.type ==  'text/plain' || user?.pid.type ==  'text/csv' || user?.pid.type ==  'application/msword' || user?.pid.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' || user?.pid.type == 'application/vnd.ms-powerpoint' || user?.pid.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation' || user?.pid.type == 'application/vnd.ms-excel' ||  user?.pid.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet') &&!(user?.deletingMsgstatus == '1')"
                                  id="{{user._id}}" (click)="selectedMessage(user,i)">
                                  <div class="documentview"
                                    *ngIf="user?.pid.type ==  'application/pdf' || user?.pid.type ==  'text/plain' || user?.pid.type ==  'text/csv' || user?.pid.type ==  'application/msword' || user?.pid.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' || user?.pid.type == 'application/vnd.ms-powerpoint' || user?.pid.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation' || user?.pid.type == 'application/vnd.ms-excel' ||  user?.pid.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' ">
                                    <div *ngIf=" user?.pid.type == 'application/pdf'" class="d-flex">
                                      <div class="min-width-0 width250">
                                        <p class="text-left txt-hide  pr-3 font-14 pt-2">{{ user?.pid.name}}</p>
                                      </div>
                                      <div>
                                        <img src="assets/images/pdfnew.png" data-backdrop="none" width="100%" />

                                      </div>

                                    </div>

                                    <div *ngIf=" user?.pid.type == 'text/plain'" class="d-flex">
                                      <div class=" min-width-0 width250">
                                        <p class="text-left txt-hide  pr-3 font-14 pt-2">{{ user?.pid.name}}</p>
                                      </div>
                                      <div>
                                        <img src="assets/images/txt.png" data-backdrop="none" width="100%" />
                                      </div>

                                    </div>

                                    <div *ngIf=" user?.pid.type == 'text/csv'" class="d-flex">
                                      <div class="min-width-0 width250">
                                        <p class="text-left txt-hide  pr-3 font-14 pt-2">{{ user?.pid.name}}</p>
                                      </div>
                                      <div>
                                        <img src="assets/images/csv.png" data-backdrop="none" width="100%" />
                                      </div>

                                    </div>

                                    <div *ngIf=" user?.pid.type == 'application/msword'" class="d-flex">
                                      <div class=" min-width-0 width250">
                                        <p class="text-left txt-hide  pr-3 font-14 pt-2">{{ user?.pid.name}}</p>
                                      </div>
                                      <div>
                                        <img src="assets/images/doc.png" data-backdrop="none" width="100%" />

                                      </div>

                                    </div>

                                    <div
                                      *ngIf=" user?.pid.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'"
                                      class="d-flex">
                                      <div class="min-width-0 width250">
                                        <p class="text-left txt-hide  pr-3 font-14 pt-2">{{ user?.pid.name}}</p>
                                      </div>
                                      <div>
                                        <img src="assets/images/word.png" data-backdrop="none" width="100%" />

                                      </div>

                                    </div>

                                    <div *ngIf=" user?.pid.type == 'application/vnd.ms-powerpoint'" class="d-flex">
                                      <div class="min-width-0 width250">
                                        <p class="text-left txt-hide  pr-3 font-14 pt-2">{{ user?.pid.name}}</p>
                                      </div>
                                      <div>
                                        <img src="assets/images/pptnew.png" data-backdrop="none" width="100%" />

                                      </div>

                                    </div>

                                    <div
                                      *ngIf=" user?.pid.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'"
                                      class="d-flex">
                                      <div class="min-width-0 width250">
                                        <p class="text-left txt-hide  pr-3 font-14 pt-2">{{ user?.pid.name}}</p>
                                      </div>
                                      <div>
                                        <img src="assets/images/pptx.png" data-backdrop="none" width="100%" />

                                      </div>

                                    </div>

                                    <div *ngIf=" user?.pid.type == 'application/vnd.ms-excel'" class="d-flex">
                                      <div class="min-width-0 width250">
                                        <p class="text-left txt-hide  pr-3 font-14 pt-2">{{ user?.pid.name}}</p>
                                      </div>
                                      <div>
                                        <img src="assets/images/xls.png" data-backdrop="none" width="100%" />

                                      </div>

                                    </div>


                                    <div
                                      *ngIf=" user?.pid.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'"
                                      class="d-flex">
                                      <div class="min-width-0 width250">
                                        <p class="text-left txt-hide  pr-3 font-14 pt-2">{{ user?.pid.name}}</p>
                                      </div>
                                      <div>
                                        <img src="assets/images/xlsx.png" data-backdrop="none" width="100%" />

                                      </div>

                                    </div>

                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div
                            *ngIf="!(user?.deletingMsgstatus == '1') && user.message!=null && user.message!=undefined && user.urlLink =='null'">
                            <p class="mb-0 chatmsgspd" id="{{user._id}}"> {{user.message}} </p>

                          </div>

                          <div *ngIf="(user?.urlLink == 'urllink') && !(user?.deletingMsgstatus == '1')"
                            class="width250 min-width-0">
                            <div class="txt-hide chatmsgspd" id="{{user._id}}">
                              <a target="_blank" href="{{user?.message}}" class="font-color">{{user.message}}</a>
                            </div>

                          </div>

                          <!-- Map showing in receiver side -->
                          <div class="position-relative">

                            <span
                              *ngIf="user.locationurl && user.Gps && id== user.receiverId && user.deletingMsgstatus!='1'"
                              id="{{user._id}}">
                              <app-messagemap [coordinates]="user.Gps" name="location" #map appId="APP-ID-HERE"
                                appCode="APP-CODE-HERE" height="800px">
                              </app-messagemap>
                              <a style="cursor: pointer;" href={{user.locationurl}} target="_blank">
                                <mat-icon class="mapicon">zoom_out_map</mat-icon>
                              </a>
                            </span>
                          </div>
                          <!-- Map showing in receiver side end -->

                          <div *ngIf="(user?.deletingMsgstatus == '1')">
                            <p class="hashtxt  mb-0 chatmsgspd">{{user?.MessageHash}}</p>
                          </div>

                          <div *ngIf="user.photo!=[] && id == user.receiverId && !(user?.deletingMsgstatus == '1')"
                            id="{{user._id}}">
                            <div *ngFor="let img of user.photo">


                              <!----------------------------------------------------------------- Image of receiver ---------------------------------------------------------------->
                              <div *ngFor="let type of imgmimetype" class="position-relative">
                                <div *ngIf="img.type == type">
                                  <div data-backdrop="true" data-keyboard="true" (click)="openModal(img)">
                                    <img src="{{img.path}}" alt="User pic" width="100%" height="100%" class="imagebr" />
                                  </div>
                                  <button type="button" fileSaver [method]="'GET'" fileName="{{img.name}}"
                                    url="{{img.path}}" (success)="DownloadSuccess($event)"
                                    (error)="Downloadfail($event)" class="btn btn-download">
                                    <img src="assets/images/download.png">
                                  </button>
                                </div>
                              </div>



                              <!----------------------------------------------------------------- Audio of receiver ---------------------------------------------------------------->

                              <div *ngFor="let type of audiomimetype">
                                <div *ngIf="img.type == type" class="p-2">
                                  <audio src="{{img.path}}" preload="none" alt="User audio" style="width:100%;" controls
                                    controlsList="nodownload" class="htmlvideo receiveraudio">
                                    Your browser does not support audio playback. Kindly upgrade your
                                    browser!!!
                                  </audio>
                                </div>
                              </div>


                              <!----------------------------------------------------------------- Video of receiver ---------------------------------------------------------------->

                              <div *ngFor="let type of videomimetype">
                                <div *ngIf="img.type == type">

                                  <video src="{{img.path}}" preload="none" alt="User audio" width="100%" height="225px"
                                    controls class="htmlvideo">
                                    Your browser does not support video playback. Kindly upgrade your
                                    browser!!!
                                  </video>
                                </div>
                              </div>

                              <!----------------------------------------------------------------- Document of receiver ---------------------------------------------------------------->


                              <div
                                *ngIf="img.type ==  'application/pdf' || img.type ==  'text/plain' || img.type ==  'text/csv' || img.type ==  'application/msword' || img.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' || img.type == 'application/vnd.ms-powerpoint' || img.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation' || img.type == 'application/vnd.ms-excel' ||  img.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' "
                                id="{{user._id}}">
                                <!-- pdf view -->


                                <div *ngIf="img.type == 'application/pdf'" fileSaver [method]="'GET'"
                                  fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                                  (error)="Downloadfail($event)" class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/images/pdfnew.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>


                                <div *ngIf="img.type == 'text/plain'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                                  url="{{img.path}}" (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                  class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/images/txt.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>

                                <div *ngIf="img.type == 'text/csv'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                                  url="{{img.path}}" (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                  class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/images/csv.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>


                                <div *ngIf="img.type == 'application/msword'" type="button" style="border: none;"
                                  fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                                  (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                  class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/images/doc.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>


                                <div
                                  *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'"
                                  fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                                  (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                  class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/images/docx.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left  pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>


                                <div *ngIf="img.type == 'application/vnd.ms-powerpoint'" fileSaver [method]="'GET'"
                                  fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                                  (error)="Downloadfail($event)" class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/images/ppt.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>

                                <div
                                  *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'"
                                  fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                                  (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                  class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/images/pptx.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>


                                <div *ngIf="img.type == 'application/vnd.ms-excel'" fileSaver [method]="'GET'"
                                  fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                                  (error)="Downloadfail($event)" class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/images/xls.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>

                                <div
                                  *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'"
                                  fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                                  (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                  class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/images/xlsx.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>
                              </div>

                            </div>
                          </div>
                          <div *ngIf="user.media" class="p-2">
                            <audio controls class="receiveraudio htmlvideo" controlsList="nodownload" width="100%">
                              <source src="{{user.media?.path}}" type="audio/webm">
                            </audio>
                            <!-- <button type="button" class="btn btn-download" fileSaver [method]="'GET'"
                              fileName="{{user.media?.name}}" url="{{user.media?.path}}"
                              (success)="DownloadSuccess($event)" (error)="Downloadfail($event)">
                              <img src="assets/images/download.png">
                            </button> -->
                          </div>



                        </div>
                        <!-- <div class="showoptions" *ngIf="!(user?.deletingMsgstatus == '1')"
                          [ngClass]="{'optionsreceiver':!(user.locationurl && user.Gps && id== user.receiverId)}">
                          <span *ngIf="!(user?.deletingMsgstatus == '1') && user?.toStaredMessage == 0 "
                            (click)="star(user,loginuserdata.id,i)">Make Favourite</span>
                          <span class="pl-3" *ngIf="!(user?.deletingMsgstatus == '1') && user?.toStaredMessage !=0 "
                            (click)="star(user,loginuserdata.id,i)">Remove Favourite</span>
                          <span class="pl-3" (click)="forwardmsg(user)">Forward</span>

                        </div>
                        <div class="showoptions" *ngIf="(user?.deletingMsgstatus == '1')"
                          [ngClass]="{'optionsreceiver':!(user.locationurl && user.Gps && id== user.receiverId)}">
                          <span>Undo delete</span>
                        </div> -->
                        <!-- <i class="fas fa-reply replymsg receiverreply pb-2" (click)="reply(user)"
                          *ngIf="!(user?.deletingMsgstatus == '1')"></i> -->
                      </div>
                      <div>
                        <!-- <span *ngIf="!(user?.deletingMsgstatus == '1')" class="ticks"> &#x2713;&#x2713;</span> -->
                        <span class="timer_msg pl-2">{{user.create_At |  dateago }}</span>
                      </div>
                    </div>

                    <div>
                      <i class="material-icons pointer color3"
                        [matMenuTriggerFor]="menu1">more_vert</i>
                      <mat-menu #menu1="matMenu" class="chatpopup">
                        <button class="menubtn" mat-menu-item (click)="reply(user)"
                          *ngIf="!(user?.deletingMsgstatus == '1')">Reply</button>
                        <button class="menubtn" mat-menu-item
                          *ngIf="!(user?.deletingMsgstatus == '1') && user?.toStaredMessage == 0 "
                          (click)="star(user,loginuserdata.id,i)">Make Favourite</button>

                        <button mat-menu-item class="menubtn"
                          *ngIf="!(user?.deletingMsgstatus == '1') && user?.toStaredMessage !=0 "
                          (click)="star(user,loginuserdata.id,i)">Remove Favourite</button>

                        <button class="menubtn" mat-menu-item (click)="forwardmsg(user)"
                          *ngIf="user?.deletingMsgstatus != '1'" (click)="ForOneToOneGroups()">Forward Message</button>

                        <button *ngIf="user?.deletingMsgstatus != '1'  && (user.photo.length>0 || user.media) "
                          mat-menu-item class="menubtn" (click)=DownloadMedia(user.photo,user.media)>Download </button>
                      </mat-menu>
                    </div>
                  </div>
                </div>
              </div>
<!-- sender data -->
              <div class="col-lg-6 col-xl-5 col-md-6 col-sm-12 ml-auto">
                <div *ngIf="id != user.receiverId && user.incognitoStatus == 'null'">
                  <div class="d-flex mr-2" style="justify-content: flex-end;">
                    <div>

                      <i class="material-icons pointer color3" 
                        [matMenuTriggerFor]="menusender">more_vert</i>
                      <mat-menu #menusender="matMenu" class="chatpopup">
                        <button class="menubtn" mat-menu-item (click)="reply(user)"
                          *ngIf="!(user?.deletingMsgstatus == '1')">Reply</button>
                        <button class="menubtn" mat-menu-item *ngIf="!(user?.deletingMsgstatus == '1')"
                          (click)="del(user,i)">Delete</button>
                        <!-- <button class="menubtn" mat-menu-item
                          *ngIf="!(user?.deletingMsgstatus == '0' || user?.deletingMsgstatus == 'value will be updated')"
                          (click)="undel(user,i)">Undo Delete</button> -->
                          <button *ngIf="(user?.deletingMsgstatus == '1')" mat-menu-item
                          class="menubtn" (click)="copyHash(user.MessageHash)">Copy Hash</button>

                        <button class="menubtn" mat-menu-item *ngIf="(!(user?.deletingMsgstatus == '1') && (!firstco))"
                          (click)="edit1(user)">Edit</button>
                        <span *ngIf="user?.deletingMsgstatus != '1'"><button class="menubtn" mat-menu-item
                            (click)="forwardmsg(user)" (click)="ForOneToOneGroups()">Forward Message</button></span>
                        <button class="menubtn" mat-menu-item
                          *ngIf="user?.fromStaredMessage == 0 && !(user?.deletingMsgstatus == '1')"
                          (click)="star(user,loginuserdata.id,i)">Make Favourite</button>
                        <button mat-menu-item class="menubtn"
                          *ngIf="user?.fromStaredMessage !=0  && !(user?.deletingMsgstatus == '1')"
                          (click)="star(user,loginuserdata.id,i)">Remove Favourite</button>


                        <button *ngIf="!(user?.deletingMsgstatus == '1') && user.message != null" mat-menu-item
                          class="menubtn" (click)="copyMessage(user.message)">Copy</button>

                        <!-- Download only for audio and video files -->
                        <button *ngIf="user?.deletingMsgstatus != '1'  && (user.photo.length>0 || user.media) "
                          mat-menu-item class="menubtn" (click)="DownloadMedia(user.photo,user.media)">Download
                        </button>
                      </mat-menu>

                    </div>

                    <div class="mr-2 hoveroptions senderhoverpd min-width-0">
                      <div class="position-relative"
                        [ngClass]="{'sendertxt':!(user.locationurl && user.Gps && id == user.senderId) ,'bg-fff border':user.locationurl && user.Gps && id == user.senderId}">
                        <div>
                          <!-- Replying section -->
                          <div class="bgsh m-2 " *ngIf="user.parentId && !(user?.deletingMsgstatus == '1')">
                            <!-- <i   (click)="replymsg()" class="fas fa-times-circle float-right pointer p-2"></i> -->
                            <div class="d-flex align-items-center p-2">

                              <div *ngIf="user?.parentId">
                                <ngx-avatar [name]="user?.parentId.senderName" *ngIf="user.psenderimg._id != user?.parentId.senderId" value="28%" size="40" [round]="false" 
                                  [cornerRadius]="10">
                                </ngx-avatar>
                            
                                <img src={{user.psenderimg.path}} *ngIf="user.psenderimg._id == user?.parentId.senderId" width="50px" height="50px">
                              </div>


                              <div class="ml-2 min-width-0">
                                <p class="mb-0  txt-hide " (click)="selectedMessage(user,i)">
                                  {{user.parentId.message}} </p>

                                <!-- <p  class="mb-0  txt-hide">
                                {{user?.parentId.senderName}}: {{user.parentId.message}} </p> -->
                                <!--Replying Image -->
                                <div
                                  *ngIf="user?.parentId && user?.pid != null && user?.parentId?.photo && !(user?.deletingMsgstatus == '1')"
                                  (click)="selectedMessage(user,i)">

                                  <div *ngFor="let type of imgmimetype">

                                    <div *ngIf="user?.pid?.type == type" class="d-flex just-space-between">
                                      <div class=" min-width-0 width250">
                                        <p class="mb-0  txt-hide pr-3">{{user?.pid?.name}}</p>
                                        <small class="mb-0 ">{{user?.pid?.type}}</small>
                                      </div>
                                      <div class="text-right p-0">
                                      <img src="{{user?.pid?.path}}" width="60px" height="100%">
                                      </div>

                                    </div>
                                  </div>
                                </div>

                                <!-- Replying Video -->
                                <div
                                  *ngIf=" user?.parentId && user?.pid != null && user?.parentId?.photo && !(user?.deletingMsgstatus == '1')"
                                  (click)="selectedMessage(user,i)">
                                  <div *ngFor="let type of videomimetype">
                                    <div *ngIf="user?.pid.type == type" class="d-flex just-space-between">
                                      <div class="min-width-0 width250">
                                        <p class="mb-0 pr-3 txt-hide">{{user?.pid?.name}}</p>
                                        <small class="mb-0 ">{{user?.pid?.type}}</small>
                                      </div>
                                      <div class="text-right p-0">
                                        <video src="{{user?.pid.path}}" preload="none" alt="User video"
                                          aria-readonly="true" style=" width:60px; height: 100%;" controls
                                          controlsList="nodownload">
                                          Your browser does not support video playback. Kindly upgrade
                                          your browser!!!
                                        </video>
                                      </div>

                                    </div>
                                  </div>
                                </div>


                                <!--Replying Audio -->
                                <div
                                  *ngIf="  user?.parentId && user?.pid != null && user?.parentId?.photo !=[] && user?.parentId?.media == null && !(user?.deletingMsgstatus == '1')"
                                  (click)="selectedMessage(user,i)">
                                  <div *ngFor="let type of audiomimetype">
                                    <div *ngIf="user?.pid?.type == type">
                                      <p class="mb-0  txt-hide ">{{user?.pid?.type}}</p>
                                      <p class="mb-0 txt-hide font-12">{{user?.pid?.name}}</p>
                                      <!-- <audio src="{{user?.pid.path}}" preload="none" alt="User audio"
                                  style="width:250px;" class="d-block receiveraudio" controls>
                                  Your browser does not support audio playback. Kindly upgrade your
                                  browser!!!
                                </audio> -->
                                    </div>
                                  </div>
                                </div>



                                <div
                                  *ngIf="user?.parentId && user?.pid != null && user?.parentId?.media != null && !(user?.deletingMsgstatus == '1')"
                                  (click)="selectedMessage(user,i)">

                                  <div *ngFor="let type of audiomimetype">
                                    <div *ngIf="user?.pid.type == type">
                                      <p class="mb-0  txt-hide ">{{user?.pid?.type}}</p>
                                      <p class="mb-0 txt-hide font-12">{{user?.pid?.name}}</p>
                                      <!-- <audio src="{{user?.pid?.path}}" preload="none" alt="User audio"
                                  style="width:250px;" class="d-block receiveraudio" controls>
                                  Your browser does not support audio playback. Kindly upgrade your
                                  browser!!!
                                </audio> -->
                                    </div>

                                  </div>
                                </div>

                                <!-- Replying location -->
                                <div *ngIf="user.parentId?.locationurl && user.parentId?.Gps "
                                  (click)="selectedMessage(user,i)">
                                  <div class="d-flex ">
                                    <div class="min-width-0 width250">
                                      <p class="mb-0  txt-hide" *ngIf="user.parentId?.locationlabel">
                                        {{user.parentId?.locationlabel}}</p>
                                      <!-- <small  class="mb-0 ">{{user?.pid?.type}}</small>  -->
                                    </div>
                                    <div class="text-right ">
                                      <img src="assets/map.png" width="60px" height="100%">
                                    </div>

                                  </div>
                                  <!-- <app-messagemap [coordinates]="user.parentId?.Gps" name="location" #map appId="APP-ID-HERE"
                                      appCode="APP-CODE-HERE" height="800px">
                                     
                                    </app-messagemap>
                                    <a style="cursor: pointer;" href={{user.parentId?.locationurl}} target="_blank">
                                      <mat-icon class="mapicon">zoom_out_map</mat-icon>
                                    </a> -->
                                </div>



                                <!-- Replying Docs -->
                                <div
                                  *ngIf="user?.parentId && user?.pid != null && user?.parentId?.photo && (user?.pid.type ==  'application/pdf' || user?.pid.type ==  'text/plain' || user?.pid.type ==  'text/csv' || user?.pid.type ==  'application/msword' || user?.pid.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' || user?.pid.type == 'application/vnd.ms-powerpoint' || user?.pid.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation' || user?.pid.type == 'application/vnd.ms-excel' ||  user?.pid.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet') && !(user?.deletingMsgstatus == '1')">
                                  <div (click)="selectedMessage(user,i)" id="{{user._id}}">
                                    <div *ngIf=" user?.pid.type == 'application/pdf'" class="d-flex">

                                      <div class="flex-1 min-width-0 width250">
                                        <p class="text-left txt-hide  pr-3 font-14 pt-2">{{ user?.pid.name}}</p>
                                      </div>
                                      <div>
                                        <img src="assets/images/pdfnew.png" data-backdrop="none" width="100%" />

                                      </div>
                                    </div>

                                    <div *ngIf=" user?.pid.type == 'text/plain'" class="d-flex">
                                      <div class="flex-1 min-width-0 width250">
                                        <p class="text-left txt-hide  pr-3 font-14 pt-2">{{ user?.pid.name}}</p>
                                      </div>
                                      <div>
                                        <img src="assets/images/txt.png" data-backdrop="none" width="100%" />
                                      </div>
                                    </div>

                                    <div *ngIf=" user?.pid.type == 'text/csv'" class="d-flex">
                                      <div class="flex-1 min-width-0 width250">
                                        <p class="text-left txt-hide  pr-3 font-14 pt-2">{{ user?.pid.name}}</p>
                                      </div>
                                      <div>
                                        <img src="assets/images/csv.png" data-backdrop="none" width="100%" />
                                      </div>
                                    </div>

                                    <div *ngIf=" user?.pid.type == 'application/msword'" class="d-flex">

                                      <div class="flex-1 min-width-0 width250">
                                        <p class="text-left txt-hide  pr-3 font-14 pt-2">{{ user?.pid.name}}</p>
                                      </div>

                                      <div>
                                        <img src="assets/images/doc.png" data-backdrop="none" width="100%" />

                                      </div>
                                    </div>

                                    <div
                                      *ngIf=" user?.pid.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'"
                                      class="d-flex">
                                      <div class="flex-1 min-width-0 width250">
                                        <p class="text-left txt-hide  pr-3 font-14 pt-2">{{ user?.pid.name}}</p>
                                      </div>
                                      <div>
                                        <img src="assets/images/word.png" data-backdrop="none" width="100%" />

                                      </div>

                                    </div>

                                    <div *ngIf=" user?.pid.type == 'application/vnd.ms-powerpoint'" class="d-flex">
                                      <div class="flex-1 min-width-0 width250">
                                        <p class="text-left txt-hide  pr-3 font-14 pt-2">{{ user?.pid.name}}</p>
                                      </div>
                                      <div>
                                        <img src="assets/images/pptnew.png" data-backdrop="none" width="100%" />

                                      </div>

                                    </div>

                                    <div
                                      *ngIf=" user?.pid.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'"
                                      class="d-flex">
                                      <div class="flex-1 min-width-0 width250">
                                        <p class="text-left txt-hide  pr-3 font-14 pt-2">{{ user?.pid.name}}</p>
                                      </div>
                                      <div>
                                        <img src="assets/images/pptx.png" data-backdrop="none" width="100%" />

                                      </div>

                                    </div>

                                    <div *ngIf=" user?.pid.type == 'application/vnd.ms-excel'" class="d-flex">

                                      <div class="flex-1 min-width-0 width250">
                                        <p class="text-left txt-hide  pr-3 font-14 pt-2">{{ user?.pid.name}}</p>
                                      </div>
                                      <div>
                                        <img src="assets/images/xls.png" data-backdrop="none" width="100%" />

                                      </div>
                                    </div>


                                    <div
                                      *ngIf=" user?.pid.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'"
                                      class="d-flex">

                                      <div class="flex-1 min-width-0 width250">
                                        <p class="text-left txt-hide  pr-3 font-14 pt-2">{{ user?.pid.name}}</p>
                                      </div>
                                      <div>
                                        <img src="assets/images/xlsx.png" data-backdrop="none" width="100%" />

                                      </div>
                                    </div>

                                  </div>
                                </div>

                              </div>

                            </div>
                          </div>

                          <!-- <i   (click)="replymsg()" class="fas fa-times-circle closereply pointer"></i> -->

                          <p *ngIf="!(user?.deletingMsgstatus == '1') && user.message!=null && user.message!=undefined && !user.edit && user.urlLink =='null'"
                            class="mb-0 chatmsgspd" id="{{user._id}}">
                            {{user.message}} </p>
                          <div *ngIf="(user?.urlLink == 'urllink') && !(user?.deletingMsgstatus == '1')"
                            class="width250 min-width-0">
                            <div class="txt-hide chatmsgspd" id="{{user._id}}">
                              <a target="_blank" href="{{user?.message}}" class="font-color">{{user.message}}</a>
                            </div>

                          </div>
                          <!-- <i class="fas fa-reply float-right replymsg pb-2"></i> -->
                          <!-- embeeding map newly added into message body -->
                          <div class="position-relative">
                            <div
                              *ngIf="user.locationurl && user.Gps && id == user.senderId && user?.deletingMsgstatus != '1'"
                              id="{{user._id}}">
                              <!-- {{user.Gps | json}} -->
                              <app-messagemap [coordinates]="user.Gps" name="location" #map appId="APP-ID-HERE"
                                appCode="APP-CODE-HERE">
                              </app-messagemap>
                              <a style="cursor: pointer;" href={{user.locationurl}} target="_blank">
                                <mat-icon class="mapicon">zoom_out_map</mat-icon>
                              </a>
                            </div>
                          </div>
                          <!-- map end -->

                          <button *ngIf='user.edit' (click)="editingData(user.message, user._id,user)">
                            <mat-icon class="btn btn-success">check</mat-icon>
                          </button>
                          <button *ngIf='user.edit' (click)="user.edit=false ; user.edit2=false">
                            <mat-icon class="btn btn-danger">close</mat-icon>
                          </button>
                        </div>
                        <p *ngIf="(user?.deletingMsgstatus == '1')" class="mb-0 hashtxt chatmsgspd">
                          {{user?.MessageHash}}</p>
                        <div *ngIf="!(user?.deletingMsgstatus == '1')">
                          <div *ngIf="user.photo!=[] && id== user.senderId" id="{{user._id}}">
                            <!---------------------------------------------------------------------- Image Sending -------------------------------------------------------------->
                            <div *ngFor="let img of user.photo; let i=index" class="position-relative">
                              <div *ngFor="let type of imgmimetype">
                                <div *ngIf="img.type == type">
                                  <div (click)="openModal(img)">
                                    <img src="{{img.path}}" class="imagebr1" alt="User pic" width="100%" height="100%" />
                                  </div>
                                  <div>
                                    <button type="button" class="btn btn-download" fileSaver [method]="'GET'"
                                      fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                                      (error)="Downloadfail($event)">
                                      <img src="assets/images/download.png">
                                    </button>
                                  </div>

                                </div>
                              </div>
                            </div>


                            <!---------------------------------------------------------------------- Audio Sending -------------------------------------------------------------->
                            <div *ngFor="let img of user.photo; let i=index" id="{{user._id}}">
                              <div *ngFor="let type of audiomimetype">
                                <div *ngIf="img.type == type" class="documentview p-2">
                                  <audio src="{{img.path}}" preload="none" alt="User audio" style="width:200px;"
                                    controls controlsList="nodownload" class="htmlvideo">
                                    Your browser does not support audio playback. Kindly upgrade your
                                    browser!!!
                                  </audio>
                                </div>
                              </div>
                            </div>

                            <!---------------------------------------------------------------------- Video Sending -------------------------------------------------------------->
                            <div *ngFor="let img of user.photo ; let i=index" id="{{user._id}}">
                              <div *ngFor="let type of videomimetype">
                                <div *ngIf="img.type == type" class="documentview">
                                  <div>
                                    <video src="{{img.path}}" preload="none" alt="User video"
                                      style=" width: 100%; height: 250px;" controls class="htmlvideo">
                                      Your browser does not support video playback. Kindly upgrade
                                      your browser!!!
                                    </video>
                                  </div>
                                </div>

                              </div>

                            </div>
                          </div>

                          <!---------------------------------------------------------------------- Document Sending fixed issue start -------------------------------------------------------------->

                          <div *ngFor="let img of user.photo; let i=index" class="documentview" id="{{user._id}}">
                            <div *ngIf="img.type == 'application/pdf'" fileSaver [method]="'GET'"
                              fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                              (error)="Downloadfail($event)" class="d-flex pdfdiv">
                              <div>
                                <img src="assets/images/pdfnew.png" data-backdrop="none" width="100%" />

                              </div>
                              <div class="flex-1 min-width-0 width250">
                                <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>

                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>


                            <div *ngIf="img.type == 'text/plain'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                              url="{{img.path}}" (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                              class="d-flex pdfdiv">
                              <div>
                                <img src="assets/images/txt.png" data-backdrop="none" width="100%" />
                              </div>
                              <div class="flex-1 min-width-0 width250">
                                <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>

                            <div *ngIf="img.type == 'text/csv'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                              url="{{img.path}}" (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                              class="d-flex pdfdiv">
                              <div>
                                <img src="assets/images/csv.png" data-backdrop="none" width="100%" />

                              </div>
                              <div class="flex-1 min-width-0 width250">
                                <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>

                            <div *ngIf="img.type == 'application/msword'" fileSaver [method]="'GET'"
                              fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                              (error)="Downloadfail($event)" class="d-flex pdfdiv">
                              <div>
                                <img src="assets/images/doc.png" data-backdrop="none" width="100%" />

                              </div>
                              <div class="flex-1 min-width-0 width250">
                                <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>

                            <div
                              *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'"
                              fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                              (success)="DownloadSuccess($event)" (error)="Downloadfail($event)" class="d-flex pdfdiv">
                              <div>
                                <img src="assets/images/word.png" data-backdrop="none" width="100%" />

                              </div>
                              <div class="flex-1 min-width-0 width250">
                                <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>

                            <div *ngIf="img.type == 'application/vnd.ms-powerpoint'" fileSaver [method]="'GET'"
                              fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                              (error)="Downloadfail($event)" class="d-flex pdfdiv">
                              <div>
                                <img src="assets/images/ppt.png" data-backdrop="none" width="100%" />

                              </div>
                              <div class="flex-1 min-width-0 width250">
                                <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>

                            <div
                              *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'"
                              fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                              (success)="DownloadSuccess($event)" (error)="Downloadfail($event)" class="d-flex pdfdiv">
                              <div>
                                <img src="assets/images/pptx.png" data-backdrop="none" width="100%" />

                              </div>
                              <div class="flex-1 min-width-0 width250">
                                <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>

                            <div *ngIf="img.type == 'application/vnd.ms-excel'" fileSaver [method]="'GET'"
                              fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                              (error)="Downloadfail($event)" class="d-flex pdfdiv">
                              <div>
                                <img src="assets/images/xls.png" data-backdrop="none" width="100%" />

                              </div>
                              <div class="flex-1 min-width-0 width250">
                                <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>


                            <div *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'"
                              fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                              (success)="DownloadSuccess($event)" (error)="Downloadfail($event)" class="d-flex pdfdiv">
                              <div>
                                <img src="assets/images/xlsx.png" data-backdrop="none" width="100%" />

                              </div>
                              <div class="flex-1 min-width-0 width250">
                                <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>

                          </div>
                          <!---------------------------------------------------------------------- Document Sending Fixed issue end -------------------------------------------------------------->





                          <div *ngIf="user.media" class="p-2" id="{{user._id}}">
                            <audio controls style="width:100%" class="htmlvideo" controls controlsList="nodownload">
                              <source src="{{user.media?.path}}" type="audio/webm">
                            </audio>
                            <!-- <button type="button" class="btn btn-download" fileSaver [method]="'GET'"
                                fileName="{{user.media?.name}}" url="{{user.media?.path}}"
                                (success)="DownloadSuccess($event)" (error)="Downloadfail($event)">
                                <img src="assets/images/download.png">
                              </button> -->
                          </div>


                        </div>

                        <!-- <i class="fas fa-reply  replymsg pb-2 senderreply" (click)="reply(user)"
                          *ngIf="!(user?.deletingMsgstatus == '1')"></i> -->
                      </div>
                      <!-- <div class="showoptions" *ngIf="!(user?.deletingMsgstatus == '1')"
                          [ngClass]="{'optionsviewdiv':!(user.locationurl && user.Gps && id == user.senderId)}">
                          <span (click)="forwardmsg(user)">Forward</span>
                          <span class="pl-3" (click)="edit1(user)"
                            *ngIf="!(user.locationurl && user.Gps && id == user.senderId)">Edit</span>
                          <span class="pl-3" (click)="del(user,i)">Delete</span>
                          <span class="pl-3" *ngIf="user?.fromStaredMessage == 0"
                            (click)="star(user,loginuserdata.id,i)">Make Favourite</span>
                          <span class="pl-3" *ngIf="user?.fromStaredMessage !=0"
                            (click)="star(user,loginuserdata.id,i)">Remove Favourite</span>
                          <span class="pl-3" (click)="copyMessage(user.message)" value="click to copy">copy</span>
                        </div>
                        <div class="showoptions" *ngIf="(user?.deletingMsgstatus == '1')"
                          [ngClass]="{'optionsviewdiv':!(user.locationurl && user.Gps && id == user.senderId)}">

                          <span (click)="undel(user,i)"> Undo Delete</span>

                        </div> -->


                      <!---------------------------------------------------------------------- Document Sending -------------------------------------------------------------->

                      <!---------------------------------------------------------------------- Doc files -------------------------------------------------------------->

                      <div class="text-right">
                        <!-- <span *ngIf="!(user?.deletingMsgstatus == '1')" class="ticks">{{user.messageStatus}}</span> -->
                        <span
                          *ngIf="!(user?.deletingMsgstatus == '1') && (user?.messageStatus == '✔' || user?.messageStatus == '✔✔' || user?.messageStatus == 'seen')"
                          class="ticks">{{user?.messageStatus}}</span>
                        <!-- <span *ngIf="!(user?.deletingMsgstatus == '1')" class="ticks"> &#x2713;&#x2713;</span> -->
                        <span class="timer_msg pl-2">{{user.create_At | dateago}}</span>

                      </div>
                    </div>

                    <div>
                      <ngx-avatar [name]="user.senderName" value="28%" size="40" [round]="false" [cornerRadius]="10" *ngIf="!(user?.senderimg?.path)">
                      </ngx-avatar>
                      <div *ngIf="user.senderimg?.path">   
                        <img src="{{user.senderimg?.path}}" width="50px" height="50px">
                      </div> 
                      <!-- <div class="circle sender_name">{{user.senderName | slice:0:1 | uppercase}}</div> -->
                    </div>
                  </div>

                </div>
              </div>
            </div>
         </div>
      </div>
      </div>

      <div class="backdrop" [ngStyle]="{'display':display}"></div>
      <div class="modal modal_fade" tabindex="-1" role="dialog" [ngStyle]="{'display':display}">
        <div class="modal-dialog modal-dialog-centered" role="dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h4 class="modal-title">
                {{selectphoto?.name}}</h4>
              <button type="button" class="close" (click)="closeModal()">
                <mat-icon>close</mat-icon>
              </button>
            </div>
            <div class="modal-body">
              <p><img src="{{selectphoto?.path}}" id="ImageZoom" style=" height: 100%; width: 100%;">
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- // This is for star message  -->
      <div class="row chatbg chatbox poppins-font " *ngIf='starmsg1 == true' [scrollTop]='scrolltop'
        [ngStyle]="{'height.px': divheight}">
        <div class="col-lg-12">
          <div *ngFor="let starMsg of Staredmessage | message : { message: searchTerm1 } : false ;let i =index">
            <div class="row mt-3">
              <div class="col-lg-6 col-xl-5 col-md-6 col-sm-12">
                <div *ngIf="id == starMsg.receiverId">
                  <div class="d-flex ml-2">
                    <div>
                      <ngx-avatar [name]="starMsg.senderName" *ngIf="!(starMsg?.senderimg.path)" value="28%" size="44" [round]="false" [cornerRadius]="12">
                      </ngx-avatar>
                      <img src={{starMsg?.senderimg.path}} width="50px" height="50px">
                      <!-- <div class="circle receiver_name">{{starMsg.senderName | slice:0:1 | uppercase}}</div> -->
                    </div>

                    <!-- receiver data -->
                    <div class="ml-2 hoveroptions receiverhoverpd min-width-0">
                      <div class=" position-relative"
                        [ngClass]="{'receiver_msg':!(starMsg.locationurl && starMsg.Gps && id== starMsg.receiverId),'bg-fff border':starMsg.locationurl && starMsg.Gps && id== starMsg.receiverId}">
                        <div>
                          <!-- <i class="fas fa-reply float-right replymsg pb-2"></i> -->
                          <div
                            *ngIf="!(starMsg?.deletingMsgstatus == '1') && starMsg.message!=null && starMsg.message!=undefined && !starMsg.edit">
                            <p class="mb-0 chatmsgspd"> {{starMsg.message}} </p>
                          </div>

                          <div *ngIf="(starMsg?.deletingMsgstatus == '1')">
                            <p class="hashtxt  mb-0">{{starMsg?.MessageHash}}</p>
                          </div>

                          <!-- <div>
                          <p>{{user.create_At | date}}</p>
                         </div> -->

                          <div
                            *ngIf="starMsg.photo!=[] && id == starMsg.receiverId && !(starMsg?.deletingMsgstatus == '1')">
                            <div *ngFor="let img of starMsg.photo">


                              <!----------------------------------------------------------------- Image of receiver ---------------------------------------------------------------->
                              <div *ngFor="let type of imgmimetype" class="position-relative">
                                <div *ngIf="img.type == type">
                                  <div data-backdrop="true" data-keyboard="true" (click)="openModal(img)">
                                    <img class="rounded" src="{{img.path}}" alt="User pic" width="100%" height="100%"
                                      class="imagebr" />
                                  </div>
                                  <button type="button" fileSaver [method]="'GET'" fileName="{{img.name}}"
                                    url="{{img.path}}" (success)="DownloadSuccess($event)"
                                    (error)="Downloadfail($event)" class="btn btn-download">
                                    <img src="assets/images/download.png">
                                  </button>
                                </div>
                              </div>


                              <!----------------------------------------------------------------- Audio of receiver ---------------------------------------------------------------->

                              <div *ngFor="let type of audiomimetype">
                                <div *ngIf="img.type == type" class="p-2">
                                  <audio src="{{img.path}}" preload="none" alt="User audio" style="width:100%;"
                                    class="htmlvideo receiveraudio" controls>
                                    Your browser does not support audio playback. Kindly upgrade your
                                    browser!!!
                                  </audio>
                                </div>
                              </div>

                              <!----------------------------------------------------------------- Video of receiver ---------------------------------------------------------------->

                              <div *ngFor="let type of videomimetype">
                                <div *ngIf="img.type == type">

                                  <video src="{{img.path}}" preload="none" alt="User audio" width="100%" height="225px"
                                    controls class="htmlvideo">
                                    Your browser does not support video playback. Kindly upgrade your
                                    browser!!!
                                  </video>
                                </div>
                              </div>

                              <!----------------------------------------------------------------- Document of receiver ---------------------------------------------------------------->


                              <div
                                *ngIf="img.type ==  'application/pdf' || img.type ==  'text/plain' || img.type ==  'text/csv' || img.type ==  'application/msword' || img.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' || img.type == 'application/vnd.ms-powerpoint' || img.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation' || img.type == 'application/vnd.ms-excel' ||  img.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' ">
                                <!-- pdf view -->


                                <div *ngIf="img.type == 'application/pdf'" fileSaver [method]="'GET'"
                                  fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                                  (error)="Downloadfail($event)" class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/images/pdfnew.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>


                                <div *ngIf="img.type == 'text/plain'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                                  url="{{img.path}}" (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                  class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/docicons/txt.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>

                                <div *ngIf="img.type == 'text/csv'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                                  url="{{img.path}}" (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                  class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/docicons/csv.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>


                                <div *ngIf="img.type == 'application/msword'" type="button" style="border: none;"
                                  fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                                  (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                  class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/docicons/doc.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>


                                <div
                                  *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'"
                                  fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                                  (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                  class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/docicons/word.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>


                                <div *ngIf="img.type == 'application/vnd.ms-powerpoint'" fileSaver [method]="'GET'"
                                  fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                                  (error)="Downloadfail($event)" class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/docicons/ppt.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>

                                <div
                                  *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'"
                                  fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                                  (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                  class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/docicons/pptx.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>


                                <div *ngIf="img.type == 'application/vnd.ms-excel'" fileSaver [method]="'GET'"
                                  fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                                  (error)="Downloadfail($event)" class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/docicons/xls.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>

                                <div
                                  *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'"
                                  fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                                  (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                  class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/docicons/xlsx.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>

                              </div>

                            </div>
                          </div>
                          <div *ngIf="starMsg.media" class="p-2">
                            <audio controls controlsList="nodownload" class="receiveraudio htmlvideo">
                              <source src="{{starMsg.media?.path}}" type="audio/webm" style="width:100%">
                            </audio>
                            <!-- <button type="button" class="btn btn-download" fileSaver [method]="'GET'"
                              fileName="{{starMsg.media?.name}}" url="{{starMsg.media?.path}}"
                              (success)="DownloadSuccess($event)" (error)="Downloadfail($event)">
                              <img src="assets/images/download.png">
                            </button> -->
                          </div>

                          <div class="position-relative">

                            <span *ngIf="starMsg.locationurl && starMsg.Gps && id== starMsg.receiverId">
                              <app-messagemap [coordinates]="starMsg.Gps" name="location" #map appId="APP-ID-HERE"
                                appCode="APP-CODE-HERE" height="800px">
                              </app-messagemap>
                              <a style="cursor: pointer;" href={{starMsg.locationurl}} target="_blank">
                                <mat-icon class="mapicon">zoom_out_map</mat-icon>
                              </a>
                            </span>
                          </div>


                        </div>
                        <!-- <div class="showoptions" *ngIf="!(starMsg?.deletingMsgstatus == '1')">
                          <span *ngIf="!(starMsg?.deletingMsgstatus == '1') && starMsg?.toStaredMessage == 0 "
                            (click)="star(starMsg,loginuserdata.id,i)">Make Favourite</span>
                          <span class="pl-3"
                            *ngIf="!(starMsg?.deletingMsgstatus == '1') && starMsg?.toStaredMessage !=0 "
                            (click)="star(starMsg,loginuserdata.id,i)">Remove Favourite</span>
                          <span class="pl-3" (click)="forwardmsg(starMsg)">Forward</span>

                        </div>
                        <div class="showoptions" *ngIf="(starMsg?.deletingMsgstatus == '1')">
                          <span>Undo delete</span>
                        </div> -->
                      </div>
                      <div>
                        <span *ngIf="!(starMsg?.deletingMsgstatus == '1')" class="ticks"> &#x2713;&#x2713;</span>
                        <span class="timer_msg pl-2">{{starMsg.create_At |  dateago }}</span>
                      </div>
                    </div>

                    <div>

                      <i class="material-icons pointer color3" 
                        [matMenuTriggerFor]="menu1">more_vert</i>
                      <mat-menu #menu1="matMenu" class="chatpopup">
                        <button class="menubtn" mat-menu-item
                          *ngIf="!(starMsg?.deletingMsgstatus == '1') && starMsg?.toStaredMessage == 0 "
                          (click)="star(starMsg,loginuserdata.id,i)">Make Favourite</button>



                        <button mat-menu-item class="menubtn"
                          *ngIf="!(starMsg?.deletingMsgstatus == '1') && starMsg?.toStaredMessage !=0 "
                          (click)="star(starMsg,loginuserdata.id,i)">Remove Favourite</button>

                        <span *ngIf="starMsg?.deletingMsgstatus != '1'"><button class="menubtn" mat-menu-item
                            (click)="forwardmsg(starMsg)" (click)="ForOneToOneGroups()">Forward Message</button></span>
                      </mat-menu>

                    </div>
                  </div>


                </div>

              </div>

              <div class="col-lg-6 col-xl-5 col-md-6 col-sm-12 ml-auto">
                <div *ngIf="id != starMsg.receiverId">
                  <div class="d-flex mr-2" style="justify-content: flex-end;">
                    <div>

                      <i class="material-icons pointer color3" 
                        [matMenuTriggerFor]="menusender">more_vert</i>
                      <mat-menu #menusender="matMenu" class="chatpopup">
                        <button class="menubtn" mat-menu-item *ngIf="!(starMsg?.deletingMsgstatus == '1')"
                          (click)="del(starMsg,i)">Delete</button>
                        <!-- <button class="menubtn" mat-menu-item
                          *ngIf="!(starMsg?.deletingMsgstatus == '0' || starMsg?.deletingMsgstatus == 'value will be updated')"
                          (click)="undel(starMsg,i)">Undo Delete</button> -->

                          <button *ngIf="(starMsg?.deletingMsgstatus == '1')" mat-menu-item
                          class="menubtn" (click)="copyHash(starMsg.MessageHash)">Copy Hash</button>

                        <button class="menubtn" mat-menu-item *ngIf="!(starMsg?.deletingMsgstatus == '1')"
                          (click)="edit1(starMsg)">Edit</button>
                        <span *ngIf="starMsg?.deletingMsgstatus != '1'"><button class="menubtn" mat-menu-item
                            (click)="forwardmsg(starMsg)" (click)="ForOneToOneGroups()">Forward Message</button></span>
                        <button class="menubtn" mat-menu-item
                          *ngIf="starMsg?.fromStaredMessage == 0 && !(starMsg?.deletingMsgstatus == '1')"
                          (click)="star(starMsg,loginuserdata.id,i)">Make Favourite</button>
                        <button mat-menu-item class="menubtn"
                          *ngIf="starMsg?.fromStaredMessage !=0  && !(starMsg?.deletingMsgstatus == '1')"
                          (click)="star(starMsg,loginuserdata.id,i)">Remove Favourite</button>
                        <button mat-menu-item class="menubtn"
                          *ngIf="starMsg?.deletingMsgstatus != '1'  && (starMsg.photo.length>0 || starMsg.media) "
                          (click)="DownloadMedia(starMsg.photo,starMsg.media)">Download</button>
                      </mat-menu>

                    </div>

                    <div class="mr-2 hoveroptions senderhoverpd  min-width-0">
                      <div class="position-relative"
                        [ngClass]="{'sendertxt':!(starMsg.locationurl && starMsg.Gps && id == starMsg.senderId) ,'bg-fff border':starMsg.locationurl && starMsg.Gps && id == starMsg.senderId}">
                        <div>
                          <!-- <i class="fas fa-reply float-right replymsg pb-2"></i> -->
                          <p *ngIf="!(starMsg?.deletingMsgstatus == '1') && starMsg.message!=null && starMsg.message!=undefined && !starMsg.edit"
                            class="mb-0 chatmsgspd">
                            {{starMsg.message}} </p>
                          <!-- Text editing -->
                          <div class="position-relative">

                            <span *ngIf="starMsg.locationurl && starMsg.Gps && id== starMsg.senderId">
                              <app-messagemap [coordinates]="starMsg.Gps" name="location" #map appId="APP-ID-HERE"
                                appCode="APP-CODE-HERE" height="800px">
                              </app-messagemap>
                              <a style="cursor: pointer;" href={{starMsg.locationurl}} target="_blank">
                                <mat-icon class="mapicon">zoom_out_map</mat-icon>
                              </a>
                            </span>
                          </div>
                          <div>
                            <input *ngIf='starMsg.edit' type="text"
                              (keydown)="keyDownFunction($event,starMsg.message, starMsg._id, starMsg)"
                              [(ngModel)]="starMsg.message" name='message'>

                            <button *ngIf='starMsg.edit' (click)="editingData(starMsg.message, starMsg._id,starMsg)">
                              <mat-icon class="btn btn-success">check</mat-icon>
                            </button>
                            <button *ngIf='starMsg.edit' (click)="starMsg.edit=false ; starMsg.edit2=false">
                              <mat-icon class="btn btn-danger">close</mat-icon>
                            </button>
                          </div>
                          <p *ngIf="(starMsg?.deletingMsgstatus == '1')" class="mb-0 hashtxt chatmsgspd">
                            {{starMsg?.MessageHash}}</p>
                          <div *ngIf="!(starMsg?.deletingMsgstatus == '1')">
                            <div *ngIf="starMsg.photo!=[] && id== starMsg.senderId">

                              <!---------------------------------------------------------------------- Image Sending -------------------------------------------------------------->
                              <div *ngFor="let img of starMsg.photo" class="position-relative">
                                <div *ngFor="let type of imgmimetype">
                                  <div *ngIf="img.type == type">
                                    <div (click)="openModal(img)">
                                      <img src="{{img.path}}" class="imagebr1" alt="User pic" width="100%"
                                        height="100%" />
                                    </div>
                                    <div>
                                      <button type="button" class="btn btn-download" fileSaver [method]="'GET'"
                                        fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                                        (error)="Downloadfail($event)">
                                        <img src="assets/images/download.png">
                                      </button>
                                    </div>

                                  </div>
                                </div>
                              </div>


                              <!---------------------------------------------------------------------- Audio Sending -------------------------------------------------------------->
                              <div *ngFor="let img of starMsg.photo">
                                <div *ngFor="let type of audiomimetype">
                                  <div *ngIf="img.type == type" class="documentview p-2">
                                    <audio src="{{img.path}}" preload="none" alt="User audio" style="width:200px;"
                                      controls controlsList="nodownload" class="htmlvideo">
                                      Your browser does not support audio playback. Kindly upgrade your
                                      browser!!!
                                    </audio>
                                  </div>
                                </div>
                              </div>

                              <!---------------------------------------------------------------------- Video Sending -------------------------------------------------------------->
                              <div *ngFor="let img of starMsg.photo">
                                <div *ngFor="let type of videomimetype">
                                  <div *ngIf="img.type == type" class="documentview">
                                    <div>
                                      <video src="{{img.path}}" preload="none" alt="User video"
                                        style=" width: 100%; height: 250px;" controls class="htmlvideo">
                                        Your browser does not support video playback. Kindly upgrade
                                        your browser!!!
                                      </video>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>

                            <!---------------------------------------------------------------------- Document Sending -------------------------------------------------------------->

                            <div *ngFor="let img of starMsg.photo">
                              <div *ngIf="img.type == 'application/pdf'" fileSaver [method]="'GET'"
                                fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                                (error)="Downloadfail($event)" class="d-flex pdfdiv ">
                                <div>
                                  <img src="./assets/images/pdfnew.png" data-backdrop="none" width="100%" />

                                </div>
                                <div class="flex-1 min-width-0 width250">
                                  <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                </div>
                                <div>
                                  <img src="assets/images/download.png">
                                </div>
                              </div>


                              <div *ngIf="img.type == 'text/plain'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                                url="{{img.path}}" (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                class="d-flex pdfdiv">
                                <div>
                                  <img src="assets/docicons/txt.png" data-backdrop="none" width="100%" />

                                </div>
                                <div class="flex-1 min-width-0 width250">
                                  <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                </div>
                                <div>
                                  <img src="assets/images/download.png">
                                </div>
                              </div>

                              <div *ngIf="img.type == 'text/csv'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                                url="{{img.path}}" (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                class="d-flex pdfdiv ">
                                <div>
                                  <img src="assets/docicons/csv.png" data-backdrop="none" width="100%" />

                                </div>
                                <div class="flex-1 min-width-0 width250">
                                  <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                </div>
                                <div>
                                  <img src="assets/images/download.png">
                                </div>
                              </div>

                              <div *ngIf="img.type == 'application/msword'" fileSaver [method]="'GET'"
                                fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                                (error)="Downloadfail($event)" class="d-flex pdfdiv">
                                <div>
                                  <img src="assets/docicons/doc.png" data-backdrop="none" width="100%" />

                                </div>
                                <div class="flex-1 min-width-0 width250">
                                  <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                </div>
                                <div>
                                  <img src="assets/images/download.png">
                                </div>
                              </div>

                              <div
                                *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'"
                                fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                                (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                class="d-flex pdfdiv">
                                <div>
                                  <img src="assets/docicons/docx.png" data-backdrop="none" width="100%" />

                                </div>
                                <div class="flex-1 min-width-0 width250">
                                  <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                </div>
                                <div>
                                  <img src="assets/images/download.png">
                                </div>
                              </div>

                              <div *ngIf="img.type == 'application/vnd.ms-powerpoint'" fileSaver [method]="'GET'"
                                fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                                (error)="Downloadfail($event)" class="d-flex pdfdiv">
                                <div>
                                  <img src="assets/docicons/ppt.png" data-backdrop="none" width="100%" />

                                </div>
                                <div class="flex-1 min-width-0 width250">
                                  <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                </div>
                                <div>
                                  <img src="assets/images/download.png">

                                </div>
                              </div>

                              <div
                                *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'"
                                fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                                (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                class="d-flex pdfdiv">
                                <div>
                                  <img src="assets/docicons/pptx.png" data-backdrop="none" width="100%" />

                                </div>
                                <div class="flex-1 min-width-0 width250">
                                  <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                </div>
                                <div>
                                  <img src="assets/images/download.png">
                                </div>
                              </div>

                              <div *ngIf="img.type == 'application/vnd.ms-excel'" fileSaver [method]="'GET'"
                                fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                                (error)="Downloadfail($event)" class="d-flex pdfdiv">
                                <div>
                                  <img src="assets/docicons/xls.png" data-backdrop="none" width="100%" />

                                </div>
                                <div class="flex-1 min-width-0 width250">
                                  <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                </div>
                                <div>
                                  <img src="assets/images/download.png">
                                </div>
                              </div>


                              <div
                                *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'"
                                fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                                (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                class="d-flex pdfdiv">
                                <div>
                                  <img src="assets/docicons/xlsx.png" data-backdrop="none" width="100%" />

                                </div>
                                <div class="flex-1 min-width-0 width250">
                                  <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                </div>
                                <div>
                                  <img src="assets/images/download.png">
                                </div>
                              </div>
                              <!---------------------------------------------------------------------- Document Sending -------------------------------------------------------------->



                            </div>


                            <div *ngIf="starMsg.media" class="p-2">
                              <audio controls width="100%" class="htmlvideo" controlsList="nodownload">
                                <source src="{{starMsg.media?.path}}" type="audio/webm">
                              </audio>
                              <!-- <button type="button" class="btn btn-download" fileSaver [method]="'GET'"
                                fileName="{{starMsg.media?.name}}" url="{{starMsg.media?.path}}"
                                (success)="DownloadSuccess($event)" (error)="Downloadfail($event)">
                                <img src="assets/images/download.png">
                              </button> -->
                            </div>
                          </div>



                        </div>
                        <!-- <div class="showoptions" *ngIf="!(starMsg?.deletingMsgstatus == '1')">
                          <span (click)="forwardmsg(starMsg)">Forward</span>
                          <span class="pl-3" (click)="edit1(starMsg)">Edit</span>
                          <span class="pl-3" (click)="del(starMsg,i)">Delete</span>
                          <span class="pl-3" *ngIf="starMsg?.fromStaredMessage == 0"
                            (click)="star(starMsg,loginuserdata.id,i)">Make Favourite</span>
                          <span class="pl-3" *ngIf="starMsg?.fromStaredMessage !=0"
                            (click)="star(starMsg,loginuserdata.id,i)">Remove Favourite</span>
                        </div>
                        <div class="showoptions" *ngIf="(starMsg?.deletingMsgstatus == '1')">

                          <span (click)="undel(starMsg,i)"> Undo Delete</span>

                        </div> -->

                      </div>



                      <!---------------------------------------------------------------------- Document Sending -------------------------------------------------------------->

                      <!---------------------------------------------------------------------- Doc files -------------------------------------------------------------->

                      <div class="text-right">
                        <!-- <span *ngIf="!(user?.deletingMsgstatus == '1')" class="ticks">{{user.messageStatus}}</span> -->
                        <span *ngIf="!(starMsg?.deletingMsgstatus == '1')" class="ticks"> &#x2713;&#x2713;</span>
                        <span class="timer_msg pl-2">{{starMsg.create_At | dateago}}</span>

                      </div>
                    </div>
                    <div>
                      <ngx-avatar [name]="starMsg.senderName" *ngIf="!(starMsg?.senderimg.path)" value="28%" size="44" [round]="false" [cornerRadius]="12">
                      </ngx-avatar>
                      <img src={{starMsg?.senderimg.path}} width="50px" height="50px">
                      <!-- <div class="circle receiver_name">{{starMsg.senderName | slice:0:1 | uppercase}}</div> -->
                    </div>

                  </div>
                </div>


              </div>

            </div>
          </div>
        </div>
      </div>
      <!-- // This is for message input field  -->
      <div class="fixed-chat" *ngIf='starmsg1 == false' [ngClass]="{'incognitomode':incognitoRes}">

        <div class="row chat-border  pt-3 pb-3 poppins-font" [ngClass]="{'chatbg':!incognitoRes}">
          <div class="col-lg-12">

            <form #chat="ngForm" (ngSubmit)="chatbox(chat.value)">
              <ngx-file-drop class="filedrop" dropZoneLabel="Drop files here" (onFileDrop)="dropped($event)"
                (onFileOver)="fileOver($event)" (onFileLeave)="fileLeave($event)">
                <ng-template ngx-file-drop-content-tmp let-openFileSelector="openFileSelector">

                  <div class="row  ml-5">
                    <div class="col-lg-6 col-md-8 col-xl-4">
                      <!-- should be true only after we click reply button -->

                      <div class="row replytxtbg" *ngIf="message2">
                        <div class="col-2 pr-0" *ngIf="message2.senderName">
                          <ngx-avatar [name]="message2.senderName" value="28%" size="40" [round]="false" *ngIf=!(message2?.senderimg.path)
                            [cornerRadius]="10">
                          </ngx-avatar>  
                          <img src={{message2.senderimg.path}}  *ngIf=message2.senderimg.path width="50px" height="50px">
                        </div>
                        <div class="col-10 pl-0">
                          <p class="font-14 font-color txt-hide p-2" *ngIf="message2?.message"> {{message2?.message}}
                          </p>
                          <!-- <i  class="fas fa-times-circle closefa pointer"></i> -->
                          <!-- Replying Docs -->
                          <div *ngIf="message2 && message2?.photo && message2?.message == null">

                            <div *ngFor="let replydocs of message2?.photo">
                              <!-- <i   (click)="replymsg()" class="fas fa-times-circle closereply pointer"></i> -->
                              <div>
                                <!--Replying Image -->
                                <div *ngIf="message2 && message2?.photo ">
                                  <div *ngFor="let type of imgmimetype">
                                    <div *ngIf="replydocs.type == type" class="row m-0">
                                      <div class="col-8">
                                        <p class="txt-hide font-14 font-color mb-0">{{replydocs?.name}}</p>
                                        <small>{{replydocs?.type}}</small>
                                      </div>
                                      <div class="col-4 text-right">
                                        <img src="{{replydocs?.path}}" width="100%" height="100%">
                                      </div>
                                    </div>
                                  </div>

                                </div>
                                <!-- Replying Video -->
                                <div *ngIf="message2 && message2?.photo">
                                  <div *ngFor="let type of videomimetype">
                                    <div *ngIf="replydocs.type == type" class="row m-0">
                                      <div class="col-8">
                                        <p class="txt-hide font-14 font-color mb-0">{{replydocs?.name}}</p>
                                        <small>{{replydocs?.type}}</small>
                                      </div>
                                      <div class="col-4 text-right">
                                        <video src="{{replydocs?.path}}" class="htmlvideo" preload="none"
                                          alt="User video" style=" width: 100%; height: 100%;" controls>
                                          Your browser does not support video playback. Kindly upgrade
                                          your browser!!!
                                        </video>
                                      </div>

                                    </div>
                                  </div>

                                </div>

                                <div *ngIf="message2 && message2?.photo && message2?.message == null">
                                  <div *ngFor="let type of audiomimetype">
                                    <div *ngIf="replydocs?.type == type" class="row m-0">
                                      <div class="col-10">
                                        <p class="txt-hide font-14 font-color mb-0">{{replydocs?.name}}</p>
                                        <small>{{replydocs?.type}}</small>
                                      </div>
                                      <!--                          
                              <audio src="{{replyaudio?.path}}" preload="none" alt="User audio"
                               style="width:100%" class="d-block" controls>
                                Your browser does not support audio playback. Kindly upgrade your
                                browser!!!
                              </audio> -->
                                    </div>
                                  </div>

                                </div>

                                <div
                                  *ngIf="replydocs.type ==  'application/pdf' || replydocs.type ==  'text/plain' || replydocs.type ==  'text/csv' || replydocs.type ==  'application/msword' || replydocs.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' || replydocs.type == 'application/vnd.ms-powerpoint' || replydocs.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation' || replydocs.type == 'application/vnd.ms-excel' ||  replydocs.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'">
                                  <div>
                                    <div class="documentview">
                                      <div *ngIf="replydocs.type == 'application/pdf'" class="row m-0">
                                        <div class="col-9">
                                          <p class="text-left txt-hide font-14 font-color mb-0">{{replydocs.name}}</p>
                                          <p class="txt-hide font-12">{{replydocs.type}}</p>
                                        </div>
                                        <div class="col-3">
                                          <img src="./assets/images/pdfnew.png" data-backdrop="none" width="100%" />

                                        </div>
                                      </div>

                                      <div *ngIf=" replydocs.type == 'text/plain'" class="row m-0">

                                        <div class="col-9">
                                          <p class="text-left txt-hide font-14 font-color mb-0">{{ replydocs.name}}</p>
                                          <p class="txt-hide font-12">{{replydocs.type}}</p>
                                        </div>
                                        <div class="col-3">
                                          <img src="assets/docicons/txt.png" data-backdrop="none" width="100%" />
                                        </div>
                                      </div>

                                      <div *ngIf="replydocs.type == 'text/csv'" class="row m-0">

                                        <div class="col-9">
                                          <p class="text-left txt-hide font-14 font-color mb-0">{{ replydocs.name}}</p>
                                          <p class="txt-hide font-12">{{replydocs.type}}</p>
                                        </div>
                                        <div class="col-3">
                                          <img src="assets/docicons/csv.png" data-backdrop="none" width="100%" />
                                        </div>
                                      </div>

                                      <div *ngIf=" replydocs.type == 'application/msword'" class="row m-0">

                                        <div class="col-9">
                                          <p class="text-left txt-hide font-14 font-color mb-0">{{replydocs.name}}</p>
                                          <p class="txt-hide font-12">{{replydocs.type}}</p>
                                        </div>
                                        <div class="col-3">
                                          <img src="assets/docicons/doc.png" data-backdrop="none" width="100%" />

                                        </div>
                                      </div>

                                      <div
                                        *ngIf=" replydocs.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'"
                                        class="row m-0">

                                        <div class="col-9">
                                          <p class="text-left txt-hide font-14 font-color mb-0">{{replydocs.name}}</p>
                                          <p class="txt-hide font-12">{{replydocs.type}}</p>
                                        </div>
                                        <div class="col-3">
                                          <img src="assets/docicons/docx.png" data-backdrop="none" width="100%" />

                                        </div>
                                      </div>

                                      <div *ngIf="replydocs.type == 'application/vnd.ms-powerpoint'" class="row m-0">

                                        <div class="col-9">
                                          <p class="text-left txt-hide font-14 font-color mb-0">{{ replydocs.name}}</p>
                                          <p class="txt-hide font-12">{{replydocs.type}}</p>
                                        </div>
                                        <div class="col-3">
                                          <img src="assets/docicons/ppt.png" data-backdrop="none" width="100%" />

                                        </div>
                                      </div>

                                      <div
                                        *ngIf=" replydocs.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'"
                                        class="row m-0">

                                        <div class="col-9">
                                          <p class="text-left txt-hide font-14 font-color mb-0">{{replydocs.name}}</p>
                                          <p class="txt-hide font-12">{{replydocs.type}}</p>
                                        </div>
                                        <div class="col-3">
                                          <img src="assets/docicons/pptx.png" data-backdrop="none" width="100%" />

                                        </div>
                                      </div>

                                      <div *ngIf="replydocs.type == 'application/vnd.ms-excel'" class="row m-0">

                                        <div class="col-9">
                                          <p class="text-left txt-hide font-14 font-color mb-0">{{ replydocs.name}}</p>
                                          <p class="txt-hide font-12">{{replydocs.type}}</p>
                                        </div>
                                        <div class="col-3">
                                          <img src="assets/docicons/xls.png" data-backdrop="none" width="100%" />

                                        </div>
                                      </div>


                                      <div
                                        *ngIf=" replydocs.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'"
                                        class="row m-0">

                                        <div class="col-9">
                                          <p class="text-left txt-hide font-14 font-color mb-0">{{ replydocs.name}}</p>
                                          <p class="txt-hide font-12">{{replydocs.type}}</p>
                                        </div>
                                        <div class="col-3">
                                          <img src="assets/docicons/xlsx.png" data-backdrop="none" width="100%" />

                                        </div>
                                      </div>

                                    </div>
                                  </div>
                                </div>
                              </div>




                            </div>


                            <!-- Replying location -->
                            <div *ngIf="message2?.locationurl && message2?.Gps ">
                              <div class="row m-0">
                                <div class="col-8">
                                  <p class="txt-hide font-14 font-color mb-0" *ngIf="message2?.locationlabel">
                                    {{message2?.locationlabel}}</p>
                                  <!-- <small  class="mb-0 ">{{user?.pid?.type}}</small>  -->
                                </div>
                                <div class="col-4 text-right">
                                  <img src="assets/map.png" width="100%" height="100%">
                                </div>

                              </div>
                              <!-- <app-messagemap [coordinates]="message2?.Gps" name="location" #map appId="APP-ID-HERE"
                      appCode="APP-CODE-HERE" height="800px">
                    </app-messagemap>
                    <a style="cursor: pointer;" href={{message2?.locationurl}} target="_blank">
                      <mat-icon class="mapicon">zoom_out_map</mat-icon>
                    </a> -->
                            </div>

                            <!--Replying Audio -->
                            <div *ngIf="message2 && message2?.media && message2?.message == null">
                              <div *ngFor="let type of audiomimetype">
                                <div *ngIf="message2?.media?.type == type" class="row m-0">
                                  <div class="col-10">
                                    <p class="txt-hide font-14 font-color mb-0">{{message2?.media?.name}}</p>
                                    <small>{{message2?.media?.type}}</small>
                                  </div>
                                  <!-- <audio src="{{message2?.media?.path}}" preload="none" alt="User audio"
                            class="d-block receiveraudio" width="100%" controls>
                              Your browser does not support audio playback. Kindly upgrade your
                              browser!!!
                            </audio> -->
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <i (click)="replymsg()" class="fas fa-times-circle closereply pointer"></i>
                      </div>


                    </div>

                  </div>
                  <!-----------------------------------------------------------------repling message ---------------------------------------------------------->











                  <!-- button for cancling the preview of reply message   loginuserdata?.EmailId,chatuser?.EmailId
                  <button *ngIf="message2" (click)="replymsg()" mat-mini-fab color="warn"><img
                      src="assets/images/close1.png"></button> -->
                  <!-----------------------------------------------------------reply messag end --------------------------------------------------------------------->
                  <div *ngIf = "msgIndicator && msgIndicator?.login?.EmailId == chatuser?.EmailId && msgIndicator?.chat?.EmailId == loginuserdata?.EmailId">{{chatuser.Name}} is typing a message......</div> 
                  <div class="row">
                    <div class="col-lg-7 col-md-12">
                      <div class="d-flex">
                        <i class="material-icons pointer" *ngIf="!isRecording && !blobUrl" (click)="startRecording()"
                          style="color:#AFAFAF; padding: .375rem .75rem; font-size: 29px;">mic_none </i>
                        <input #OnetoOneTextArea autocomplete="off" spellcheck="true"
                          (click)="getCursorPosition(OnetoOneTextArea)" (keyup)="getCursorPosition(OnetoOneTextArea)"  
                          type="text" name="message" placeholder="Type a Message" value="text" [(ngModel)]="searchValue"
                          ngModel class="form-control draginput"  [ngClass]="{'colorff':incognitoRes}" (paste)="mediaPaste($event,url)" #url="ngModel">
                      </div>
                      <div class="row" *ngIf="isRecording && !blobUrl">
                        <div class="col-8 videorecord m-3">
                          <div class="row">
                            <div class="col-6">
                              <p class="color5 font-14">Recording Audio</p>
                              <button type="button" class="stop-button" (click)="stopRecording()">
                                <i class="material-icons" style="padding: 6px 0px;">
                                  stop
                                </i>
                              </button>
                            </div>
                            <div class="col-6 pr-0 text-right" (click)="clearRecordedData()">
                              <!-- <i class="fas fa-times-circle" style="color:#000"></i> -->
                              <p class="p-3 record_time font-14"> {{recordedTime}} </p>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="col-lg-5 col-md-12">
                      <ul class="chaticons pl-0">
                        <!-- <li>
                          <mat-slide-toggle class="font-color poppins-font">Notify</mat-slide-toggle>
                        </li> -->
                        <li (click)="openMap()">
                          <img src="assets/images/location.svg" *ngIf="!incognitoRes">
                          <img src="assets/images/location22.svg" *ngIf="incognitoRes">
                        </li>

                        <!-- Previous map view  -->
                        <!-- <li (click)="sendlocation()">
                          <img src="assets/images/location.svg">
                      </li> -->
                        <li (click)="fileInput.click()">
                          <img src="assets/images/attachment.svg" *ngIf="!incognitoRes">
                          <img src="assets/images/001-attachment.svg" *ngIf="incognitoRes">
                          <label class="upload" style="cursor:pointer; margin: 0">
                            <input #fileInput type="file" onclick="this.value = null" (change)="fileProgress($event)"
                              style="display:none;" multiple />
                          </label>
                        </li>
                        <li>
                          <img (click)="openCamera()" src="assets/images/camera.svg" *ngIf="!incognitoRes">
                          <img (click)="openCamera()" src="assets/images/002-camera.svg" *ngIf="incognitoRes">
                        </li>
                        <li>
                          <img (click)="openEmoji()" src="assets/images/happiness.svg"  *ngIf="!incognitoRes">
                          <img (click)="openEmoji()" src="assets/images/003-happiness.svg"  *ngIf="incognitoRes">
                        </li>
                        <li *ngIf="firstco">
                          <button type="button" class="cancel-btn" (click)=canceledit()>Cancel</button>
                        </li>
                        <li *ngIf="firstco" class="firstco">
                          <button type="submit" [disabled]="chat.invalid || !enablesend" class="update-btn">
                            Update
                          </button>
                        </li>
                        <li *ngIf="!firstco" class="sendtxt">
                          <button type="submit" [disabled]="chat.invalid || !enablesend"
                            style="background-color: transparent;border:none;box-shadow: none;">
                            <img src="assets/images/send.svg">
                          </button>
                        </li>
                      </ul>
                    </div>
                  </div>
                </ng-template>
              </ngx-file-drop>
            </form>
          </div>

        </div>
        <div class="file-preview row  fixed-preview poppins-font"  [ngClass]="{'chatbg':!incognitoRes}" *ngIf="urlss!=[] ">

          <!-- Media Preview -->

          <div *ngFor="let url of urlss;let index = index" class="file-preview col-lg-4 col-xl-3 col-md-4 mb-3">
            <!-- For Image Preview -->
            <div *ngIf="url.url">
              <div class="image-preview " *ngIf="(url.type=='image')">
    <img src="{{url.url}}" width="100%" height="100%" /> 
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>

              </div>
              <!-- "audio/mpeg", "audio/ogg", "audio/wav", "audio/mp3" -->
              <div class="audio-preview " *ngIf="(url.type=='audio')">
                <div class="audio_pre">
                  <audio src="{{url.url}}" preload="auto" controls controlsList="nodownload"
                    class="htmlvideo receiveraudio" style="width:100%">
                    Your browser does not support audio playback. Kindly upgrade your browser!!!
                  </audio>
                  <i class="fas fa-times-circle closeaudio pointer" (click)="reset2(index)"></i>
                </div>

              </div>
              <!-- "video/mp4", "video/ogg", "video/webm" -->
              <div class="video-preview " *ngIf="(url.type=='video')">
                <video src="{{url.url}}" preload="auto" style="height:100%; width:100%; border: none;" controls
                  controlsList="nodownload" class="htmlvideo">
                  Your browser does not support video playback. Kindly upgrade your browser!!!
                </video>
                <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
              </div>
              <!-- pdf viewing for edit -->

              <div *ngIf="(url.type=='document')">
                <!-- for  text plain -->
                <div class="doc-preview" *ngIf="(url.extension=='txt')">
                  <img src="assets/images/txt.png" width="auto" class=" mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt  txt-hide">{{url.name}}</p>
                </div>

                <!-- for text csv -->
                <div class="doc-preview" *ngIf="(url.extension=='csv')">
                  <img src="assets/images/csv.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt  txt-hide">{{url.name}}</p>
                </div>
                <!-- 
                for pdf -->
                <div class="doc-preview" *ngIf="(url.extension=='pdf')">
                  <img src="assets/images/pdfnew.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>

                <!-- for doc -->
                <div class="doc-preview" *ngIf="(url.extension == 'doc')">
                  <img src="assets/images/doc.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>

                <!-- for docx -->
                <div class="doc-preview" *ngIf="(url.extension == 'docx')">
                  <img src="assets/images/pptnew.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt  txt-hide">{{url.name}}</p>
                </div>

                <!-- for xls -->
                <div class="doc-preview" *ngIf="(url.extension =='xls')">
                  <img src="assets/images/xls.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>
                <!-- For xlsx -->
                <div class="doc-preview" *ngIf="(url.extension=='xlsx')">
                  <img src="assets/images/xlsx.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>
                <!-- For ppt -->
                <div class="doc-preview" *ngIf="(url.extension =='ppt')">
                  <img src="assets/images/ppt.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>
                <!-- For pptx -->
                <div class="doc-preview" *ngIf="(url.extension =='pptx')">
                  <img src="assets/images/pptx.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>

              </div>
            </div>
            <div *ngIf="url._id">
              <!-- For Image Preview -->

              <div class="image-preview "
                *ngIf="(url.type=='image/jpg' || url.type=='image/png' || url.type=='image/jpeg' || url.type == 'image/gif')">
                <img src="{{url.path}}" width="100%" height="100%" />

                <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
              </div>
              <!-- "audio/mpeg", "audio/ogg", "audio/wav", "audio/mp3" -->
              <div class="audio-preview "
                *ngIf="(url.type=='audio/mpeg' || url.type=='audio/ogg' || url.type=='audio/wav' || url.type == 'audio/mp3')">
                <div class="audio_pre">
                  <audio src="{{url.path}}" preload="auto" controls controlsList="nodownload"
                    class="htmlvideo receiveraudio" style="width:100%">
                    Your browser does not support audio playback. Kindly upgrade your browser!!!
                  </audio>
                  <i class="fas fa-times-circle closeaudio pointer" (click)="reset2(index)"></i>
                </div>

              </div>
              <!-- "video/mp4", "video/ogg", "video/webm" -->
              <div class="video-preview " *ngIf="(url.type=='video/ogg' || url.type =='video/mp4')">
                <video src="{{url.path}}" preload="auto" style="height:100%; width:100%; border: none;" controls
                  controlsList="nodownload" class="htmlvideo">
                  Your browser does not support video playback. Kindly upgrade your browser!!!
                </video>
                <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
              </div>
              <!-- pdf viewing for edit -->

              <div
                *ngIf="(url.type=='application/pdf' || url.type=='application/msword' || url.type=='text/csv' || url.type == 'text/plain' || url.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' 
                || url.type =='application/vnd.ms-powerpoint' || url.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'
                || url.type == 'application/vnd.ms-excel' || url.type== 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')">

                <!-- for  text plain -->
                <div class="doc-preview" *ngIf="(url.type=='text/plain')">
                  <img src="assets/images/txt.png" width="auto" class=" mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt  txt-hide">{{url.name}}</p>
                </div>

                <!-- for text csv -->
                <div class="doc-preview" *ngIf="(url.type=='text/csv')">
                  <img src="assets/images/csv.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt  txt-hide">{{url.name}}</p>
                </div>

                <!-- for pdf -->
                <div class="doc-preview" *ngIf="(url.type=='application/pdf')">
                  <img src="assets/images/pdfnew.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>

                <!-- for docx -->
                <div class="doc-preview"
                  *ngIf="(url.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document')">
                  <img src="assets/images/doc.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>

                <!-- for pptx -->
                <div class="doc-preview"
                  *ngIf="(url.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation')">
                  <img src="assets/images/pptnew.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt  txt-hide">{{url.name}}</p>
                </div>

                <!-- for xls -->
                <div class="doc-preview" *ngIf="(url.type=='application/vnd.ms-excel')">
                  <img src="assets/images/xls.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>

                <!-- for xlsx -->
                <div class="doc-preview"
                  *ngIf="(url.type=='application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')">
                  <img src="assets/images/xlsx.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>

                <!-- for ppt -->
                <div class="doc-preview" *ngIf="(url.type =='application/vnd.ms-powerpoint')">
                  <img src="assets/images/ppt.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>

                <div class="doc-preview" *ngIf="(url.type =='application/msword')">
                  <img src="assets/images/doc.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>
              </div>
            </div>
            <!-- End of Media Preview div tag  -->


          </div>
          <div *ngIf="locationurl" class="col-lg-4 col-xl-3 col-md-4  mb-3">
            <a href="{{locationurl}}" class="thumb">
              <img src="/assets/map.png" alt="location" width="100%" height="100%" class="img-shadow">
            </a>
            <i class="fas fa-times-circle closefa pointer" (click)="resetloc()"></i>
          </div>
          <!-- <div *ngIf="locationurl">
                <a href="{{locationurl}}" class="thumb">
                   <img src="/assets/marker.png" alt="location" width="150px" height="150px">
                         </a>
                     <i class="fas fa-times-circle closefa pointer" (click)="resetloc()"></i>
                      </div> -->
          <div *ngIf="!isRecording && blobUrl" class="col-lg-4 col-xl-3 col-md-4  mb-3">
            <div class="audio_pre">
              <audio controls controlsList="nodownload" class=" receiveraudio" style="width:100%">
                <source [src]="blobUrl" type="audio/webm">
              </audio>
              <i class="fas fa-times-circle closeaudio pointer" (click)="resetrecordaudio()"></i>
            </div>
          </div>

        </div>


      </div>

      <!-- Forwardmsg -->
      <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" hidden
        id='forwardmsg'>
      </button>
      <!-- Angular fwd msg dialog box -->
      <ng-template #fwdMsgModal>

        <div class="mat-dialog-header">
          <div class="row">
            <div class="col-4">
              <h4 class="poppins-font" style="font-size: 22px;">Forward To..</h4>
            </div>
            <div class="col-8 text-right">
              <i class="material-icons" matDialogClose="yes" (click)="frwdmsgcleardata()"
                style="-webkit-appearance: none;">
                close
              </i>
            </div>
          </div>


          <hr>
          <mat-tab-group class="fwdmsgtabs">

            <mat-tab label="Contacts">
              <!-- <div class="form-group pt-2"> -->
              <!-- <input name="fwdsearch" [(ngModel)]=fwdsearch type="search" class="form-control"> | search:{ search: fwdsearch }: false-->
            <!-- </div> -->
              <mat-checkbox (change)="selectallusers(selectall)" [(ngModel)]="selectall" [checked]="selectall" matBadge="{{countt}}"
                class="selctchk checkslelect">Select All</mat-checkbox>

              <hr class="mt-0 mb-0">
              <div *ngIf="frwdmsglistusers.length == 0">
                <div *ngFor="let user of listusers">
                  <div *ngIf=" user.senderId && chatuser && (user.senderId._id != chatuser._id)">
                    <div *ngIf=" user.receiverid && chatuser &&(user.receiverid._id != chatuser._id)">
                      <!-- sender name -->
                      <div *ngIf="(loginuserdata.id == user.receiverid._id)" class="card-hover usercard">
                        <mat-card id="custom" class="fwdusers">
                          <div class="d-flex align-items-center">
                            <mat-checkbox (change)="frwdmsguserdetails(user)" [(ngModel)]=user.checked [checked]="user.checked" class="mt-2 checkslelect"></mat-checkbox>
                            <div class="ml-3">
                              <ngx-avatar *ngIf="user.senderId.EmailId && !(user.senderId.path)" [name]="user.senderId.EmailId" value="28%"
                              size="35" [round]="false" [cornerRadius]="12">
                            </ngx-avatar>
                                               <div *ngIf="user.senderId.EmailId && (user.senderId.path)">
                            
                                         <img src="{{user.senderId.path}}" width="35px" height="35px" style="border-radius:12px">
                            </div>
                            </div>

                            <div class="ml-2 chcolor fw-500 poppins-font ">
                              {{user.senderId.Name}}
                            </div>
                          </div>
                        </mat-card>
                      </div>

                      <!-- receiver name -->
                      <div *ngIf="loginuserdata.id == user.senderId._id" class="card-hover usercard">
                        <mat-card id="custom" class="fwdusers">
                          <div class="d-flex align-items-center">
                            <mat-checkbox (change)="frwdmsguserdetails(user)" name="checked" [(ngModel)]=user.checked [checked]="user.checked" class="mt-2 checkslelect"></mat-checkbox>
                            <div class="ml-3">
                              <ngx-avatar *ngIf="user.receiverid.EmailId &&  !(user.receiverid.path)" [name]="user.receiverid.EmailId" value="28%"
                                size="35" [round]="true"></ngx-avatar>
                                <!-- <ngx-avatar *ngIf="user.senderId.EmailId && !(user.senderId.path)" [name]="user.senderId.EmailId" value="28%"
                                size="35" [round]="false" [cornerRadius]="12">
                              </ngx-avatar>
                              {{user.senderId.path}} -->
                                                 <div *ngIf="user.receiverid.EmailId && (user.receiverid.path)">
                              
                                           <img src="{{user.receiverid.path}}" width="35px" height="35px" style="border-radius:12px">
                              </div>
                            </div>
                            <div class="ml-2 chcolor fw-500 poppins-font">
                              {{user.receiverid.Name}}
                            </div>

                          </div>
                        </mat-card>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            
         </mat-tab>
            
            <mat-tab label="Groups">
              <mat-checkbox (change)="selectAllGroups(selectall)" [(ngModel)]="selectall" [checked]="selectall" matBadge="{{countt}}"
              class="selctchk checkslelect">Select All</mat-checkbox>
              <hr class="mt-0 mb-0">
              <div *ngFor="let group of Groups"   (click)="multiForward(group)">
                 
                      <mat-card id="custom" class="fwdusers">
                          <div class="d-flex align-items-center">
                            <mat-checkbox (change)="frwdgrpmsguserdetails(group)" [(ngModel)]="group.checked" [checked]="group.checked"  class="mt-2 checkslelect"></mat-checkbox>
                            <div class="ml-3">
                              <ngx-avatar [name]="group.GroupId.GroupName" value="28%"
                                size="35" [round]="true"></ngx-avatar>
                            </div>
                            <div class="ml-2 chcolor fw-500 poppins-font">
                              {{group.GroupId.GroupName}}
                            </div>

                          </div>
                        </mat-card>
              </div>
            
            </mat-tab>

          </mat-tab-group>
        </div>
        <div class="mat-dialog-footer text-center">
  <button class="btn btn-invite"
              (click)="sendForwardMsg(listofusersfrwdmsgEmails,listofusersfrwdmsgId,forwardmsgdata)">Send</button>
         
        </div>
      </ng-template>

  </div>

  <!-- Delete contact modal -->
  <div class="modal" id="myModal">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-body callerbg poppins-font">
          <div>
            <i class="fas fa-close colorff float-right cursor" data-dismiss="modal"></i>
          </div>
         <p class="text-center colorff font-weight-bold">Do you want to unfriend permanently</p> 
         <div class="row justify-content-center mt-5">
              
          <div>
           <img src="{{chatuser?.path}}" class="profilecalling">
         </div>
      
        </div>

            <div class="row m-0 justify-content-center pt-5 pb-3">
   
          <button type="button"  class="btn incogreject colorff font-14 font-weight-bold" data-dismiss="modal">
             Cancel
             </button>
  
             <button type="button"   (click)="deleteContact(loginuserdata,chatuser)"  class="btn incogaccept colorff ml-5 font-14 font-weight-bold"
             data-dismiss="modal">Confirm</button> 
           </div>
       
        </div>
        <!-- <div class="modal-footer">
          <button type="button" class="btn btn-info" data-dismiss="modal">Cancel</button>
          <button type="button" (click)="deleteContact(loginuserdata,chatuser)" class="btn btn-danger"
            data-dismiss="modal">Confirm</button>
        </div> -->
      </div>
    </div>
  </div>

  <!-- INCOGNITO  -->
  <!-- INCOGNTIO CHAT REQUEST-->
  <div *ngIf="chatuser?.loginStatus == 1 && !incognitopopupshow">
    <div *ngIf="incognitoRes?.chatuser != loginuserdata.id && incognitoRes?.loginuser != loginuserdata.id">
      <div class="modal" id="INCOGNITO">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <!-- <div class="modal-body">
              Please inviting the into Incognito chat
              <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>&nbsp;
              <button type="button" (click)="incognito(loginuserdata,chatuser)" class="btn btn-info"
                data-dismiss="modal">Confirm</button>
            </div> -->
            <div class="modal-body callerbg poppins-font">
              <div>
                <i class="fas fa-close colorff float-right cursor" data-dismiss="modal"></i>
              </div>
               <p class="text-center colorff font-weight-bold"> Inviting  to Incognito Chat</p>
                <div class="row justify-content-center mt-5">
                    <div class="callshapeleft callshape"></div>
                  <div class="callshapeleft callshape ml-3"></div>
                  <div>
                   <img src="assets/images/sample.jpg" class="profilecalling">
                 </div>
                 <div class="callshape callshaperight"></div>
                  <div class="callshape callshaperight ml-3"></div>
                </div>
               <div class="row m-0 justify-content-center pt-5 pb-3">
       
              <button type="button" class="btn incogreject colorff font-14 font-weight-bold" data-dismiss="modal">
                 Cancel
                 </button>

                 <button type="button" (click)="incognito(loginuserdata,chatuser)" class="btn incogaccept colorff ml-5 font-14 font-weight-bold"
                 data-dismiss="modal">Confirm</button> 
               </div>
       
             </div>
          </div>
        </div>
      </div>
    </div>
  </div>


   <!-- VIDEO CALL REQUEST-->
   <div *ngIf="videocallenable == true">
      <div class="modal " id="VIDEOCALL">
        <div class="modal-dialog modal-dialog-centered ">
          <div class="modal-content">
            <div class="modal-body callerbg poppins-font">
             <div>
               <i class="fas fa-close colorff float-right cursor" data-dismiss="modal"></i>
             </div>
              <p class="text-center colorff font-weight-bold"> Are you sure you wish to call {{chatuser?.Name}}?</p>
               <div class="row justify-content-center mt-5">
                   <div class="callshapeleft callshape"></div>
                 <div class="callshapeleft callshape ml-3"></div>
                 <div>
                  <img src="assets/images/sample.jpg" class="profilecalling">
                </div>
                <div class="callshape callshaperight"></div>
                 <div class="callshape callshaperight ml-3"></div>
               </div>
              <div class="row m-0 justify-content-center pt-5 pb-3">
      
              <button type="button" (click)="videocall(loginuserdata?.id,chatuser?._id,'solo')" class="btn callaccept"
                data-dismiss="modal"><span class="material-icons">
                  call_end
                  </span></button> 

                <button type="button" class="btn callreject ml-5" data-dismiss="modal">

                  <span class="material-icons">
                    call_end
                    </span>
                </button>
              </div>
      
            </div>
          </div>
        </div>
      </div>
  </div>

    <!-- video  call  ACCEPTttttt  -->
    <button type="button" data-toggle="modal" id="videocalll" data-target="#videocallaccept" hidden> </button>
    <div class="modal " id="videocallaccept">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">

          <div class="modal-body callerbg poppins-font">
            <div>
              <i class="fas fa-close colorff float-right cursor" data-dismiss="modal"></i>
            </div>
            <p class="text-center colorff font-weight-bold"> {{ videocallres?.SenderID?.Name}} is calling you.</p>
             <div class="row justify-content-center mt-5">
                 <div class="callshapeleft callshape"></div>
               <div class="callshapeleft callshape ml-3"></div>
               <div>
                <img src="assets/images/sample.jpg" class="profilecalling">
              </div>
              <div class="callshape callshaperight"></div>
               <div class="callshape callshaperight ml-3"></div>
             </div>
            <div class="row m-0 justify-content-center pt-5 pb-3">
    
            <button type="button" (click)="solovideocallACCEPT(videocallres)" class="btn callaccept"
              data-dismiss="modal">
              <span class="material-icons">
                call_end
                </span></button> 

              <button type="button" class="btn callreject ml-5" data-dismiss="modal" (click)="solovideocallReject(videocallres)">

                <span class="material-icons">
                  call_end
                  </span>
              </button>
              <button type="button" style="display: none;" data-dismiss="modal" #DismissCallModal>

              </button>
            </div>
    
          </div>
        </div>
      </div>
    </div>
  

  <!-- INCOGNITO CHAT ACCEPTttttt  -->
  <button data-toggle="modal" id="incognito" data-target="#incognitoaccept" hidden> </button>
  <div class="modal " id="incognitoaccept">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-body callerbg poppins-font">
          <div>
            <i class="fas fa-close colorff float-right cursor" data-dismiss="modal"></i>
          </div>
           <p class="text-center colorff font-weight-bold">  sent incognito request</p>
            <div class="row justify-content-center mt-5">
              
              <div>
               <img src="assets/images/sample.jpg" class="profilecalling">
             </div>
          
            </div>
           <div class="row m-0 justify-content-center pt-5 pb-3">
   
          <button type="button" (click)="incognitoreject1(incognitores)" class="btn incogreject colorff font-14 font-weight-bold" data-dismiss="modal">
             Reject
             </button>
  
             <button type="button"  (click)="incognitoACCEPT1(incognitores)"  class="btn incogaccept colorff ml-5 font-14 font-weight-bold"
             data-dismiss="modal">Accept</button> 
           </div>
   
         </div>
      </div>
      <!-- <div class="modal-content">
        <div class="modal-body">
          User Sent the request
          <button type="button" (click)="incognitoreject1(incognitores)" class="btn btn-danger"
            data-dismiss="modal">REJECT</button>&nbsp;
          <button type="button" (click)="incognitoACCEPT1(incognitores)" class="btn btn-info"
            data-dismiss="modal">ACCEPT</button>
        </div>
      </div> -->
    
    </div>
  </div>


  <!-- INCOGNITO CHAT TERMINATE -->
  <span data-toggle="modal" data-target="#incognitoTerminate">
    <div class="modal" id="incognitoTerminate">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-body callerbg poppins-font">
            <div>
              <i class="fas fa-close colorff float-right pointer" data-dismiss="incognitoTerminate"></i>
            </div>
             <p class="text-center colorff font-weight-bold"> Do you want to terminate the chat?</p>
             <div class="row m-0 justify-content-center pt-5 pb-3">
   
              <button type="button" class="btn incogreject colorff font-14 font-weight-bold" data-dismiss="incognitoTerminate">Cancel</button>&nbsp;
            <button type="submit" (click)="incognitochatCancel(Userselected)"  class="btn incogaccept colorff ml-5 font-14 font-weight-bold">Confirm</button>
               </div>
           
          </div>
        </div>
      </div>
    </div>
  </span>
</div>
</div>




<!-- ssssssssssssssssssssssssssssssssssssssssssssssssGroupsssssssssssssssssssssssssssssssssssssssssssssssssssssssss -->

<div *ngIf="change =='true'">
  <div class="row m-0"> 
    <div *ngIf="groupcount === 0" class=" col-lg-12 text-center" style="height:100vh">
      <div class="position-fixed-center">
        <div>
          <img src="assets/images/nogroups.svg">

        </div>
        <div class="nunito-font mt-4">
          <h3>No Groups Created Yet !</h3>
          <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry.</p>
        </div>

        <div>
          <button class="btn btn-invite" (click)="CreateGroup()"> <span><i
                class="fas fa-plus font-12 pr-2"></i></span>Create Group</button>
        </div>
      </div>
    </div>
    <!-- Side nav of Groups -->
    <div class="col-md-12 col-sm-12 col-lg-3 side" >

      <h4 class="poppins-font chatmsg">Groups</h4>

      <!-- Inviting people(Search button) -->
      <div class="row poppins-font">
        <div class="pl-0" [ngClass]="{'col-12':personadd,'col-10':!personadd}">
          <form>
            <div class="form-group">
              <i class="material-icons searchicon  iconscolor">
                search
              </i>

              <!-- placed focus to show and hide the  add button while we focus   -->
              <input type="text" autocomplete="off" placeholder="Search" class="form-control searchinput"
                [matAutocomplete]="auto" name="searchterm" (focus)="personadd=true" (focusout)="personadd=false"
                [(ngModel)]="searchterm" (keydown)="SearchMail21($event)" (keyup)="SearchMail(searchterm)" />
              <mat-autocomplete #auto="matAutocomplete" class="contactslist">
                <mat-option *ngIf='response?.length && email'>

                  <div class="row mr-0 ml-0 mb-2 poppins-font listtop" *ngFor="let searchedUser of response">
                    <div class="col-8 p-0">
                      <div class="d-flex ">
                        <div>
                          <ngx-avatar value="28%" size="35" [round]="false" [cornerRadius]="8"
                            *ngIf=!(searchedUser.Grname) [name]="searchedUser.Name"></ngx-avatar>

                          <ngx-avatar value="28%" size="35" [round]="false" [cornerRadius]="8" *ngIf=searchedUser.Grname
                            [name]="searchedUser.Grname"></ngx-avatar>
                        </div>
                        <div class="ml-3 min-width-0">
                          <div class="font-color fw-600 txt-hide lh-15">
                            {{searchedUser.Name}}
                            <p class="font-12 fw-400 txt-hide">{{searchedUser.EmailId}}</p>
                          </div>
                          <div *ngIf=searchedUser.Grname>

                            <p (click)="navigategroup(searchedUser)" class="pointer">Group Name :

                              <!-- <a class ='list_name pointer' href="http://localhost:4200/navbar/main?gid={{searchedUser.GroupId}}&gname={{searchedUser.Grname}}&value=true">{{searchedUser.Grname}}</a> -->
                              {{searchedUser.Grname}}

                            </p>
                          </div>
                        </div>
                        <!-- <div class=" ml-3">
                    <div class="font-color fw-600">
                      {{searchedUser.EmailId}}
                      </div>
                    </div> -->
                      </div>
                    </div>
                    <div class="col-4 text-right">
                      <a class="contactname" *ngIf="(searchedUser.status == false) && !(searchedUser.Grname)"
                        (click)="InviteFriend(searchedUser);personadd=true">Invite</a>
                      <a class="contactname" *ngIf="(searchedUser.status == true) && !(searchedUser.Grname)"
                        (click)="users(searchedUser.user)">Chat</a>
                    </div>
                  </div>
                </mat-option>
                <mat-option *ngIf="(!response?.length || !response || !email)">
                  <div class="m013 text-center">
                    <img src="assets/images/nosearch.png">
                    <div class="mt-2">
                      <h3 class="mb-0 color36">No results Found</h3>
                      <p class="font-color">Lorem ipsum dummy text editor lorem ipaum</p>
                    </div>
                  </div>
                </mat-option>
              </mat-autocomplete>
            </div>
          </form>
        </div>
        <div class="col-2  p-0" *ngIf="!personadd">
          <button class="butt" matTooltip="Invitation Link For New User" mat-raised-button data-toggle="modal"
            (click)="InviteUser()">
            <mat-icon class="iconscolor">person_add</mat-icon>
          </button>
        </div>
        <div class="col-12  pl-0">
          <button class="groupbtn" (click)="CreateGroup()" matTooltip="Invitation Link For New User" mat-raised-button>
            <i class="material-icons pr-2">
              add
            </i>
            Create New Group
          </button>
        </div>
        <div class="col-12  pl-0 mt-3">
          <button class="groupbtn" mat-raised-button (click)="myGroup2()">
            <i class="material-icons pr-2">
              add
            </i>
            Add New Member
          </button>
        </div>
      </div>
      <!-- List of  Groups -->
      <div class="row mr-0 poppins-font">
        <div class=" col-lg-12 p-0" [ngStyle]="{'max-height.px': divheight-100}" style="overflow-y: auto;">
          <div *ngFor="let group of Groups">
            <mat-card id="custom" class="users poppins-font">
              <div class="bt-border">
                <div class="row">
                  <div class="col-10  p-0">
                    <!-- Groups ui -->
                    <div class="d-flex align-items-center ">
                      <div class="position-relative">
                        <img *ngIf="group?.GroupIcon?.path" class="image-preview1" src="{{group?.GroupIcon?.path}}"
                          alt="group pic" />
                        <ngx-avatar [name]="group.GroupId.GroupName" value="28%" size="35" [round]="false"
                          [cornerRadius]="12">
                        </ngx-avatar>
                      </div>
                      <div class="ml-2 txt-hide">
                        <span class="list_name pointer" (click)="groupdetails(group)" (click)="removeBadgeCount(group)">
                          {{group.GroupId.GroupName}}
                          <!-- // THIS IS FOR USER IS ONLINE OR NOT -->

                          <!-- // THIS IS FOR USER IS ONLINE OR NOT -->
                        </span>
                        <!-- <p class="color2 mb-0">Lorem ipsum dolor sit amet</p> -->
                      </div>
                    </div>
                  </div>

                  <div class="col-2 text-right">
                    <div class="d-flex">
                      <mat-icon *ngIf="((group.badgeCount > 0) && !(group.messageNotification))" class="pointer matcssbadge showml"
                        [matBadge]="group.badgeCount" (click)="removeBadgeCount(group)">
                      </mat-icon>
                      <mat-icon class="menu-mat mt-2 pointer ml-2" aria-hidden="false" aria-label="Example home icon"
                        [matMenuTriggerFor]="menu">more_vert
                      </mat-icon>
                    </div>


                  </div>

                </div>
              </div>
              <!-- <div class="card-hover">
                  <div>
                    <div class="row" style="padding:10px 1px">
                      <div class="col-sm-2 col-md-2 col-lg-2" (click)="groupdetails(group)">
                        <img *ngIf="group?.GroupIcon?.path" class="image-preview1"
                              src="{{group?.GroupIcon?.path}}" alt="group pic" />
                        <ngx-avatar [name]="group.GroupId.GroupName" value="28%" size="35" [round]="true">
                        </ngx-avatar>
                      </div>
                      <div class="col-sm-8 col-md-8 col-lg-8" (click)="groupdetails(group)">
                        <span style="font-size:20px;">{{group.GroupId.GroupName}}</span>
                      </div>
                      <div class="col-sm-2 col-md-2 col-lg-2">
                        <mat-icon aria-hidden="false" aria-label="Example home icon" [matMenuTriggerFor]="menu">
                          more_vert
                        </mat-icon>
                      </div>
                    </div>
                  </div>
                </div> -->

            </mat-card>

            <mat-menu #menu="matMenu" class="chatpopup">
              <!-- Button of Groups-->
              <button *ngIf="!(group.starStatus)" mat-menu-item (click)="changeStarStatus(group._id)">

                <mat-label>Star</mat-label>
              </button>
              <button *ngIf="(group.starStatus)" mat-menu-item (click)="changeStarStatus2(group._id)">

                <mat-label>Unstar</mat-label>
              </button>
              <button mat-menu-item *ngIf=" !(group.blockStatus) " (click)="groupBlock(group._id)">

                <mat-label>Block</mat-label>
              </button>
              <button mat-menu-item *ngIf=" (group.blockStatus)" (click)="groupUnblock(group._id)"> 

                <mat-label>Unblock</mat-label>
              </button>
              <!--  -->
              <button *ngIf= !(group.messageNotification) mat-menu-item (click)="muteBadge(group._id)">

                <mat-label>Mute Notifications</mat-label>
              </button>
              <button *ngIf= (group.messageNotification) mat-menu-item (click)="unMuteBadge(group._id)">

                <mat-label>Unmute Notifications</mat-label>
              </button>

              <button mat-menu-item (click)="myGroup(group)">

                <mat-label>Add members</mat-label>
              </button>
          
              <button mat-menu-item (click)="leaveGroup(group)">

                <mat-label>Leave</mat-label>
              </button>

            </mat-menu>


            <!-----leave the group-->
          </div>
          <!-- <div *ngIf="Groups.length > 5">
            <button class="btn btn-success" (click)="flag = !flag">{{flag?'less':'More'}}</button>
          </div> -->
          <!-- <div *ngIf="Groups.length == 0">
            <h5 class="style">Create a Group</h5>
          </div> -->
          <!-- <div *ngIf="flag">
            <div *ngFor="let group of Groups| slice:5:Groups.length ;">
              <mat-card id="custom" class="users poppins-font">
                <div class="bt-border">
                  <div class="row">
                    <div class="col-10  p-0">
                      Groups ui
                      <div class="d-flex align-items-center ">
                        <div class="position-relative">
                          <img *ngIf="group?.GroupIcon?.path" class="image-preview1" src="{{group?.GroupIcon?.path}}"
                            alt="group pic" />
                          <ngx-avatar [name]="group.GroupId.GroupName" value="28%" size="35" [round]="false"
                            [cornerRadius]="12">
                          </ngx-avatar>
                        </div>
                        <div class="ml-2 txt-hide">
                          <span class="list_name pointer" (click)="groupdetails(group)"
                            (click)="removeBadgeCount(group)">
                            {{group.GroupId.GroupName}}
                            // THIS IS FOR USER IS ONLINE OR NOT

                            // THIS IS FOR USER IS ONLINE OR NOT
                          </span>
                          <p class="color2 mb-0">Lorem ipsum dolor sit amet</p>
                        </div>
                      </div>
                    </div>

                    <div class="col-2 text-right">

                      <mat-icon class="menu-mat mt-2 pointer" aria-hidden="false" aria-label="Example home icon"
                        [matMenuTriggerFor]="menu">more_vert
                      </mat-icon>
                    </div>
                    <div class="col-2">
                      <mat-icon *ngIf="(group.badgeCount > 0)" (click)="removeBadgeCount(group)"
                        class="pointer matcssbadge" [matBadge]="group.badgeCount">
                      </mat-icon>
                    </div>
                  </div>
                </div>
     

              </mat-card>
              <mat-menu #menu="matMenu" class="chatpopup">
           
                <button mat-menu-item>

                  <mat-label>Star</mat-label>
                </button>
                
                <button mat-menu-item>

                  <mat-label>Turn Off Notifications</mat-label>
                </button>

                <button mat-menu-item (click)="myGroup(group)">

                  <mat-label>Add members</mat-label>
                </button>
                <button mat-menu-item (click)="leaveGroup(group)">

                  <mat-label>Leave</mat-label>
                </button>

              </mat-menu>

            </div>

          </div> -->

        </div>


      </div>

    </div>
    <!-- \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ -->
    <!-- Main chat of Groups -->
    <div class="col-md-12 col-sm-12 col-lg-9" style="height:100vh;background-color: #f7f8fc;"
      *ngIf="(Groups !=''  && !notStarred)">
      
      <!-- Header of Group chat options -->
      <div class="row pt-3 bg-fff">
        <div class="col-lg-4" *ngIf="(Groups != '')">
          <div class="d-flex  poppins-font">
            <div *ngIf="!firstGroupPic" class="menu-mat  pointer" aria-hidden="false" aria-label="Example home icon">
              <ngx-avatar [name]="firstGroup" value="28%" size="50" [cornerRadius]="12" [round]="false">
              </ngx-avatar>
            </div>

 
              <img src="{{firstGroupPic?.path}}" alt="User pic"  height="53px" *ngIf="firstGroupPic" class="pointer" style="border-radius: 14px;max-width: 56px;">
              <!-- {{firstGroup}} -->
        

            <div class=" pointer min-width-0" >
              <!-- <p class="mb-0 ml-2 txt-hide font-color fw-600 font20">{{firstGroup}} </p> -->
              <div class="d-flex">
                <div class="mb-0 ml-2 txt-hide font-color fw-600 font20 width250 txt-hide"(click)="gRename(gInformation)">{{firstGroup}}</div>
                <div class="ml-2"><i class="fas fa-angle-up font-20" *ngIf="arrowup"></i>
                  <i class="fas fa-angle-down font-20 pointer"  *ngIf="!arrowup" (click)="gView(gInformation)"></i></div>
                </div>
         
              <p class="fw-500 c1 ml-2">({{groupMembersCount}} members)</p>
            </div>
              
         
          </div>
          <!-- <mat-menu #menu="matMenu" class="poppins-font chatpopup">
            <button mat-menu-item (click)=gView(gInformation)>View members</button>
            <button mat-menu-item (click)="gRename(gInformation)">Rename</button>
          </mat-menu> -->
        </div>

        <!-- Icons -->
        <div class="col-lg-8 text-right col-md-8">
          <ul class="menu-icons pl-0 pt-2">
            <!-- <li>
              <img src="assets/images/incognito.svg">
            </li> -->
            <li>
              <img src="assets/images/video.svg">
            </li>
            <li>
              <img src="assets/images/call.svg">
            </li>

            <li>
              <img src="assets/images/heart.svg">
            </li>

            <li>
              <mat-icon *ngIf="forwardButton" (click)="forwardGModal()">forward</mat-icon>
            </li>

            <li>
              <img src="assets/images/star1.png" (click)="starGroupMessage()" *ngIf="!notStarred">
            </li>

            <li style="margin-right: 21px;">
              <div class="container-2">
                <span class="icon"> <img src="assets/images/search.svg"></span>
                <input type="search" autocomplete="off" id="search" [(ngModel)]=searchTerm />
              </div>
            </li>
            <!-- <li>
              <img src="assets/images/star.png" (click)="STARMSGS(loginuserdata,chatuser)" *ngIf="starmsg1">
              <img src="assets/images/star1.png" (click)="STARMSGS(loginuserdata,chatuser)" *ngIf="!starmsg1">

            </li> -->

            <li>
              <img src="assets/images/ellipsis-v.svg" [matMenuTriggerFor]="menu" aria-hidden="false"
                aria-label="Example home icon" style="border: none;">
            </li>
          </ul>
        </div>


      </div>
      <!-- \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ -->
      <!-- Header Right side icons -->
      <!-- <mat-menu #menu="matMenu" class="chatpopup">
        <button mat-menu-item class="menu" (click)="clearChat(gInformation)">Clear chat</button>
      </mat-menu> -->

      <mat-menu #menu="matMenu" class="chatpopup">
        <button mat-menu-item class="menu" (click)="clearChat(gInformation)">Clear Conversation</button>
      </mat-menu>
      <!-- \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ -->
      <!-- Showing messages to users -->
      <div class="row chatbg chatbox poppins-font" *ngIf="groupMessages" [ngStyle]="{'height.px':divheight}"
        id="messagestest" [scrollTop]='scrolltop'>
        <div class="col-lg-12">
          <div *ngFor="let groupmessage of groupMessages | message:{message:searchTerm } :false;let i=index"
            [class.highlighted]="highlightedBatch.indexOf(groupmessage) !== -1" (click)="multiSelect(groupmessage)">
            <div *ngFor="let clearChatId of groupmessage.clearChat">
              <div *ngIf="id == clearChatId" class="row mt-3">
                <!-- Receiver data -->
                <div class="col-lg-6 col-xl-5 col-md-6 col-sm-12">
                  <div *ngIf="id != groupmessage.groupSenderId._id">
                    <div class="d-flex ml-2">
                      <div>
                        <ngx-avatar [name]="groupmessage.groupSenderId.Name" value="28%" size="40" [round]="false"
                          [cornerRadius]="10">
                        </ngx-avatar>
                      </div>
                      <div class="ml-2 hoveroptions receiverhoverpd min-width-0">
                        <div class="position-relative "
                          [ngClass]="{'receiver_msg':!( groupmessage.locationurl) ,'bg-fff border': groupmessage.locationurl}">

                          <!-- <i class="fas fa-reply float-right replymsg pb-2"></i> -->
                          {{groupmessage?.parentId?.message}}
                          <div class="mb-0 chatmsgspd" *ngIf=" (groupmessage.message && groupmessage.deletedStatus == true);">
                            {{groupmessage.message}}
                          </div>
                          <div class="mb-0 chatmsgspd" *ngIf=" (groupmessage.deletedStatus == false);">
                            {{groupmessage.hashForm}}
                          </div>

                          <!-- Media -->
                          <div
                            *ngIf="((groupmessage.photo!=[]) && (id!= groupmessage.groupSenderId._id) && groupmessage.deletedStatus==true)">
                            <div *ngFor="let img of groupmessage.photo">
                              <!-- Images -->
                              <div *ngFor="let type of imgmimetype" class="position-relative">
                                <div *ngIf="img.type == type">
                                  <div data-backdrop="true" data-keyboard="true" (click)="openModal(img)">
                                    <img src="{{img.path}}" alt="User pic" width="100%" height="100%" class="imagebr" />
                                  </div>
                                  <button type="button" fileSaver [method]="'GET'" fileName="{{img.name}}"
                                    url="{{img.path}}" (success)="DownloadSuccess($event)"
                                    (error)="Downloadfail($event)" class="btn btn-download">
                                    <img src="assets/images/download.png">
                                  </button>
                                </div>

                              </div>
                              <!-- Audio -->
                              <div *ngFor="let type of audiomimetype">
                                <div *ngIf="img.type == type" class="p-2">
                                  <audio src="{{img.path}}" preload="none" alt="User audio" style="width:250px;"
                                    controls class="htmlvideo receiveraudio" controlsList="nodownload">
                                    Your browser does not support audio playback. Kindly upgrade your
                                    browser!!!
                                  </audio>
                                </div>
                              </div>
                              <!-- Video -->
                              <div *ngFor="let type of videomimetype">
                                <div *ngIf="img.type == type">

                                  <video src="{{img.path}}" preload="none" alt="User audio" width="100%" height="225px"
                                    controls class="htmlvideo" controlsList="nodownload">
                                    Your browser does not support video playback. Kindly upgrade your
                                    browser!!!
                                  </video>
                                </div>
                              </div>
                              <!-- Document -->
                              <div
                                *ngIf="img.type ==  'application/pdf' || img.type ==  'text/plain' || img.type ==  'text/csv' || img.type ==  'application/msword' || img.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' || img.type == 'application/vnd.ms-powerpoint' || img.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation' || img.type == 'application/vnd.ms-excel' ||  img.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' ">
                                <!-- pdf view -->
                                <div *ngIf="img.type == 'application/pdf'" fileSaver [method]="'GET'"
                                  fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                                  (error)="Downloadfail($event)" class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/images/pdfnew.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>


                                <div *ngIf="img.type == 'text/plain'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                                  url="{{img.path}}" (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                  class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/docicons/txt.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>

                                <div *ngIf="img.type == 'text/csv'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                                  url="{{img.path}}" (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                  class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/docicons/csv.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>


                                <div *ngIf="img.type == 'application/msword'" type="button" style="border: none;"
                                  fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                                  (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                  class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/docicons/doc.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>


                                <div
                                  *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'"
                                  fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                                  (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                  class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/docicons/docx.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>


                                <div *ngIf="img.type == 'application/vnd.ms-powerpoint'" fileSaver [method]="'GET'"
                                  fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                                  (error)="Downloadfail($event)" class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/docicons/ppt.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>

                                <div
                                  *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'"
                                  fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                                  (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                  class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/docicons/pptx.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>


                                <div *ngIf="img.type == 'application/vnd.ms-excel'" fileSaver [method]="'GET'"
                                  fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                                  (error)="Downloadfail($event)" class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/docicons/xls.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>

                                <div
                                  *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'"
                                  fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                                  (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                  class="d-flex pdfdiv">
                                  <div>
                                    <img src="assets/docicons/xlsx.png" data-backdrop="none" width="100%" />

                                  </div>
                                  <div class="flex-1 min-width-0 width250">
                                    <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                  </div>
                                  <div>
                                    <img src="assets/images/download.png">
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>

                          <div *ngIf="groupmessage.media" class="p-2">
                            <audio controls class="receiveraudio htmlvideo" width="250px">
                              <source src="{{groupmessage.media?.path}}" type="audio/webm">
                            </audio>
                          </div>
                          <div *ngFor="let receiverid of groupmessage.groupReceiverId">
                            <div
                              *ngIf="groupmessage.locationurl && groupmessage.Gps && id == receiverid._id && groupmessage.deletedStatus==true">
                              <app-messagemap [coordinates]="groupmessage.Gps" name="location" #map appId="APP-ID-HERE"
                                appCode="APP-CODE-HERE" height="800px">
                              </app-messagemap>
                              <a style="cursor: pointer;" href={{groupmessage.locationurl}} target="_blank">
                                <mat-icon class="mapicon">zoom_out_map</mat-icon>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div>
                        <i class="material-icons pointer color3" [matMenuTriggerFor]="menusender">more_vert</i>
                        <mat-menu #menusender="matMenu" class="chatpopup">
                          <button *ngIf="(groupmessage.deletedStatus == true  && groupmessage.starStatus ==false)"
                            class="menubtn" (click)="makeStarred(groupmessage)" mat-menu-item>Make star</button>
                          <button *ngIf="(groupmessage.deletedStatus == true && groupmessage.starStatus ==true)"
                           
                          class="menubtn" (click)="makeUnStarred2(groupmessage)" mat-menu-item>Remove star</button>
                          <button class="menubtn" mat-menu-item (click)="groupReply(groupmessage)"
                            *ngIf="!(user?.deletingMsgstatus == '1')">Reply</button>
                        </mat-menu>

                      </div>

                    </div>
                  </div>
                </div>
                <!-- Sender data -->
                <div class="col-lg-6 col-xl-5 col-md-6 col-sm-12 ml-auto">
                  <div *ngIf="id == groupmessage.groupSenderId._id">
                    <div class="d-flex mr-2" style="justify-content: flex-end;">
                      <div>
                        <i class="material-icons pointer color3" 
                          [matMenuTriggerFor]="menusender">more_vert</i>
                        <mat-menu #menusender="matMenu" class="chatpopup">
                          <button *ngIf="(groupmessage.deletedStatus == true)" class="menubtn" mat-menu-item
                            (click)="deleteGroupMessage(groupmessage,i)">Delete</button>

                            <button *ngIf="(groupmessage.deletedStatus == true)" class="menubtn" mat-menu-item
                            (click)="copyMessage(groupmessage.message)">Copy</button>

                            <button *ngIf="(groupmessage?.deletedStatus == false)" mat-menu-item
                            class="menubtn" (click)="copyHash(groupmessage.hashForm)">Copy Hash</button>

                          <!-- <button *ngIf="(groupmessage.deletedStatus == false)" class ="menubtn" mat-menu-item (click)="undoDeleteGroupMessage(groupmessage, i)" >Undo delete</button> -->
                          <button *ngIf="!secondco && groupmessage?.deletedStatus != false" class="menubtn" mat-menu-item
                            (click)="edit2(groupmessage)">Edit</button>
                          <button *ngIf="(groupmessage.deletedStatus == true  && groupmessage.starStatus ==false)"
                            class="menubtn" (click)="makeStarred(groupmessage)" mat-menu-item>Make
                            star</button>
                          <button *ngIf="(groupmessage.deletedStatus == true && groupmessage.starStatus ==true)"
                            class="menubtn" (click)="makeUnStarred2(groupmessage)" mat-menu-item>Remove
                            star</button>
                            <button class="menubtn" mat-menu-item (click)="groupReply(groupmessage)"
                            *ngIf="!(user?.deletingMsgstatus == '1')">Reply</button>
                        </mat-menu>
                      </div>

                      <div class="mr-2 hoveroptions senderhoverpd min-width-0">
                        <div class="position-relative"
                          [ngClass]="{'sendertxt':!( groupmessage.locationurl) ,'bg-fff border': groupmessage.locationurl}">

<!-- 
                          <div *ngIf="user?.parentId">
                            <ngx-avatar [name]="user?.parentId.senderName" value="28%" size="40" [round]="false"
                              [cornerRadius]="10">
                            </ngx-avatar>
                          </div> -->
                          <p class="mb-0  txt-hide " >
                            {{groupmessage?.parentId?.message}} </p>

                          <!-- <i class="fas fa-reply float-right replymsg pb-2"></i> -->
                          <!-- {{groupmessage?.parentId?.message}} -->
                          <div class="mb-0 chatmsgspd" *ngIf=" (groupmessage.message && groupmessage.deletedStatus == true);">
                            {{groupmessage.message}}
                          </div>
                          <div class="mb-0 chatmsgspd" *ngIf=" (groupmessage.deletedStatus == false);">
                            {{groupmessage.hashForm}}
                          </div>
                          <!-- <ng-template class="mb-0 chatmsgspd" #elseBlock>
                            {{groupmessage.hashForm}}
                          </ng-template> -->


                             



                          <!-- Media -->
                          <div
                            *ngIf="groupmessage.photo!=[] && id== groupmessage.groupSenderId._id && groupmessage.deletedStatus == true">
                            <!-- Images -->
                            <div *ngFor="let img of groupmessage.photo" class="position-relative">
                              <div *ngFor="let type of imgmimetype">
                                <div *ngIf="img.type == type">
                                  <div (click)="openModal(img)">
                                    <img src="{{img.path}}" class="imagebr1" alt="User pic" width="100%"
                                      height="100%" />
                                  </div>
                                  <div>
                                    <button type="button" class="btn btn-download" fileSaver [method]="'GET'"
                                      fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                                      (error)="Downloadfail($event)">
                                      <img src="assets/images/download.png">
                                    </button>
                                    <!-- Image editing -->
                                    <!-- <button *ngIf="user.edit2" type="button" color="warn" mat-mini-fab
                                  (click)="reset2(user.photo, index, user._id, user)">
                                  <mat-icon style=" height: 0.2; width: 0.2;">close</mat-icon>
                                </button> -->
                                  </div>
                                </div>
                              </div>
                            </div>
                            <!-- Audio -->
                            <div *ngFor="let img of groupmessage.photo">
                              <div *ngFor="let type of audiomimetype">
                                <div *ngIf="img.type == type" class="documentview p-2">
                                  <audio src="{{img.path}}" preload="none" alt="User audio" style="width:200px;"
                                    controls class="htmlvideo">
                                    Your browser does not support audio playback. Kindly upgrade your
                                    browser!!!
                                  </audio>
                                  <!-- Audio editing -->
                                  <!-- <button *ngIf="user.edit2" type="button" color="warn" mat-mini-fab
                                (click)="reset2(user.photo, index, user._id, user)">
                                <mat-icon style=" height: 0.2; width: 0.2;">close</mat-icon>
                              </button> -->
                                </div>
                              </div>
                            </div>
                            <!-- Video -->
                            <div *ngFor="let img of groupmessage.photo">
                              <div *ngFor="let type of videomimetype">
                                <div *ngIf="img.type == type" class="documentview">
                                  <div>
                                    <video src="{{img.path}}" preload="none" alt="User video"
                                      style=" width: 100%; height: 250px;" controls class="htmlvideo">
                                      Your browser does not support video playback. Kindly upgrade
                                      your browser!!!
                                    </video>
                                  </div>
                                  <!-- Video editing -->
                                  <!-- <button *ngIf="user.edit2" type="button" color="warn" mat-mini-fab
                                (click)="reset2(user.photo, index, user._id, user)">
                                <mat-icon style=" height: 0.2; width: 0.2;">close</mat-icon>
                              </button> -->
                                </div>
                              </div>
                            </div>
                          </div>
                          <!-- \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ -->
                          <!-- Group Document -->
                          <div *ngFor="let img of groupmessage.photo" class="documentview">
                            <div *ngIf="img.type == 'application/pdf'" fileSaver [method]="'GET'"
                              fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                              (error)="Downloadfail($event)" class="d-flex pdfdiv">
                              <div>
                                <img src="assets/images/pdfnew.png" data-backdrop="none" width="100%" />

                              </div>
                              <div class="flex-1 min-width-0 width250">
                                <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>

                            <div *ngIf="img.type == 'text/plain'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                              url="{{img.path}}" (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                              class="d-flex pdfdiv">
                              <div>
                                <img src="assets/images/txt.png" data-backdrop="none" width="100%" />
                              </div>
                              <div class="flex-1 min-width-0 width250">
                                <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>

                            <div *ngIf="img.type == 'text/csv'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                              url="{{img.path}}" (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                              class="d-flex pdfdiv">
                              <div>
                                <img src="assets/docicons/csv.png" data-backdrop="none" width="100%" />

                              </div>
                              <div class="flex-1 min-width-0 width250">
                                <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>

                            <div *ngIf="img.type == 'application/msword'" fileSaver [method]="'GET'"
                              fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                              (error)="Downloadfail($event)" class="d-flex pdfdiv">
                              <div>
                                <img src="assets/docicons/doc.png" data-backdrop="none" width="100%" />

                              </div>
                              <div class="flex-1 min-width-0 width250">
                                <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>

                            <div
                              *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'"
                              fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                              (success)="DownloadSuccess($event)" (error)="Downloadfail($event)" class="d-flex pdfdiv">
                              <div>
                                <img src="assets/docicons/word.png" data-backdrop="none" width="100%" />

                              </div>
                              <div class="flex-1 min-width-0 width250">
                                <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>

                            <div *ngIf="img.type == 'application/vnd.ms-powerpoint'" fileSaver [method]="'GET'"
                              fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                              (error)="Downloadfail($event)" class="d-flex pdfdiv">
                              <div>
                                <img src="assets/docicons/ppt.png" data-backdrop="none" width="100%" />

                              </div>
                              <div class="flex-1 min-width-0 width250">
                                <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>

                            <div
                              *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'"
                              fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                              (success)="DownloadSuccess($event)" (error)="Downloadfail($event)" class="d-flex pdfdiv">
                              <div>
                                <img src="assets/docicons/pptx.png" data-backdrop="none" width="100%" />

                              </div>
                              <div class="flex-1 min-width-0 width250">
                                <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>

                            <div *ngIf="img.type == 'application/vnd.ms-excel'" fileSaver [method]="'GET'"
                              fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                              (error)="Downloadfail($event)" class="d-flex pdfdiv">
                              <div>
                                <img src="assets/docicons/xls.png" data-backdrop="none" width="100%" />

                              </div>
                              <div class="flex-1 min-width-0 width250">
                                <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>

                            <div *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'"
                              fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                              (success)="DownloadSuccess($event)" (error)="Downloadfail($event)" class="d-flex pdfdiv">
                              <div>
                                <img src="assets/docicons/xlsx.png" data-backdrop="none" width="100%" />

                              </div>
                              <div class="flex-1 min-width-0 width250">
                                <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                              </div>
                              <div>
                                <img src="assets/images/download.png">
                              </div>
                            </div>
                          </div>
                          <!-- \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ -->
                          <div *ngIf="groupmessage.media" class="p-2">
                            <audio controls class="htmlvideo" width="250px">
                              <source src="{{groupmessage.media?.path}}" type="audio/webm">
                            </audio>
                            <!-- <button type="button" class="btn btn-download" fileSaver [method]="'GET'"
                            fileName="{{groupmessage.media?.name}}" url="{{groupmessage.media?.path}}"
                            (success)="DownloadSuccess($event)" (error)="Downloadfail($event)">
                            <img src="assets/images/download.png">
                          </button> -->
                          </div>
                          <div *ngFor="let receiverid of groupmessage.groupReceiverId">
                            <div
                              *ngIf="groupmessage.locationurl && groupmessage.Gps && id == receiverid._id && groupmessage.deletedStatus==true">
                              <app-messagemap [coordinates]="groupmessage.Gps" name="location" #map appId="APP-ID-HERE"
                                appCode="APP-CODE-HERE" height="800px">
                              </app-messagemap>
                              <a style="cursor: pointer;" href={{groupmessage.locationurl}} target="_blank">
                                <mat-icon class="mapicon">zoom_out_map</mat-icon>
                              </a>
                            </div>
                          </div>

                          <!--
                        <i class="fas fa-reply  replymsg pb-2 senderreply" (click)="reply(user)"
                        *ngIf="!(user?.deletingMsgstatus == '1')"></i> -->

                        </div>
                      </div>
                      <div>
                        <ngx-avatar [name]="groupmessage.groupSenderId.Name" value="28%" size="40" [round]="false"
                          [cornerRadius]="10">
                        </ngx-avatar>
                        <!-- <div class="circle receiver_name">{{groupmessage.groupSenderId.Name | slice:0:1 | uppercase}}
                        </div> -->
                      </div>
                    </div>
                  </div>
                </div>

              </div>
            </div>
          </div>
        </div>
        <!-- Images zoom showing -->
        <div class="backdrop" [ngStyle]="{'display':display}"></div>
        <div class="modal modal_fade" tabindex="-1" role="dialog" [ngStyle]="{'display':display}">
          <div class="modal-dialog modal-dialog-centered" role="dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h4 class="modal-title">
                  {{selectphoto?.name}}</h4>
                <button type="button" class="close" (click)="closeModal()">
                  <mat-icon>close</mat-icon>
                </button>
              </div>
              <div class="modal-body">
                <p><img src="{{selectphoto?.path}}" id="ImageZoom" style=" height: 100%; width: 100%;">
                </p>
              </div>
            </div>
          </div>
        </div>
        <!-- \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ -->


      </div>


      <!-- \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ -->

      <!-- Group chat box -->
      <div class="fixed-chat">
        <div class="row chat-border chatbg pt-3 pb-3 poppins-font">
          <div class="col-lg-12">
            <form #chat="ngForm" (ngSubmit)="groupbox(chat.value)">
              <ngx-file-drop class="filedrop" dropZoneLabel="Drop files here" (onFileDrop)="dropped($event)"
                (onFileOver)="fileOver($event)" (onFileLeave)="fileLeave($event)">
                <ng-template ngx-file-drop-content-tmp let-openFileSelector="openFileSelector">
                  <div class="row">
                    <div class="col-lg-7 col-md-12">
                      <p class="font-14 font-color txt-hide p-2" *ngIf="message3?.message"> {{message3?.message}}
                      </p>
                      <!-- Replying Docs -->
                      <div
                      *ngIf="message3 && message3?.photo && ((message3?.message =='') || (message3?.message == null))">

                      <div *ngFor="let replydocs of message3?.photo">
                        <!-- <i   (click)="replymsg()" class="fas fa-times-circle closereply pointer"></i> -->
                        <div>
                          <!--Replying Image -->
                          <div *ngIf="message3 && message3?.photo ">

                            <div *ngFor="let type of imgmimetype">
                              <div *ngIf="replydocs.type == type" class="row m-0">
                                <div class="col-8">
                                  <p class="txt-hide font-14 font-color mb-0">{{replydocs?.name}}</p>
                                  <small>{{replydocs?.type}}</small>
                                </div>
                                <div class="col-4 text-right">
                                  <img src="{{replydocs?.path}}" width="100%" height="100%">
                                </div>
                              </div>
                            </div>

                          </div>
                          <!-- Replying Video -->
                          <div *ngIf="message3 && message3?.photo">
                            <div *ngFor="let type of videomimetype">
                              <div *ngIf="replydocs.type == type" class="row m-0">
                                <div class="col-8">
                                  <p class="txt-hide font-14 font-color mb-0">{{replydocs?.name}}</p>
                                  <small>{{replydocs?.type}}</small>
                                </div>
                                <div class="col-4 text-right">
                                  <video src="{{replydocs?.path}}" class="htmlvideo" preload="none" alt="User video"
                                    style=" width: 100%; height: 100%;" controls>
                                    Your browser does not support video playback. Kindly upgrade
                                    your browser!!!
                                  </video>
                                </div>

                              </div>
                            </div>

                          </div>

                          <div *ngIf="message3 && message3?.photo">
                            <div *ngFor="let type of audiomimetype">
                              <div *ngIf="replydocs?.type == type" class="row m-0">
                                <div class="col-10">
                                  <p class="txt-hide font-14 font-color mb-0">{{replydocs?.name}}</p>
                                  <small>{{replydocs?.type}}</small>
                                </div>

                                <audio src="{{replydocs?.path}}" preload="none" alt="User audio" style="width:100%"
                                  class="d-block" controls>
                                  Your browser does not support audio playback. Kindly upgrade your
                                  browser!!!
                                </audio>
                              </div>
                            </div>

                          </div>

                          <div
                            *ngIf="replydocs.type ==  'application/pdf' || replydocs.type ==  'text/plain' || replydocs.type ==  'text/csv' || replydocs.type ==  'application/msword' || replydocs.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' || replydocs.type == 'application/vnd.ms-powerpoint' || replydocs.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation' || replydocs.type == 'application/vnd.ms-excel' ||  replydocs.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'">
                            <div>
                              <div class="documentview">
                                <div *ngIf="replydocs.type == 'application/pdf'" class="row m-0">
                                  <div class="col-9">
                                    <p class="text-left txt-hide font-14 font-color mb-0">{{replydocs.name}}</p>
                                    <p class="txt-hide font-12">{{replydocs.path}}</p>
                                  </div>
                                  <div class="col-3">
                                    <img src="./assets/images/pdfnew.png" data-backdrop="none" width="100%" />

                                  </div>
                                </div>

                                <div *ngIf=" replydocs.type == 'text/plain'" class="row m-0">

                                  <div class="col-9">
                                    <p class="text-left txt-hide font-14 font-color mb-0">{{ replydocs.name}}</p>
                                    <p class="txt-hide font-12">{{replydocs.type}}</p>
                                  </div>
                                  <div class="col-3">
                                    <img src="assets/docicons/txt.png" data-backdrop="none" width="100%" />
                                  </div>
                                </div>

                                <div *ngIf="replydocs.type == 'text/csv'" class="row m-0">

                                  <div class="col-9">
                                    <p class="text-left txt-hide font-14 font-color mb-0">{{ replydocs.name}}</p>
                                    <p class="txt-hide font-12">{{replydocs.type}}</p>
                                  </div>
                                  <div class="col-3">
                                    <img src="assets/docicons/csv.png" data-backdrop="none" width="100%" />
                                  </div>
                                </div>

                                <div *ngIf=" replydocs.type == 'application/msword'" class="row m-0">

                                  <div class="col-9">
                                    <p class="text-left txt-hide font-14 font-color mb-0">{{replydocs.name}}</p>
                                    <p class="txt-hide font-12">{{replydocs.type}}</p>
                                  </div>
                                  <div class="col-3">
                                    <img src="assets/docicons/doc.png" data-backdrop="none" width="100%" />

                                  </div>
                                </div>

                                <div
                                  *ngIf=" replydocs.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'"
                                  class="row m-0">

                                  <div class="col-9">
                                    <p class="text-left txt-hide font-14 font-color mb-0">{{replydocs.name}}</p>
                                    <p class="txt-hide font-12">{{replydocs.type}}</p>
                                  </div>
                                  <div class="col-3">
                                    <img src="assets/docicons/docx.png" data-backdrop="none" width="100%" />

                                  </div>
                                </div>

                                <div *ngIf="replydocs.type == 'application/vnd.ms-powerpoint'" class="row m-0">

                                  <div class="col-9">
                                    <p class="text-left txt-hide font-14 font-color mb-0">{{ replydocs.name}}</p>
                                    <p class="txt-hide font-12">{{replydocs.type}}</p>
                                  </div>
                                  <div class="col-3">
                                    <img src="assets/docicons/ppt.png" data-backdrop="none" width="100%" />

                                  </div>
                                </div>

                                <div
                                  *ngIf=" replydocs.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'"
                                  class="row m-0">

                                  <div class="col-9">
                                    <p class="text-left txt-hide font-14 font-color mb-0">{{replydocs.name}}</p>
                                    <p class="txt-hide font-12">{{replydocs.type}}</p>
                                  </div>
                                  <div class="col-3">
                                    <img src="assets/docicons/pptx.png" data-backdrop="none" width="100%" />

                                  </div>
                                </div>

                                <div *ngIf="replydocs.type == 'application/vnd.ms-excel'" class="row m-0">

                                  <div class="col-9">
                                    <p class="text-left txt-hide font-14 font-color mb-0">{{ replydocs.name}}</p>
                                    <p class="txt-hide font-12">{{replydocs.type}}</p>
                                  </div>
                                  <div class="col-3">
                                    <img src="assets/docicons/xls.png" data-backdrop="none" width="100%" />

                                  </div>
                                </div>


                                <div
                                  *ngIf=" replydocs.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'"
                                  class="row m-0">

                                  <div class="col-9">
                                    <p class="text-left txt-hide font-14 font-color mb-0">{{ replydocs.name}}</p>
                                    <p class="txt-hide font-12">{{replydocs.type}}</p>
                                  </div>
                                  <div class="col-3">
                                    <img src="assets/docicons/xlsx.png" data-backdrop="none" width="100%" />

                                  </div>
                                </div>

                              </div>
                            </div>
                          </div>
                        </div>




                      </div>


                      <!-- Replying location -->
                      <div *ngIf="message3?.locationurl && message3?.Gps ">
                        <div class="row m-0">
                          <div class="col-8">
                            <p class="txt-hide font-14 font-color mb-0" *ngIf="message3?.locationlabel">
                              {{message3?.locationlabel}}</p>
                            <!-- <small  class="mb-0 ">{{user?.pid?.type}}</small>  -->
                          </div>
                          <div class="col-4 text-right">
                            <img src="assets/map.png" width="100%" height="100%">
                          </div>

                        </div>
                        <!-- <app-messagemap [coordinates]="message2?.Gps" name="location" #map appId="APP-ID-HERE"
                    appCode="APP-CODE-HERE" height="800px">
                  </app-messagemap>
                  <a style="cursor: pointer;" href={{message2?.locationurl}} target="_blank">
                    <mat-icon class="mapicon">zoom_out_map</mat-icon>
                  </a> -->
                      </div>

                      <!--Replying Audio -->
                      <div *ngIf="message3 && message3.media && message3?.message == null">
                        <div *ngFor="let type of audiomimetype">
                          <div *ngIf="message3?.media?.type == type" class="row m-0">
                            <div class="col-10">
                              <p class="txt-hide font-14 font-color mb-0">{{message3?.media?.name}}</p>
                              <small>{{message3?.media?.type}}</small>
                            </div>
                            <!-- <audio src="{{message2?.media?.path}}" preload="none" alt="User audio"
                          class="d-block receiveraudio" width="100%" controls>
                            Your browser does not support audio playback. Kindly upgrade your
                            browser!!!
                          </audio> -->
                          </div>
                        </div>
                      </div>
                      <i  class="fas fa-times-circle closereply pointer"></i>

                    </div>
                      <div class="d-flex">
                        <i class="material-icons pointer" *ngIf="!isRecording && !blobUrl" (click)="startRecording()"
                          style="color:#AFAFAF; padding: .375rem .75rem; font-size: 29px;">mic_none </i>
                        <input #OnetoOneTextArea2 spellcheck="true" (click)="getCursorPosition(OnetoOneTextArea2)"
                          (keyup)="getCursorPosition(OnetoOneTextArea2)" autocomplete="off" type="text" name="message"
                          placeholder="Type a Message" [(ngModel)]="searchValue" ngModel class="form-control draginput"
                          style="resize: none;" >
                      </div>
                      <div class="row" *ngIf="isRecording && !blobUrl">
                        <div class="col-8 videorecord m-3">
                          <div class="row">
                            <div class="col-6">
                              <p class="color5 font-14">Recording Audio</p>
                              <button type="button" class="stop-button" (click)="stopRecording()">
                                <i class="material-icons" style="padding: 6px 0px;">
                                  stop
                                </i>
                              </button>
                            </div>
                            <div class="col-6 pr-0 text-right" (click)="clearRecordedData()">
                              <i class="fas fa-times-circle" style="color:#000"></i>
                              <p class="p-3 record_time font-14"> {{recordedTime}} </p>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="col-lg-5 col-md-12">
                      <ul class="chaticons pl-0">
                        <!-- <li>
                          <mat-slide-toggle class="font-color poppins-font">Notify</mat-slide-toggle>
                        </li> -->
                        <li (click)="openMap()">
                          <img src="assets/images/location.svg">
                        </li>

                        <!-- Previous map view  -->

                        <li (click)="fileInput.click()">
                          <img src="assets/images/attachment.svg">
                          <label class="upload" style="cursor:pointer; margin: 0">
                            <input #fileInput type="file" onclick="this.value = null" (change)="fileProgress($event)"
                              style="display:none;" multiple />
                          </label>
                        </li>
                        <li>
                          <img (click)="openCamera()" src="assets/images/camera.svg">
                        </li>
                        <li>
                          <img (click)="openEmoji()" src="assets/images/happiness.svg">
                        </li>
                        <li *ngIf="secondco">
                          <button type="button" class="cancel-btn" (click)=canceledit()>Cancel</button>
                        </li>
                        <li *ngIf="secondco" class="firstco">
                          <button type="submit" [disabled]="chat.invalid || !enablesend" class="update-btn">
                            Update
                          </button>
                        </li>
                        <li *ngIf="!secondco" class="sendtxt">
                          <button type="submit" [disabled]="chat.invalid || !enablesend"
                            style="background-color: transparent;border:none;box-shadow: none;">
                            <img src="assets/images/send.svg">
                          </button>
                        </li>
                      </ul>
                    </div>
                  </div>
                </ng-template>
              </ngx-file-drop>
            </form>
          </div>
        </div>
        <div class="file-preview row chatbg fixed-preview poppins-font" *ngIf="urlss!=[] ">

          <!-- Media Preview -->

          <div *ngFor="let url of urlss;let index = index" class="file-preview col-lg-4 col-xl-3 col-md-4 mb-3">
            <!-- For Image Preview -->
            <div *ngIf="url.url">
              <div class="image-preview " *ngIf="(url.type=='image')">
                <img src="{{url.url}}" width="100%" height="100%" />

                <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
              </div>
              <!-- "audio/mpeg", "audio/ogg", "audio/wav", "audio/mp3" -->
              <div class="audio-preview " *ngIf="(url.type=='audio')">
                <div class="audio_pre">
                  <audio src="{{url.url}}" preload="auto" controls controlsList="nodownload"
                    class="htmlvideo receiveraudio" style="width:100%">
                    Your browser does not support audio playback. Kindly upgrade your browser!!!
                  </audio>
                  <i class="fas fa-times-circle closeaudio pointer" (click)="reset2(index)"></i>
                </div>

              </div>
              <!-- "video/mp4", "video/ogg", "video/webm" -->
              <div class="video-preview " *ngIf="(url.type=='video')">
                <video src="{{url.url}}" preload="auto" style="height:100%; width:100%; border: none;" controls
                  controlsList="nodownload" class="htmlvideo">
                  Your browser does not support video playback. Kindly upgrade your browser!!!
                </video>
                <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
              </div>
              <!-- pdf viewing for edit -->

              <div *ngIf="(url.type=='document')">
                <!-- for  text plain -->
                <div class="doc-preview" *ngIf="(url.extension=='txt')">
                  <img src="assets/images/txt.png" width="auto" class=" mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt  txt-hide">{{url.name}}</p>
                </div>

                <!-- for text csv -->
                <div class="doc-preview" *ngIf="(url.extension=='csv')">
                  <img src="assets/images/csv.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt  txt-hide">{{url.name}}</p>
                </div>
                <!-- 
                for pdf -->
                <div class="doc-preview" *ngIf="(url.extension=='pdf')">
                  <img src="assets/images/pdfnew.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>

                <!-- for doc -->
                <div class="doc-preview" *ngIf="(url.extension == 'doc')">
                  <img src="assets/images/doc.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>

                <!-- for docx -->
                <div class="doc-preview" *ngIf="(url.extension == 'docx')">
                  <img src="assets/images/pptnew.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt  txt-hide">{{url.name}}</p>
                </div>

                <!-- for xls -->
                <div class="doc-preview" *ngIf="(url.extension =='xls')">
                  <img src="assets/images/xls.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>
                <!-- For xlsx -->
                <div class="doc-preview" *ngIf="(url.extension=='xlsx')">
                  <img src="assets/images/xlsx.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>
                <!-- For ppt -->
                <div class="doc-preview" *ngIf="(url.extension =='ppt')">
                  <img src="assets/images/ppt.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>
                <!-- For pptx -->
                <div class="doc-preview" *ngIf="(url.extension =='pptx')">
                  <img src="assets/images/pptx.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>

              </div>
            </div>
            <div *ngIf="url._id">
              <!-- For Image Preview -->

              <div class="image-preview "
                *ngIf="(url.type=='image/jpg' || url.type=='image/png' || url.type=='image/jpeg' || url.type == 'image/gif')">
                <img src="{{url.path}}" width="100%" height="100%" />

                <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
              </div>
              <!-- "audio/mpeg", "audio/ogg", "audio/wav", "audio/mp3" -->
              <div class="audio-preview "
                *ngIf="(url.type=='audio/mpeg' || url.type=='audio/ogg' || url.type=='audio/wav' || url.type == 'audio/mp3')">
                <div class="audio_pre">
                  <audio src="{{url.path}}" preload="auto" controls controlsList="nodownload"
                    class="htmlvideo receiveraudio" style="width:100%">
                    Your browser does not support audio playback. Kindly upgrade your browser!!!
                  </audio>
                  <i class="fas fa-times-circle closeaudio pointer" (click)="reset2(index)"></i>
                </div>

              </div>
              <!-- "video/mp4", "video/ogg", "video/webm" -->
              <div class="video-preview " *ngIf="(url.type=='video/ogg' || url.type =='video/mp4')">
                <video src="{{url.path}}" preload="auto" style="height:100%; width:100%; border: none;" controls
                  controlsList="nodownload" class="htmlvideo">
                  Your browser does not support video playback. Kindly upgrade your browser!!!
                </video>
                <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
              </div>
              <!-- pdf viewing for edit -->

              <div
                *ngIf="(url.type=='application/pdf' || url.type=='application/msword' || url.type=='text/csv' || url.type == 'text/plain' || url.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' 
                || url.type =='application/vnd.ms-powerpoint' || url.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'
                || url.type == 'application/vnd.ms-excel' || url.type== 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')">

                <!-- for  text plain -->
                <div class="doc-preview" *ngIf="(url.type=='text/plain')">
                  <img src="assets/images/txt.png" width="auto" class=" mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt  txt-hide">{{url.name}}</p>
                </div>

                <!-- for text csv -->
                <div class="doc-preview" *ngIf="(url.type=='text/csv')">
                  <img src="assets/images/csv.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt  txt-hide">{{url.name}}</p>
                </div>

                <!-- for pdf -->
                <div class="doc-preview" *ngIf="(url.type=='application/pdf')">
                  <img src="assets/images/pdfnew.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>

                <!-- for docx -->
                <div class="doc-preview"
                  *ngIf="(url.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document')">
                  <img src="assets/images/doc.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>

                <!-- for pptx -->
                <div class="doc-preview"
                  *ngIf="(url.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation')">
                  <img src="assets/images/pptnew.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt  txt-hide">{{url.name}}</p>
                </div>

                <!-- for xls -->
                <div class="doc-preview" *ngIf="(url.type=='application/vnd.ms-excel')">
                  <img src="assets/images/xls.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>

                <!-- for xlsx -->
                <div class="doc-preview"
                  *ngIf="(url.type=='application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')">
                  <img src="assets/images/xlsx.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>

                <!-- for ppt -->
                <div class="doc-preview" *ngIf="(url.type =='application/vnd.ms-powerpoint')">
                  <img src="assets/images/ppt.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>

                <div class="doc-preview" *ngIf="(url.type =='application/msword')">
                  <img src="assets/images/doc.png" width="auto" class="mt-5 mb-5" />
                  <i class="fas fa-times-circle closefa pointer" (click)="reset2(index)"></i>
                  <p class="doctxt txt-hide">{{url.name}}</p>
                </div>
              </div>
            </div>
            <!-- End of Media Preview div tag  -->


          </div>
          <div *ngIf="locationurl" class="col-lg-4 col-xl-3 col-md-4  mb-3">
            <a href="{{locationurl}}" class="thumb">
              <img src="/assets/map.png" alt="location" width="100%" height="100%" class="img-shadow">
            </a>
            <i class="fas fa-times-circle closefa pointer" (click)="resetloc()"></i>
          </div>
          <!-- <div *ngIf="locationurl">
                <a href="{{locationurl}}" class="thumb">
                   <img src="/assets/marker.png" alt="location" width="150px" height="150px">
                         </a>
                     <i class="fas fa-times-circle closefa pointer" (click)="resetloc()"></i>
                      </div> -->
          <div *ngIf="!isRecording && blobUrl" class="col-lg-4 col-xl-3 col-md-4  mb-3">
            <div class="audio_pre">
              <audio controls controlsList="nodownload" class=" receiveraudio" style="width:100%">
                <source [src]="blobUrl" type="audio/webm">
              </audio>
              <i class="fas fa-times-circle closeaudio pointer" (click)="resetrecordaudio()"></i>
            </div>
          </div>

        </div>

      </div>
    </div>
    <!-- ******************************************************************************************************************************************** -->
    <!-- ******************************************************************************************************************************************** -->
    <!-- Forward Group Message Model -->
    <ng-template #forwardGMessages>
      <div class="mat-dialog-header">
        <div class="row">
          <div class="col-4">
            <h4 class="poppins-font" style="font-size:22px;">Forward to</h4>
          </div>
          <div class="col-8 text-right">
            <i class="material-icons" matDialogClose="yes" style="-webkit-appereance:none;">close</i>
          </div>
        </div>
        <hr>
        <mat-tab-group class="fwdmsgtabs">
          <mat-tab label="Groups">
            <!-- <mat-checkbox matBadge="{{matCount}}" class="selctchk checkslelect"[(ngModel)]="selectall" [checked]="selectall"  
              (change)="selectAll(gInformation)">Select
              all</mat-checkbox> -->


              <mat-checkbox matBadge="{{Countt}}" class="selctchk checkslelect"[(ngModel)]="selectall" [checked]="selectall"  
              (change)="selectAllGroups(gInformation)">Select
              all</mat-checkbox>
            
              <!-- <mat-checkbox (change)="selectallusers(selectall)"  matBadge="{{countt}}"
              class="selctchk checkslelect">Select All</mat-checkbox> -->
            <hr class="mt-0 mb-0">
            <div *ngFor="let group of Groups" [class.highlighted2]="highlightedBatch2.indexOf(group) !== -1"
              (click)="multiForward(group)">
              <div class="d-flex align-items-center" *ngIf="group.GroupId._id != gInformation.GroupId._id">
                <mat-checkbox [checked]="group.checked"> </mat-checkbox>
                <div class="ml-3">
                  <ngx-avatar [name]="group.GroupId.GroupName" value="28%" size="35" [round]="true">
                  </ngx-avatar>
                </div>
                <div class="ml-2 chcolor fw-500 poppins-font">
                  {{group.GroupId.GroupName}}
                </div>

              </div>
            </div>
          </mat-tab>
          <mat-tab label="Contacts">
            <!-- <div class="form-group pt-2"> -->
            <!-- <input name="fwdsearch" [(ngModel)]=fwdsearch type="search" class="form-control"> | search:{ search: fwdsearch }: false-->
          <!-- </div> -->
            <mat-checkbox (change)="selectallusers(selectall)" [(ngModel)]="selectall" [checked]="selectall" matBadge="{{countt}}"
              class="selctchk checkslelect">Select All</mat-checkbox>

            <hr class="mt-0 mb-0">
            <div *ngIf="frwdmsglistusers.length == 0">
              <div *ngFor="let user of listusers">
                <div *ngIf=" user.senderId && chatuser && (user.senderId._id != chatuser._id)">
                  <div *ngIf=" user.receiverid && chatuser &&(user.receiverid._id != chatuser._id)">
                    <!-- sender name -->
                    <div *ngIf="(loginuserdata.id == user.receiverid._id)" class="card-hover usercard">
                      <mat-card id="custom" class="fwdusers">
                        <div class="d-flex align-items-center">
                          <mat-checkbox (change)="frwdmsguserdetails(user)" [(ngModel)]=user.checked [checked]="user.checked" class="mt-2 checkslelect"></mat-checkbox>
                          <div class="ml-3">
                            <ngx-avatar *ngIf="user.senderId.EmailId" [name]="user.senderId.EmailId" value="28%"
                              size="35" [round]="true">
                            </ngx-avatar>
                          </div>

                          <div class="ml-2 chcolor fw-500 poppins-font ">
                            {{user.senderId.Name}}
                          </div>
                        </div>
                      </mat-card>
                    </div>

                    <!-- receiver name -->
                    <div *ngIf="loginuserdata.id == user.senderId._id" class="card-hover usercard">
                      <mat-card id="custom" class="fwdusers">
                        <div class="d-flex align-items-center">
                          <mat-checkbox (change)="frwdmsguserdetails(user)" name="checked" [(ngModel)]=user.checked [checked]="user.checked" class="mt-2 checkslelect"></mat-checkbox>
                          <div class="ml-3">
                            <ngx-avatar *ngIf="user.receiverid.EmailId" [name]="user.receiverid.EmailId" value="28%"
                              size="35" [round]="true"></ngx-avatar>
                          </div>
                          <div class="ml-2 chcolor fw-500 poppins-font">
                            {{user.receiverid.Name}}
                          </div>

                        </div>
                      </mat-card>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div *ngIf="frwdmsglistusers.length != 0" class="scroll2">
              <div *ngFor="let frwdmsgusers of frwdmsglistusers">

                <div *ngIf="(loginuserdata.id == frwdmsgusers.senderId._id)" class="card-hover usercard">
                  <mat-card id="custom" class="fwdusers">
                    <div class="d-flex align-items-center">
                      <mat-checkbox (click)="selectallusers(listusers)" class="mt-2 checkslelect"></mat-checkbox>
                      <div (click)="frwdmsguserdetails(frwdmsgusers)" class="ml-3">
                        <ngx-avatar *ngIf="frwdmsgusers.receiverid.EmailId" [name]="frwdmsgusers.receiverid.EmailId"
                          value="28%" size="35" [round]="true">
                        </ngx-avatar>
                      </div>
                      <div (click)="frwdmsguserdetails(frwdmsgusers)" class="ml-2 chcolor fw-500 poppins-font">
                        {{frwdmsgusers?.receiverid.Name}}
                      </div>

                      <div *ngIf="listofusersfrwdmsgEmails.includes(frwdmsgusers.receiverid.EmailId)">
                        <p style="font-size: 30px;color: springgreen;">✔</p>
                      </div>
                    </div>

                  </mat-card>
                </div>

                <!-- receiver name -->
                <div *ngIf="loginuserdata.id == frwdmsgusers.receiverid._id" class="card-hover usercard">
                  <mat-card id="custom" class="fwdusers">
                    <div class="d-flex align-items-center">
                      <mat-checkbox (click)="selectallusers(listusers)" class="mt-2 checkslelect"></mat-checkbox>
                      <div (click)="frwdmsguserdetails(frwdmsgusers)" class="ml-3">
                        <ngx-avatar *ngIf="frwdmsgusers.senderId.EmailId" [name]="frwdmsgusers.senderId.EmailId"
                          value="28%" size="35" [round]="true"></ngx-avatar>
                      </div>
                      <div (click)="frwdmsguserdetails(frwdmsgusers)" class="ml-2 chcolor fw-500 poppins-font">
                        {{frwdmsgusers?.senderId.Name}}
                      </div>

                      <div *ngIf="listofusersfrwdmsgEmails.includes(frwdmsgusers.senderId.EmailId)">
                        <p style="font-size: 30px;color: springgreen;">✔</p>
                      </div>
                    </div>

                  </mat-card>
                </div>

              </div>
            </div>
          </mat-tab>
        </mat-tab-group>
      </div>
      <div class="mat-dialog-footer text-center">
        <button class="btn btn-invite" matDialogClose="yes" (click)="sendMultiForward()">Send</button>
      </div>
    </ng-template>

    <!-- \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ -->
    <!-- Starred messages of Groups -->
    <div class="col-md-12 col-sm-12 col-lg-9" style="height:100vh;background-color: #f7f8fc;" *ngIf="notStarred">
      <!-- Header of Group chat options for starred messages -->
      <div class="row pt-3 bg-fff">
        <div class="col-lg-4" *ngIf="(Groups != '')">
          <div class="d-flex  poppins-font">
            <div class="menu-mat  pointer" aria-hidden="false" aria-label="Example home icon"
              [matMenuTriggerFor]="menu">
              <ngx-avatar [name]="firstGroup" value="28%" size="50" [cornerRadius]="12" [round]="false">
              </ngx-avatar>
            </div>

            <div class="menu-mat groupnamewidth pointer" aria-hidden="false" aria-label="Example home icon"
              [matMenuTriggerFor]="menu">
              <p class="mb-0 ml-2 txt-hide font-color fw-600 font20">{{firstGroup}}</p>


              <p class="fw-500 c1 ml-2">({{groupMembersCount}} members)</p>
            </div>

          </div>
          <mat-menu #menu="matMenu" class="poppins-font chatpopup">
            <button mat-menu-item (click)=gView(gInformation)>View members</button>
            <button mat-menu-item (click)="gRename(gInformation)">Rename</button>
          </mat-menu>
        </div>

        <!-- Icons -->
        <div class="col-lg-8 text-right col-md-8">
          <ul class="menu-icons pl-0 pt-2">
            <li>
              <img src="assets/images/incognito.svg">
            </li>
            <li>
              <img src="assets/images/video.svg" >
            </li>
            <li>
              <img src="assets/images/call.svg">
            </li>

            <li>
              <img src="assets/images/heart.svg">
            </li>
            <li>
              <mat-icon *ngIf="forwardButton" (click)="forwardGModal()">forward</mat-icon>
            </li>
            <li>
              <img src="assets/images/star.png" (click)="unStarGroupMessage()" *ngIf="notStarred">
            </li>

            <li style="margin-right: 21px;">
              <div class="container-2">
                <span class="icon"> <img src="assets/images/search.svg"></span>
                <input type="search" autocomplete="off" id="search" [(ngModel)]=searchTerm />
              </div>
            </li>


            <li>
              <img src="assets/images/ellipsis-v.svg" [matMenuTriggerFor]="menu" aria-hidden="false"
                aria-label="Example home icon" style="border: none;">
            </li>
          </ul>
        </div>


      </div>
      <!-- \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ -->
      <!-- Header Right side icons for starred messages -->
      <mat-menu #menu="matMenu" class="chatpopup">
        <button mat-menu-item class="menu" (click)="clearChat(gInformation)">Clear chat</button>
      </mat-menu>
      <!-- \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ -->
      <!-- Showing messages to users -->
      <div class="row chatbg chatbox poppins-font" *ngIf="starGroupMessages" [scrollTop]='scrolltop'
        [ngStyle]="{'height.px':   divheight}">
        <div class="col-lg-12">
          <div *ngFor="let groupmessage of starGroupMessages | message:{message:searchTerm } :false;let i=index"
            [class.highlighted]="highlightedBatch.indexOf(groupmessage) !== -1" (click)="multiSelect(groupmessage)">
            <div class="row mt-3">
              <!-- Receiver data -->
              <div class="col-lg-6 col-xl-5 col-md-6 col-sm-12">
                <div *ngIf="id != groupmessage.groupSenderId._id">
                  <div class="d-flex ml-2">
                    <div>
                      <ngx-avatar [name]="groupmessage.groupSenderId.Name" value="28%" size="44" [round]="false"
                        [cornerRadius]="12">
                      </ngx-avatar>
                    </div>
                    <div class="ml-2 hoveroptions receiverhoverpd min-width-0">
                      <div class="position-relative "
                        [ngClass]="{'sendertxt':!( groupmessage.locationurl) ,'bg-fff border': groupmessage.locationurl}">

                        <!-- <i class="fas fa-reply float-right replymsg pb-2"></i> -->
                        <div class="mb-0 chatmsgspd"
                          *ngIf=" (groupmessage.message && groupmessage.deletedStatus == true);">
                          {{groupmessage.message}}
                        </div>
                        <div class="mb-0 chatmsgspd" *ngIf=" (groupmessage.deletedStatus == false);">
                          {{groupmessage.hashForm}}
                        </div>

                        <!-- Media -->
                        <div *ngIf="((groupmessage.photo!=[]) && (id!= groupmessage.groupSenderId._id))">
                          <div *ngFor="let img of groupmessage.photo">
                            <!-- Images -->
                            <div *ngFor="let type of imgmimetype" class="position-relative">{{img | json}}
                              <div *ngIf="img.type == type">
                                <div data-backdrop="true" data-keyboard="true" (click)="openModal(img)">
                                  <img src="{{img.path}}" alt="User pic" width="100%" height="100%"
                                    class="imagebr" />
                                </div>
                                <button type="button" fileSaver [method]="'GET'" fileName="{{img.name}}"
                                  url="{{img.path}}" (success)="DownloadSuccess($event)"
                                  (error)="Downloadfail($event)" class="btn btn-download">
                                  <img src="assets/images/download.png">
                                </button>
                              </div>

                            </div>
                            <!-- Audio -->
                            <div *ngFor="let type of audiomimetype">
                              <div *ngIf="img.type == type" class="p-2">
                                <audio src="{{img.path}}" preload="none" alt="User audio"
                                  style="width:250px;" controls class="receiveraudio" controlsList="nodownload">
                                  Your browser does not support audio playback. Kindly upgrade your
                                  browser!!!
                                </audio>
                                <button type="button" fileSaver [method]="'GET'" fileName="{{img.name}}"
                                  url="{{img.path}}" (success)="DownloadSuccess($event)"
                                  (error)="Downloadfail($event)" class="btn btn-download">
                                  <img src="assets/images/download.png">
                                </button>
                              </div>
                            </div>
                            <!-- Video -->
                            <div *ngFor="let type of videomimetype">
                              <div *ngIf="img.type == type">

                                <video src="{{img.path}}" preload="none" alt="User audio" width="100%"
                                  height="225px" controls class="htmlvideo" controlsList="nodownload">
                                  Your browser does not support video playback. Kindly upgrade your
                                  browser!!!
                                </video>
                                <button type="button" fileSaver [method]="'GET'" fileName="{{img.name}}"
                                  url="{{img.path}}" (success)="DownloadSuccess($event)"
                                  (error)="Downloadfail($event)" class="btn btn-download">
                                  <img src="assets/images/download.png">
                                </button>
                              </div>
                            </div>
                            <!-- Document -->
                            <div
                              *ngIf="img.type ==  'application/pdf' || img.type ==  'text/plain' || img.type ==  'text/csv' || img.type ==  'application/msword' || img.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' || img.type == 'application/vnd.ms-powerpoint' || img.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation' || img.type == 'application/vnd.ms-excel' ||  img.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' ">
                              <!-- pdf view -->
                              <div *ngIf="img.type == 'application/pdf'" fileSaver [method]="'GET'"
                                fileName="{{img.name}}" url="{{img.path}}"
                                (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                class="d-flex pdfdiv">
                                <div>
                                  <img src="assets/images/pdfnew.png" data-backdrop="none" width="100%" />

                                </div>
                                <div class="flex-1 min-width-0 width250">
                                  <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                </div>
                                <div>
                                  <img src="assets/images/download.png">
                                </div>
                              </div>


                              <div *ngIf="img.type == 'text/plain'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                                url="{{img.path}}" (success)="DownloadSuccess($event)"
                                (error)="Downloadfail($event)" class="d-flex pdfdiv">
                                <div>
                                  <img src="assets/docicons/txt.png" data-backdrop="none" width="100%" />

                                </div>
                                <div class="flex-1 min-width-0 width250">
                                  <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                </div>
                                <div>
                                  <img src="assets/images/download.png">
                                </div>
                              </div>

                              <div *ngIf="img.type == 'text/csv'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                                url="{{img.path}}" (success)="DownloadSuccess($event)"
                                (error)="Downloadfail($event)" class="d-flex pdfdiv">
                                <div>
                                  <img src="assets/docicons/csv.png" data-backdrop="none" width="100%" />

                                </div>
                                <div class="flex-1 min-width-0 width250">
                                  <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                </div>
                                <div>
                                  <img src="assets/images/download.png">
                                </div>
                              </div>


                              <div *ngIf="img.type == 'application/msword'" type="button" style="border: none;"
                                fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                                (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                class="d-flex pdfdiv">
                                <div>
                                  <img src="assets/docicons/doc.png" data-backdrop="none" width="100%" />

                                </div>
                                <div class="flex-1 min-width-0 width250">
                                  <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                </div>
                                <div>
                                  <img src="assets/images/download.png">
                                </div>
                              </div>


                              <div
                                *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'"
                                fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                                (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                class="d-flex pdfdiv">
                                <div>
                                  <img src="assets/docicons/docx.png" data-backdrop="none" width="100%" />

                                </div>
                                <div class="flex-1 min-width-0 width250">
                                  <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                </div>
                                <div>
                                  <img src="assets/images/download.png">
                                </div>
                              </div>


                              <div *ngIf="img.type == 'application/vnd.ms-powerpoint'" fileSaver [method]="'GET'"
                                fileName="{{img.name}}" url="{{img.path}}"
                                (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                class="d-flex pdfdiv">
                                <div>
                                  <img src="assets/docicons/ppt.png" data-backdrop="none" width="100%" />

                                </div>
                                <div class="flex-1 min-width-0 width250">
                                  <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                </div>
                                <div>
                                  <img src="assets/images/download.png">
                                </div>
                              </div>

                              <div
                                *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'"
                                fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                                (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                class="d-flex pdfdiv">
                                <div>
                                  <img src="assets/docicons/pptx.png" data-backdrop="none" width="100%" />

                                </div>
                                <div class="flex-1 min-width-0 width250">
                                  <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                </div>
                                <div>
                                  <img src="assets/images/download.png">
                                </div>
                              </div>


                              <div *ngIf="img.type == 'application/vnd.ms-excel'" fileSaver [method]="'GET'"
                                fileName="{{img.name}}" url="{{img.path}}"
                                (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                class="d-flex pdfdiv">
                                <div>
                                  <img src="assets/docicons/xls.png" data-backdrop="none" width="100%" />

                                </div>
                                <div class="flex-1 min-width-0 width250">
                                  <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                </div>
                                <div>
                                  <img src="assets/images/download.png">
                                </div>
                              </div>

                              <div
                                *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'"
                                fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                                (success)="DownloadSuccess($event)" (error)="Downloadfail($event)"
                                class="d-flex pdfdiv">
                                <div>
                                  <img src="assets/docicons/xlsx.png" data-backdrop="none" width="100%" />

                                </div>
                                <div class="flex-1 min-width-0 width250">
                                  <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                                </div>
                                <div>
                                  <img src="assets/images/download.png">
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>

                        <div *ngIf="groupmessage.media" class="p-2">
                          <audio controls class="receiveraudio htmlvideo" width="250px">
                            <source src="{{groupmessage.media?.path}}" type="audio/webm">
                          </audio>
                        </div>

                      </div>
                      <div>
                        <i class="material-icons pointer color3" [matMenuTriggerFor]="menusender">more_vert</i>
                        <mat-menu #menusender="matMenu" class="chatpopup">
                          <button *ngIf="(groupmessage.deletedStatus == true)" class="menubtn"
                            (click)="makeUnStarred(groupmessage)" mat-menu-item>Remove
                            star</button>
                        </mat-menu>
                      </div>
                    </div>

                  </div>
                </div>
              </div>
              <!-- Sender data -->
              <div class="col-lg-6 col-xl-5 col-md-6 col-sm-12 ml-auto">
                <div *ngIf="id == groupmessage.groupSenderId._id">
                  <div class="d-flex mr-2" style="justify-content: flex-end;">
                    <div>
                      <i class="material-icons pointer color3" [matMenuTriggerFor]="menusender">more_vert</i>
                      <mat-menu #menusender="matMenu" class="chatpopup">
                        <button *ngIf="(groupmessage.deletedStatus == true)" class="menubtn"
                          (click)="makeUnStarred(groupmessage)" mat-menu-item>Remove
                          star</button>
                      </mat-menu>
                    </div>
                    <div class="mr-2 hoveroptions senderhoverpd min-width-0">
                      <div class="position-relative sendertxt">



                        <!-- <i class="fas fa-reply float-right replymsg pb-2"></i> -->
                        <div *ngIf=" (groupmessage.deletedStatus == true)">
                          <p class="mb-0 chatmsgspd"> {{groupmessage.message}}</p>
                        </div>
                        <!-- Media -->
                        <div *ngIf="groupmessage.photo!=[] && id== groupmessage.groupSenderId._id">
                          <!-- Images -->
                          <div *ngFor="let img of groupmessage.photo" class="position-relative">
                            <div *ngFor="let type of imgmimetype">
                              <div *ngIf="img.type == type">
                                <div (click)="openModal(img)">
                                  <img src="{{img.path}}" class="imagebr1" alt="User pic" width="100%"
                                    height="100%" />
                                </div>
                                <div>
                                  <button type="button" class="btn btn-download" fileSaver [method]="'GET'"
                                    fileName="{{img.name}}" url="{{img.path}}"
                                    (success)="DownloadSuccess($event)" (error)="Downloadfail($event)">
                                    <img src="assets/images/download.png">
                                  </button>
                                  <!-- Image editing -->
                                  <!-- <button *ngIf="user.edit2" type="button" color="warn" mat-mini-fab
                                     (click)="reset2(user.photo, index, user._id, user)">
                                     <mat-icon style=" height: 0.2; width: 0.2;">close</mat-icon>
                                   </button> -->
                                </div>
                              </div>
                            </div>
                          </div>
                          <!-- Audio -->
                          <div *ngFor="let img of groupmessage.photo">
                            <div *ngFor="let type of audiomimetype">
                              <div *ngIf="img.type == type" class="documentview p-2">
                                <audio src="{{img.path}}" preload="none" alt="User audio"
                                  style="width:250px;" controls class="htmlvideo">
                                  Your browser does not support audio playback. Kindly upgrade your
                                  browser!!!
                                </audio>
                                <!-- Audio editing -->
                                <!-- <button *ngIf="user.edit2" type="button" color="warn" mat-mini-fab
                                   (click)="reset2(user.photo, index, user._id, user)">
                                   <mat-icon style=" height: 0.2; width: 0.2;">close</mat-icon>
                                 </button> -->
                              </div>
                            </div>
                          </div>
                          <!-- Video -->
                          <div *ngFor="let img of groupmessage.photo">
                            <div *ngFor="let type of videomimetype">
                              <div *ngIf="img.type == type" class="documentview">
                                <div>
                                  <video src="{{img.path}}" preload="none" alt="User video"
                                    style=" width: 100%; height: 250px;" controls class="htmlvideo">
                                    Your browser does not support video playback. Kindly upgrade
                                    your browser!!!
                                  </video>
                                </div>
                                <!-- Video editing -->
                                <!-- <button *ngIf="user.edit2" type="button" color="warn" mat-mini-fab
                                   (click)="reset2(user.photo, index, user._id, user)">
                                   <mat-icon style=" height: 0.2; width: 0.2;">close</mat-icon>
                                 </button> -->
                              </div>
                            </div>
                          </div>
                        </div>
                        <!-- \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ -->
                        <!-- Group Document -->
                        <div *ngFor="let img of groupmessage.photo" class="documentview">
                          <div *ngIf="img.type == 'application/pdf'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                            url="{{img.path}}" (success)="DownloadSuccess($event)"
                            (error)="Downloadfail($event)" class="d-flex pdfdiv">
                            <div>
                              <img src="assets/images/pdfnew.png" data-backdrop="none" width="100%" />

                            </div>
                            <div class="flex-1 min-width-0 width250">
                              <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                            </div>
                            <div>
                              <img src="assets/images/download.png">
                            </div>
                          </div>

                          <div *ngIf="img.type == 'text/plain'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                            url="{{img.path}}" (success)="DownloadSuccess($event)"
                            (error)="Downloadfail($event)" class="d-flex pdfdiv">
                            <div>
                              <img src="assets/docicons/txt.png" data-backdrop="none" width="100%" />
                            </div>
                            <div class="flex-1 min-width-0 width250">
                              <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                            </div>
                            <div>
                              <img src="assets/images/download.png">
                            </div>
                          </div>

                          <div *ngIf="img.type == 'text/csv'" fileSaver [method]="'GET'" fileName="{{img.name}}"
                            url="{{img.path}}" (success)="DownloadSuccess($event)"
                            (error)="Downloadfail($event)" class="d-flex pdfdiv">
                            <div>
                              <img src="assets/docicons/csv.png" data-backdrop="none" width="100%" />

                            </div>
                            <div class="flex-1 min-width-0 width250">
                              <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                            </div>
                            <div>
                              <img src="assets/images/download.png">
                            </div>
                          </div>

                          <div *ngIf="img.type == 'application/msword'" fileSaver [method]="'GET'"
                            fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                            (error)="Downloadfail($event)" class="d-flex pdfdiv">
                            <div>
                              <img src="assets/docicons/doc.png" data-backdrop="none" width="100%" />

                            </div>
                            <div class="flex-1 min-width-0 width250">
                              <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                            </div>
                            <div>
                              <img src="assets/images/download.png">
                            </div>
                          </div>

                          <div
                            *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'"
                            fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                            (success)="DownloadSuccess($event)" (error)="Downloadfail($event)" class="d-flex pdfdiv">
                            <div>
                              <img src="assets/docicons/word.png" data-backdrop="none" width="100%" />

                            </div>
                            <div class="flex-1 min-width-0 width250">
                              <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                            </div>
                            <div>
                              <img src="assets/images/download.png">
                            </div>
                          </div>

                          <div *ngIf="img.type == 'application/vnd.ms-powerpoint'" fileSaver [method]="'GET'"
                            fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                            (error)="Downloadfail($event)" class="d-flex pdfdiv">
                            <div>
                              <img src="assets/docicons/ppt.png" data-backdrop="none" width="100%" />

                            </div>
                            <div class="flex-1 min-width-0 width250">
                              <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                            </div>
                            <div>
                              <img src="assets/images/download.png">
                            </div>
                          </div>

                          <div
                            *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'"
                            fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                            (success)="DownloadSuccess($event)" (error)="Downloadfail($event)" class="d-flex pdfdiv">
                            <div>
                              <img src="assets/docicons/pptx.png" data-backdrop="none" width="100%" />

                            </div>
                            <div class="flex-1 min-width-0 width250">
                              <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                            </div>
                            <div>
                              <img src="assets/images/download.png">
                            </div>
                          </div>

                          <div *ngIf="img.type == 'application/vnd.ms-excel'" fileSaver [method]="'GET'"
                            fileName="{{img.name}}" url="{{img.path}}" (success)="DownloadSuccess($event)"
                            (error)="Downloadfail($event)" class="d-flex pdfdiv">
                            <div>
                              <img src="assets/docicons/xls.png" data-backdrop="none" width="100%" />

                            </div>
                            <div class="flex-1 min-width-0 width250">
                              <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                            </div>
                            <div>
                              <img src="assets/images/download.png">
                            </div>
                          </div>

                          <div *ngIf="img.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'"
                            fileSaver [method]="'GET'" fileName="{{img.name}}" url="{{img.path}}"
                            (success)="DownloadSuccess($event)" (error)="Downloadfail($event)" class="d-flex pdfdiv">
                            <div>
                              <img src="assets/docicons/xlsx.png" data-backdrop="none" width="100%" />

                            </div>
                            <div class="flex-1 min-width-0 width250">
                              <p class="text-left pl-2 pr-3 pt-1">{{img.name}}</p>
                            </div>
                            <div>
                              <img src="assets/images/download.png">
                            </div>
                          </div>
                        </div>
                        <!-- \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ -->
                        <div *ngIf="groupmessage.media" class="p-2">
                          <audio controls class="htmlvideo" width="250px">
                            <source src="{{groupmessage.media?.path}}" type="audio/webm">
                          </audio>
                          <!-- <button type="button" class="btn btn-download" fileSaver [method]="'GET'"
                               fileName="{{groupmessage.media?.name}}" url="{{groupmessage.media?.path}}"
                               (success)="DownloadSuccess($event)" (error)="Downloadfail($event)">
                               <img src="assets/images/download.png">
                             </button> -->
                        </div>
                        <!-- 
                           <i class="fas fa-reply  replymsg pb-2 senderreply" (click)="reply(user)"
                           *ngIf="!(user?.deletingMsgstatus == '1')"></i> -->

                      </div>
                    </div>
                    <div>
                      <ngx-avatar [name]="groupmessage.groupSenderId.Name" value="28%" size="44" [round]="false"
                        [cornerRadius]="12">
                      </ngx-avatar>
                      <!-- <div class="circle receiver_name">{{groupmessage.groupSenderId.Name | slice:0:1 | uppercase}}
                           </div> -->
                    </div>
                  </div>
                </div>
              </div>

            </div>

          </div>
        </div>
        <!-- Images zoom showing -->
        <div class="backdrop" [ngStyle]="{'display':display}"></div>
        <div class="modal modal_fade" tabindex="-1" role="dialog" [ngStyle]="{'display':display}">
          <div class="modal-dialog modal-dialog-centered" role="dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h4 class="modal-title">
                  {{selectphoto?.name}}</h4>
                <button type="button" class="close" (click)="closeModal()">
                  <mat-icon>close</mat-icon>
                </button>
              </div>
              <div class="modal-body">
                <p><img src="{{selectphoto?.path}}" id="ImageZoom" style=" height: 100%; width: 100%;">
                </p>
              </div>
            </div>
          </div>
        </div>
        <!-- \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ -->


      </div>

      <!-- \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ -->
    </div>

  </div>

</div>


<ng-template #calllogModal>
  <div class="poppins-font">
  
    <div class="row align-items-center m-0">
      <h5 class="font-color mb-0">Call Details</h5>
      <i *ngIf="call.type2=='Video'" class="fas fa-video ml-3 iconscolor"></i>
      <i class="fas fa-close ml-auto" mat-dialog-close ></i>
    </div>
  
    <div class="row color-36 mt-3">
      <div class="col-lg-2 col-md-2 col-2">
        <p>Caller</p>
      </div>
      <div class="col-lg-1 col-1 col-md-1 text-right">
        :
      </div>
      <div class="col-lg-8 col-md-8 col-8">
        <span> <img src="assets/images/profimg.png"></span>
        <span class="ml-3">{{call.Caller.Name}}</span>
      </div>
    </div>
  
 
  
    <div class="row color-36 mt-3">
      <div class="col-lg-2 col-md-2 col-2">
        <p>Call Started</p>
      </div>
      <div class="col-lg-1 col-md-1 col-1 text-right">
        :
      </div>
      <div class="col-lg-8 col-md-8 col-8">
  
        <span>{{call.start}}</span>
        <!-- <span class="ml-3">12:40</span> -->
      </div>
    </div>

    <div class="row color-36">
      <div *ngIf="call.end!=null" class="col-lg-2 col-md-2 col-2">
        <p>Call Ended</p>
      </div>
      <div *ngIf="call.end==null" class="col-lg-2 col-md-2 col-2">
        <p>Ongoing</p>
      </div>
      <div class="col-lg-1 col-md-1 col-1 text-right">
        :
      </div>
      <div class="col-lg-8 col-md-8 col-8">
        <div class="row">
          <div *ngIf="call.end!=null" class="col-lg-6">
            <span>{{call.end}}</span>
            <!-- <span class="ml-3">12:40</span> -->
          </div>
          <!-- Outgoing Calls -->
          <div *ngIf="call.Receiver.length == 1" class="col-lg-6">
            <span *ngIf="call.Receiver[0].status =='Answered'">Duration:</span>
            <span *ngIf="call.Receiver[0].status =='Answered'" class="ml-3">
              <span *ngIf="call.duration.days>0">{{call.duration.days}} days  </span>
              <span *ngIf="call.duration.hours>0">{{call.duration.hours}} hours  </span>
              <span *ngIf="call.duration.mins>0">{{call.duration.mins}} minutes  </span>
              <span *ngIf="call.duration.secs>0">{{call.duration.secs}} seconds</span>
            </span>
          </div>
          <!-- Incoming Calls -->
          <!-- <div class="col-lg-6">
            <span>Duration</span>
            <span class="ml-3">16mins</span>
          </div> -->
        </div>
      
      </div>
    </div>
    <div class="font-color mt-3">
    <h5>Participants</h5>
    </div>
    <div  *ngFor="let Receiver of call.Receiver" class="row mt-3" style="border-bottom: 1px solid #f5f5f5;">
      <div class="col-lg-6 col-md-6 col-6">
        <!-- Receiver Name -->
      <div class="row m-0 align-items-center">
       <img src="assets/images/profimg.png">
       <p class="ml-2 color-36">{{Receiver.id.Name}}</p>
      </div>
      </div>
      <!-- Receiver Stqtus -->
      <div class="col-lg-6 col-md-6 col-6 text-right">
        <div class="row m-0 justify-content-flex-end">
          <span class="material-icons pointer statusicon"  *ngIf ="Receiver.status == 'No Answer'" style=
          "color: red;">
      
          call_missed
            </span>
          <i class="fas fa-times statusicon" style="color:red" *ngIf="Receiver.status == 'No Answer'"></i>
          <i class="fas fa-ban statusicon"  style="color:red" *ngIf="Receiver.status == 'Rejected'"></i>
          <i class="fas fa-check statusicon" *ngIf="Receiver.status == 'Answered'"></i>
          <!-- <i class="fas fa-times"></i> -->
          
          <p class="ml-2 color-36 p-10-0">{{Receiver.status}}</p>
         </div>
      </div>
    </div>
  </div>

</ng-template>

<div class="row">
  
      <!--Active HideUser Modal -->

      <div class="col-md-4">
        <div>
         <div class="bgcolor1" [@slideInOut]="activeusershide">
           <div class="divbagrnd">
             <div class="row">
       
               <div class="col-md-8">
                 <p class="notifications font-14">Active Hide Users</p>
             </div>
               <div class="col-md-4 text-right">
                  <img class="closebtn1" src="assets/images/close.svg" width="14px" (click)="closecalllog()">
       
               </div>
       
             </div>
               
        </div>
        <span *ngIf = "activehideuserslist?.length !=1 && activehideuserslist?.length !=0 ">
        <div  class="row m-0" style="justify-content:flex-end">
          <p class="iconscolor font-italic text-right pointer pr-3 font-weight-bold" (click)="unhideAll(loginuserdata)"> Unhide All</p>
        </div>
        </span>
             <div *ngFor="let users of activehideuserslist">
              <div  class="row  mb-2 mt-2"  *ngIf="users.from == loginuserdata.EmailId">
                <div class="col-md-2">
                <div class="imgdiv" >
                  <img src="assets/images/profimg.png" class="profimg" width="100%">
                </div>
                </div>
                <div class="col-md-10 pl-1">
                  <p class="content txt-hide mb-0 poppins-font font-color font-14" >
                    {{users.to}}</p>
                  <div  class="butns">
                    <span>
                    <button id="activehideusers" class="btn axptbtn" (click)="sendhidedata(loginuserdata,users)">Unhide</button>
                  
                  </span>
                  </div>
                </div>
               
            
              </div>
              <div  class="row  mb-2 mt-2"  *ngIf="users.to == loginuserdata.EmailId">
                <div class="col-md-2">
                <div class="imgdiv" >
                  <img src="assets/images/profimg.png" class="profimg" width="100%">
                </div>
                </div>
                <div class="col-md-10 pl-1">
                  <p class="content mb-0 poppins-font txt-hide font-color font-14">
                    {{users.from}}</p>
                  <div  class="butns">
                    <span>
                    <button class="btn axptbtn" (click)="sendhidedata(loginuserdata,users)">Unhide</button>
                  
                  </span>
                  </div>
                </div>
               
            
              </div>
             </div>
         
           
        
         
      
         
         <!-- group notifications -->

     
       </div>  
       
      </div>
      <!-- <div  [@slideInOut]="activeusershide">
        <div>
          <div >
            <div >
              <h4 class="modal-title">Active Hide Users</h4>
              <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
              <div *ngFor="let users of activehideuserslist">
                <div *ngIf="users.from == loginuserdata.EmailId">
                  <div style="cursor: pointer;" (click)="sendhidedata(loginuserdata,users)">
                    <mat-card>{{users.to}}</mat-card>
                  </div>
                </div>
                <div *ngIf="users.to == loginuserdata.EmailId">
                  <div style="cursor: pointer;" (click)="sendhidedata(loginuserdata,users)">
                    <mat-card>{{users.from}}</mat-card>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div> -->
    </div>
</div>

